<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the LaLonde Study</title>
  <meta name="description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to assess potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator, while analysing the distributional properties of resulting outcome weights.
It further applies placebo tests and sensitivity analysis to assess the robustness of the treatment effect estimates.
The analysis draws on the original LaLonde data (NSW) as well as the LaLonde–Dehejia–Wahba (LDW) and
LaLonde–Calónico–Smith (LCS) data.</p>" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the LaLonde Study" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to assess potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator, while analysing the distributional properties of resulting outcome weights.
It further applies placebo tests and sensitivity analysis to assess the robustness of the treatment effect estimates.
The analysis draws on the original LaLonde data (NSW) as well as the LaLonde–Dehejia–Wahba (LDW) and
LaLonde–Calónico–Smith (LCS) data.</p>" />
  <meta name="github-repo" content="lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the LaLonde Study" />
  
  <meta name="twitter:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to assess potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator, while analysing the distributional properties of resulting outcome weights.
It further applies placebo tests and sensitivity analysis to assess the robustness of the treatment effect estimates.
The analysis draws on the original LaLonde data (NSW) as well as the LaLonde–Dehejia–Wahba (LDW) and
LaLonde–Calónico–Smith (LCS) data.</p>" />
  

<meta name="author" content="Laura Kreisel" />


<meta name="date" content="2025-12-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html"/>
<link rel="next" href="lalonde-dehejia-wahba-ldw-data-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.34.0/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tutorial/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Application of Outcome Weights Framework for DML to Lalonde Study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#wrapper-functions"><i class="fa fa-check"></i><b>1.2</b> Wrapper functions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started.html"><a href="getting-started.html#overview"><i class="fa fa-check"></i><b>1.2.1</b> Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started.html"><a href="getting-started.html#inspection"><i class="fa fa-check"></i><b>1.2.2</b> Inspection</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started.html"><a href="getting-started.html#improving-covariate-balance-and-overlap"><i class="fa fa-check"></i><b>1.2.3</b> Improving covariate balance and overlap</a></li>
<li class="chapter" data-level="1.2.4" data-path="getting-started.html"><a href="getting-started.html#assessing-methods"><i class="fa fa-check"></i><b>1.2.4</b> Assessing methods</a></li>
<li class="chapter" data-level="1.2.5" data-path="getting-started.html"><a href="getting-started.html#identifying-best-methods"><i class="fa fa-check"></i><b>1.2.5</b> Identifying best methods</a></li>
<li class="chapter" data-level="1.2.6" data-path="getting-started.html"><a href="getting-started.html#estimating"><i class="fa fa-check"></i><b>1.2.6</b> Estimating</a></li>
<li class="chapter" data-level="1.2.7" data-path="getting-started.html"><a href="getting-started.html#outcome-weights-analysis"><i class="fa fa-check"></i><b>1.2.7</b> Outcome weights analysis</a></li>
<li class="chapter" data-level="1.2.8" data-path="getting-started.html"><a href="getting-started.html#sensitivity-analysis"><i class="fa fa-check"></i><b>1.2.8</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="1.2.9" data-path="getting-started.html"><a href="getting-started.html#balance-analysis"><i class="fa fa-check"></i><b>1.2.9</b> Balance analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html"><i class="fa fa-check"></i><b>2</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#set-up"><i class="fa fa-check"></i><b>2.1</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data"><i class="fa fa-check"></i><b>2.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="2.1.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data"><i class="fa fa-check"></i><b>2.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="2.1.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data"><i class="fa fa-check"></i><b>2.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#ldw-model-a"><i class="fa fa-check"></i><b>2.2</b> LDW-Model A</a></li>
<li class="chapter" data-level="2.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#pre-assessing-methods"><i class="fa fa-check"></i><b>2.3</b> Pre-assessing methods</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#overlap"><i class="fa fa-check"></i><b>2.3.1</b> Overlap</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-overlap"><i class="fa fa-check"></i><b>2.4</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#single-methods"><i class="fa fa-check"></i><b>2.4.1</b> Single methods</a></li>
<li class="chapter" data-level="2.4.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-2"><i class="fa fa-check"></i><b>2.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#post-assessing-methods"><i class="fa fa-check"></i><b>2.5</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#single-methods-1"><i class="fa fa-check"></i><b>2.5.1</b> Single methods</a></li>
<li class="chapter" data-level="2.5.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-3"><i class="fa fa-check"></i><b>2.5.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#identifying-most-efficient-methods"><i class="fa fa-check"></i><b>2.6</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#ranking"><i class="fa fa-check"></i><b>2.6.1</b> Ranking</a></li>
<li class="chapter" data-level="2.6.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#sample-construction"><i class="fa fa-check"></i><b>2.6.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1"><i class="fa fa-check"></i><b>2.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att"><i class="fa fa-check"></i><b>2.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="2.7.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1"><i class="fa fa-check"></i><b>2.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="2.7.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet"><i class="fa fa-check"></i><b>2.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="2.7.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow"><i class="fa fa-check"></i><b>2.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses"><i class="fa fa-check"></i><b>2.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="2.9" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses"><i class="fa fa-check"></i><b>2.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="2.10" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspection-of-re74-and-re75"><i class="fa fa-check"></i><b>2.10</b> Inspection of re74 and re75</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#correlation"><i class="fa fa-check"></i><b>2.10.1</b> Correlation</a></li>
<li class="chapter" data-level="2.10.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#distributional-balance"><i class="fa fa-check"></i><b>2.10.2</b> Distributional balance</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#summary"><i class="fa fa-check"></i><b>2.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html"><i class="fa fa-check"></i><b>3</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1"><i class="fa fa-check"></i><b>3.1</b> Set up</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1"><i class="fa fa-check"></i><b>3.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="3.1.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1"><i class="fa fa-check"></i><b>3.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="3.1.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#ldw-model-b"><i class="fa fa-check"></i><b>3.2</b> LDW-Model B</a></li>
<li class="chapter" data-level="3.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#pre-assessing-methods-1"><i class="fa fa-check"></i><b>3.3</b> Pre-assessing methods</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#overlap-1"><i class="fa fa-check"></i><b>3.3.1</b> Overlap</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-overlap-1"><i class="fa fa-check"></i><b>3.4</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-2"><i class="fa fa-check"></i><b>3.4.1</b> Single methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-4"><i class="fa fa-check"></i><b>3.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#post-assessing-methods-1"><i class="fa fa-check"></i><b>3.5</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-3"><i class="fa fa-check"></i><b>3.5.1</b> Single methods</a></li>
<li class="chapter" data-level="3.5.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-5"><i class="fa fa-check"></i><b>3.5.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#identifying-most-efficient-methods-1"><i class="fa fa-check"></i><b>3.6</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#ranking-1"><i class="fa fa-check"></i><b>3.6.1</b> Ranking</a></li>
<li class="chapter" data-level="3.6.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#sample-construction-1"><i class="fa fa-check"></i><b>3.6.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2"><i class="fa fa-check"></i><b>3.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1"><i class="fa fa-check"></i><b>3.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="3.7.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2"><i class="fa fa-check"></i><b>3.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="3.7.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1"><i class="fa fa-check"></i><b>3.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="3.7.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1"><i class="fa fa-check"></i><b>3.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1"><i class="fa fa-check"></i><b>3.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="3.9" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1"><i class="fa fa-check"></i><b>3.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="3.10" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspection-of-re74-and-re75-1"><i class="fa fa-check"></i><b>3.10</b> Inspection of re74 and re75</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#correlation-1"><i class="fa fa-check"></i><b>3.10.1</b> Correlation</a></li>
<li class="chapter" data-level="3.10.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#distributional-balance-1"><i class="fa fa-check"></i><b>3.10.2</b> Distributional balance</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1"><i class="fa fa-check"></i><b>3.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html"><i class="fa fa-check"></i><b>4</b> LaLonde (NSW) Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#set-up-2"><i class="fa fa-check"></i><b>4.1</b> Set up</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#source-functions-and-load-data-2"><i class="fa fa-check"></i><b>4.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="4.1.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#load-and-preprocess-data-2"><i class="fa fa-check"></i><b>4.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="4.1.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#inspect-data-2"><i class="fa fa-check"></i><b>4.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#nsw"><i class="fa fa-check"></i><b>4.2</b> NSW</a></li>
<li class="chapter" data-level="4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#pre-assessing-methods-2"><i class="fa fa-check"></i><b>4.3</b> Pre-assessing methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#overlap-2"><i class="fa fa-check"></i><b>4.3.1</b> Overlap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-overlap-2"><i class="fa fa-check"></i><b>4.4</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#single-methods-4"><i class="fa fa-check"></i><b>4.4.1</b> Single methods</a></li>
<li class="chapter" data-level="4.4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-6"><i class="fa fa-check"></i><b>4.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#post-assessing-methods-2"><i class="fa fa-check"></i><b>4.5</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#single-methods-5"><i class="fa fa-check"></i><b>4.5.1</b> Single methods</a></li>
<li class="chapter" data-level="4.5.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-7"><i class="fa fa-check"></i><b>4.5.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#identifying-most-efficient-methods-2"><i class="fa fa-check"></i><b>4.6</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#ranking-2"><i class="fa fa-check"></i><b>4.6.1</b> Ranking</a></li>
<li class="chapter" data-level="4.6.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#sample-construction-2"><i class="fa fa-check"></i><b>4.6.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#estimating-3"><i class="fa fa-check"></i><b>4.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#average-treatment-effect-on-the-treated-att-2"><i class="fa fa-check"></i><b>4.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="4.7.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#conditional-average-treatment-effect-on-the-treated-catt-3"><i class="fa fa-check"></i><b>4.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="4.7.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#quantile-treatment-effect-on-the-treated-qtet-2"><i class="fa fa-check"></i><b>4.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="4.7.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-outcome-weights-ow-2"><i class="fa fa-check"></i><b>4.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#validation-through-sensitivity-analyses-2"><i class="fa fa-check"></i><b>4.8</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="4.9" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#summary-2"><i class="fa fa-check"></i><b>4.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html"><i class="fa fa-check"></i><b>5</b> LaLonde-Calónico-Smith (LCS) Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#set-up-3"><i class="fa fa-check"></i><b>5.1</b> Set up</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#source-functions-and-load-data-3"><i class="fa fa-check"></i><b>5.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="5.1.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#load-and-preprocess-data-3"><i class="fa fa-check"></i><b>5.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="5.1.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#inspect-data-3"><i class="fa fa-check"></i><b>5.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#lcs"><i class="fa fa-check"></i><b>5.2</b> LCS</a></li>
<li class="chapter" data-level="5.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#pre-assessing-methods-3"><i class="fa fa-check"></i><b>5.3</b> Pre-assessing methods</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#overlap-3"><i class="fa fa-check"></i><b>5.3.1</b> Overlap</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-overlap-3"><i class="fa fa-check"></i><b>5.4</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#single-methods-6"><i class="fa fa-check"></i><b>5.4.1</b> Single methods</a></li>
<li class="chapter" data-level="5.4.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-8"><i class="fa fa-check"></i><b>5.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#post-assessing-methods-3"><i class="fa fa-check"></i><b>5.5</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#single-methods-7"><i class="fa fa-check"></i><b>5.5.1</b> Single methods</a></li>
<li class="chapter" data-level="5.5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-9"><i class="fa fa-check"></i><b>5.5.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#identifying-most-efficient-methods-3"><i class="fa fa-check"></i><b>5.6</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#ranking-3"><i class="fa fa-check"></i><b>5.6.1</b> Ranking</a></li>
<li class="chapter" data-level="5.6.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#sample-construction-3"><i class="fa fa-check"></i><b>5.6.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#estimating-4"><i class="fa fa-check"></i><b>5.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#average-treatment-effect-on-the-treated-att-3"><i class="fa fa-check"></i><b>5.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="5.7.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#conditional-average-treatment-effect-on-the-treated-catt-4"><i class="fa fa-check"></i><b>5.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="5.7.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#quantile-treatment-effect-on-the-treated-qtet-3"><i class="fa fa-check"></i><b>5.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="5.7.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-outcome-weights-ow-3"><i class="fa fa-check"></i><b>5.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-placebo-analyses-2"><i class="fa fa-check"></i><b>5.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="5.9" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-sensitivity-analyses-3"><i class="fa fa-check"></i><b>5.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="5.10" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#summary-3"><i class="fa fa-check"></i><b>5.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Application of the Outcome Weights Framework for Double Machine Learning to the LaLonde Study</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lalonde-dehejia-wahba-ldw-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> LaLonde-Dehejia-Wahba (LDW) Data<a href="lalonde-dehejia-wahba-ldw-data.html#lalonde-dehejia-wahba-ldw-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>LaLonde (1986) evaluated the effect of the National Supported Work Demonstration (NSW) program on both female and male participants. While the female participants were drawn from the Aid to Families with Dependent Children (AFDC) program, the male participants were drawn from three other groups: former drug addicts, ex-criminal offenders, and high-school dropouts. LaLonde relied on two main data sources:
(1) CPS-SSA-1, based on Westat’s Matched Current Population Survey–Social Security Administration File for individuals under 55 matching specific criteria;
(2) PSID-1, based on Panel Study of Income Dynamics for household heads under 55 from specific years who were not retired in 1975, adjusted for factors like employment status and poverty level.</p>
<p>Dehejia and Wahba (1999) constructed a subset of LaLonde’s original data, retaining 62% of observations and restricting the focus to male participants based on their 1974 earnings. As the sample was formed entirely on pretreatment information like employment records or month of assignment, treatment allocation was effectively independent of all pretreatment variables. Thus, they concluded that this subset, known as the LaLonde-Dehejia-Wahba (LDW) data, constitutes a valid experimental sample.</p>
<p>The analysis in section 2 and 3 builds on the LDW data and considers in total three samples:
(1) LDW-Experimental, consisting of 185 treated individuals and 280 controls from the experimental data;
(2) LDW-CPS-1, which pairs the same treated units with 15,992 controls from CPS-SSA-1;
(3) LDW-PSID-1, featuring the same treated units with 2,490 controls from PSID-1.
In section 4 and 5, the analysis applies the same set of statistical tools to analyze a fourth and fifth sample as additional demonstrations:
(4) LaLonde male samples (1986);
(5) LaLonde female samples (2017).</p>
<p>This section (2) covers model A, which includes the outcome variable 1978 earnings (<code>re78</code>) and adjusts for a set of covariates: age, education, race (<code>black</code>, <code>hispanic</code>), marital status (<code>married</code>), high school dropouts (<code>nodegree</code>), 1974 and 1975 earnings (<code>re74</code>, <code>re75</code>), and unemployment status in 1974 and 1975 (<code>u74</code>, <code>u75</code>). The model is defined by a regression formula for treatment assignment using these covariates. To achieve adequate overlap between treated and control groups and covariate balance, various methods are applied and are structured into two parts (trimming and integrated methods). From these methods, the five most efficient methods are determined based on the overlapping coefficient and reranked by the mean absolute standardized mean difference. The corresponding samples are used to estimate to inform subsequent analysis. Notably, the estimation of the average treatment effect on the treated (ATT) incorporates the recently introduced augmented inverse probability weighting (AIPW) estimator, implemented via the <code>OutcomeWeights</code> R package (AIPW-OW). Subsequently, alternative estimands are considered, including the conditional average treatment effect for the treated (CATT) and the quantile treatment effect on the treated (QTET). After estimating these effects, outcome weights are analyzed to identify potential patterns in the contribution of individual observations to the ATT. Placebo tests are then conducted using 1975 earnings (<code>re75</code>) as the outcome to assess potential biases and the validity of unconfoundedness assumptions. Finally, sensitivity analyses are performed to evaluate the robustness of treatment effect estimates to violations of these assumptions.</p>
<div id="set-up" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Set up<a href="lalonde-dehejia-wahba-ldw-data.html#set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="source-functions-and-load-data" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Source functions and load data<a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb45-1" tabindex="-1"></a><span class="co"># source functions</span></span>
<span id="cb45-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb45-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://github.com/xuyiqing/lalonde/blob/main/tutorial/functions.R?raw=TRUE&quot;</span>)</span>
<span id="cb45-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb45-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;tutorial/functions.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb46-1" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb46-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb46-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/lalonde.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb47-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb47-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb47-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="inspect-data" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Inspect data<a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We begin the analysis with an overview of each sample, where the sample name, number of observations (rows), number of treated and control units, number of variables (columns), and variable names are reviewed.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-1" tabindex="-1"></a><span class="co"># collect samples in a list</span></span>
<span id="cb48-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw =</span> ldw, <span class="at">ldw_tr =</span> ldw_tr, <span class="at">ldw_co =</span> ldw_co, <span class="at">ldw_cps =</span> ldw_cps, <span class="at">ldw_psid =</span> ldw_psid)</span>
<span id="cb48-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-4" tabindex="-1"></a><span class="co"># print and inspect key metrics of each sample</span></span>
<span id="cb48-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-5" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(data)</span>
<span id="cb48-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-6" tabindex="-1"></a><span class="fu">datatable</span>(summary_stats, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>,</span>
<span id="cb48-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb48-7" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-30e4409849e39179307f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-30e4409849e39179307f">{"x":{"filter":"none","vertical":false,"caption":"<caption>Summary Statistics<\/caption>","data":[["1","2","3","4","5"],["ldw","ldw_tr","ldw_co","ldw_cps","ldw_psid"],[445,185,260,16177,2675],[185,185,0,185,185],[260,0,260,15992,2490],[14,14,14,14,14],["data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>num_obs<\/th>\n      <th>num_treated<\/th>\n      <th>num_controls<\/th>\n      <th>num_vars<\/th>\n      <th>name_vars<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sample","targets":1},{"name":"num_obs","targets":2},{"name":"num_treated","targets":3},{"name":"num_controls","targets":4},{"name":"num_vars","targets":5},{"name":"name_vars","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="load-and-preprocess-data" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Load and preprocess data<a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we augment the control groups in LDW-CPS-1 and LDW-PSID-1 by merging them with the experimental controls from LDW-Experimental. This approach follows the methodology laid out by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>. These expanded samples are used solely for comparative purposes, while all primary analyses rely on the original LDW‑CPS-1 and LDW‑PSID-1 samples.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-1" tabindex="-1"></a><span class="co"># assigns 1 to the experimental controls</span></span>
<span id="cb49-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-2" tabindex="-1"></a>ldw_co<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-4" tabindex="-1"></a><span class="co"># merge experimental data with CPS-1 data</span></span>
<span id="cb49-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-5" tabindex="-1"></a>ldw_cps_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb49-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-6" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls </span></span>
<span id="cb49-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-7" tabindex="-1"></a>  ldw_cps    <span class="co"># CPS-1 data </span></span>
<span id="cb49-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-8" tabindex="-1"></a>)</span>
<span id="cb49-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-9" tabindex="-1"></a></span>
<span id="cb49-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-10" tabindex="-1"></a><span class="co"># merge experimental data with PSID-1 data</span></span>
<span id="cb49-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-11" tabindex="-1"></a>ldw_psid_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb49-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-12" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls </span></span>
<span id="cb49-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-13" tabindex="-1"></a>  ldw_psid   <span class="co"># PSID-1 data </span></span>
<span id="cb49-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-14" tabindex="-1"></a>)</span>
<span id="cb49-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-15" tabindex="-1"></a></span>
<span id="cb49-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-16" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw_cps_plus  =</span> ldw_cps_plus, <span class="at">ldw_psid_plus =</span> ldw_psid_plus)</span>
<span id="cb49-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-17" tabindex="-1"></a></span>
<span id="cb49-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-18" tabindex="-1"></a><span class="co"># print and inspect each sample</span></span>
<span id="cb49-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-19" tabindex="-1"></a>summary_stats_plus <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(samples)</span>
<span id="cb49-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-20" tabindex="-1"></a><span class="fu">datatable</span>(summary_stats_plus, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>,</span>
<span id="cb49-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb49-21" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2e17466358a46d139971" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e17466358a46d139971">{"x":{"filter":"none","vertical":false,"caption":"<caption>Summary Statistics<\/caption>","data":[["1","2"],["ldw_cps_plus","ldw_psid_plus"],[16437,2935],[445,445],[15992,2490],[14,14],["data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>num_obs<\/th>\n      <th>num_treated<\/th>\n      <th>num_controls<\/th>\n      <th>num_vars<\/th>\n      <th>name_vars<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sample","targets":1},{"name":"num_obs","targets":2},{"name":"num_treated","targets":3},{"name":"num_controls","targets":4},{"name":"num_vars","targets":5},{"name":"name_vars","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ldw-model-a" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> LDW-Model A<a href="lalonde-dehejia-wahba-ldw-data.html#ldw-model-a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we define model A as the baseline specification underlying the analysis before we proceed to analyze overlap.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb50-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb50-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb50-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span> </span>
<span id="cb50-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb50-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span> </span>
<span id="cb50-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb50-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, </span>
<span id="cb50-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb50-5" tabindex="-1"></a>           <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>) <span class="co">#re74 included</span></span></code></pre></div>
<p>The model formula is as following.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb51-1" tabindex="-1"></a><span class="co"># set model formula</span></span>
<span id="cb51-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb51-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(treat, <span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(covar, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)))</span></code></pre></div>
</div>
<div id="pre-assessing-methods" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Pre-assessing methods<a href="lalonde-dehejia-wahba-ldw-data.html#pre-assessing-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overlap" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Overlap<a href="lalonde-dehejia-wahba-ldw-data.html#overlap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To identify the average causal effect under unconfoundedness (that asserts that the treatment assignment is independent of the potential outcomes), it must be ensured that one can estimate the average effect at every value for the covariates. Thus, overlap between the treated and untreated units (meaning that for every combination of covariates, there are both treated and untreated units in the sample) is required. To assess overlap in the propensity scores and visualize the results using histograms of their log-odds, we use the <code>assess_overlap()</code> function introduced by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="callout-note">
<p>In a properly balanced experimental design, the distributions of the treatment group (red) and the control group (gray) would show considerable coverage.</p>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb52-1" tabindex="-1"></a>ldw.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -1.310867 0.7158619</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-53-1.png" alt="FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 2.1: FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb54-1" tabindex="-1"></a>ldw_cps.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 1.787343</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-53-2.png" alt="FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 2.2: FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb56-1" tabindex="-1"></a>ldw_psid.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.752723</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-53-3.png" alt="FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 2.3: FIGUREA1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<p>As anticipated, LDW-Experimental exhibits an almost perfect overlap. In contrast, the observational samples LDW-CPS-1 and LDW-PSID-1 show poor overlap. Notably, many treated units have propensity scores outside the range of the controls, while a large share of control units have propensity scores concentrated at very low log-odds.</p>
<p>Next, the overlap of the expanded observational samples is examined.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb58-1" tabindex="-1"></a>ldw_cps_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.63151</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-54-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-54-1.png" alt="FIGUREA1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.4: FIGUREA1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb60-1" tabindex="-1"></a>ldw_psid_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -16.1181 7.271394</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-54-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-54-2.png" alt="FIGUREA1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.5: FIGUREA1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<p>As expected, the samples LDW-CPS1-PLUS and LDW-PSID1-PLUS show an improved overlap compared to their non-plus states. However, they only serve as a reference for comparison.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-1" tabindex="-1"></a><span class="co"># combine results</span></span>
<span id="cb62-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-2" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(ldw, ldw_cps, ldw_psid, ldw_cps_plus, ldw_psid_plus)</span>
<span id="cb62-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-3" tabindex="-1"></a>plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>,<span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>, <span class="st">&quot;(D) LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(E) LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb62-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-5" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb62-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-6" tabindex="-1"></a><span class="fu">save_overlap_panels</span>(</span>
<span id="cb62-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-7" tabindex="-1"></a>  <span class="at">data_list =</span> data_list,</span>
<span id="cb62-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-8" tabindex="-1"></a>  <span class="at">treat     =</span> treat,</span>
<span id="cb62-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-9" tabindex="-1"></a>  <span class="at">covar     =</span> covar,</span>
<span id="cb62-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-10" tabindex="-1"></a>  <span class="at">plot_titles =</span> plot_titles,</span>
<span id="cb62-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-11" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_overlap_model_a_panels&quot;</span></span>
<span id="cb62-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb62-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## -1.310867 0.7158619</code></pre>
<pre><code>## -16.1181 1.787343</code></pre>
<pre><code>## -16.1181 3.752723</code></pre>
<pre><code>## -16.1181 3.63151</code></pre>
<pre><code>## -16.1181 7.271394</code></pre>
<div class="callout-note">
<p>For the subsequent analysis aimed at achieving adequate overlap, only the two samples LDW-CPS-1 and LDW-PSID-1 are considered. However, since covariate imbalance can induce bias even in the presence of overlap, it remains crucial to also ensure sufficient balance on observed covariates in these samples. The LDW-Experimental sample is excluded from these steps, as randomization already ensures adequate overlap.</p>
</div>
</div>
</div>
<div id="improving-overlap" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Improving overlap<a href="lalonde-dehejia-wahba-ldw-data.html#improving-overlap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-methods" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Single methods<a href="lalonde-dehejia-wahba-ldw-data.html#single-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-2" class="section level4 hasAnchor" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The purpose of trimming is to remove units whose propensity scores are too dissimilar from the counterfactual group, thereby improving overlap. Below, we employ several trimming methods in line with the approaches proposed by <span class="citation">Stürmer et al. (<a href="#ref-Stuermer_2021">2021</a>)</span> and <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<ol style="list-style-type: decimal">
<li>Propensity score threshold trimming</li>
</ol>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-1" tabindex="-1"></a><span class="co"># apply trimming with a (maximum) threshold </span></span>
<span id="cb68-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-2" tabindex="-1"></a>ldw_cps.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb68-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-3" tabindex="-1"></a>ldw_psid.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb68-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-4" tabindex="-1"></a></span>
<span id="cb68-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb68-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-6" tabindex="-1"></a>ldw_cps.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_trim, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb68-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-7" tabindex="-1"></a>ldw_psid.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_trim, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Common range trimming</li>
</ol>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-1" tabindex="-1"></a><span class="co"># trim observations outside the common support region of propensity scores</span></span>
<span id="cb69-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-2" tabindex="-1"></a>ldw_cps.ps_common   <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_cps.ps)</span>
<span id="cb69-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-3" tabindex="-1"></a>ldw_psid.ps_common  <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_psid.ps)</span>
<span id="cb69-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-4" tabindex="-1"></a></span>
<span id="cb69-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb69-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-6" tabindex="-1"></a>ldw_cps.ps_common <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_common, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb69-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-7" tabindex="-1"></a>ldw_psid.ps_common <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_common, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Crump trimming</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-1" tabindex="-1"></a><span class="co"># trim observations with propensity scores outside an interval</span></span>
<span id="cb70-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-2" tabindex="-1"></a>ldw_cps.ps_crump  <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_cps.ps)</span>
<span id="cb70-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-3" tabindex="-1"></a>ldw_psid.ps_crump <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_psid.ps)</span>
<span id="cb70-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-4" tabindex="-1"></a></span>
<span id="cb70-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb70-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-6" tabindex="-1"></a>ldw_cps.ps_crump <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_crump, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb70-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb70-7" tabindex="-1"></a>ldw_psid.ps_crump <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_crump, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Stuermer trimming</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-1" tabindex="-1"></a><span class="co"># trim observations based on propensity score quantiles separately for treated and control</span></span>
<span id="cb71-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-2" tabindex="-1"></a>ldw_cps.ps_stuermer  <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_cps.ps, <span class="at">lower_percentile =</span> <span class="fl">0.01</span>, <span class="at">upper_percentile =</span> <span class="fl">0.99</span>)</span>
<span id="cb71-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-3" tabindex="-1"></a>ldw_psid.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_psid.ps, <span class="at">lower_percentile =</span> <span class="fl">0.01</span>, <span class="at">upper_percentile =</span> <span class="fl">0.99</span>)</span>
<span id="cb71-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb71-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-6" tabindex="-1"></a>ldw_cps.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_stuermer, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb71-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-7" tabindex="-1"></a>ldw_psid.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_stuermer, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Walker trimming</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-1" tabindex="-1"></a><span class="co"># trim observations based on preference scores that adjust for treatment prevalence using logit transformations</span></span>
<span id="cb72-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-2" tabindex="-1"></a>ldw_cps.ps_walker  <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_cps.ps)</span>
<span id="cb72-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-3" tabindex="-1"></a>ldw_psid.ps_walker <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_psid.ps)</span>
<span id="cb72-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb72-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-6" tabindex="-1"></a>ldw_cps.ps_walker <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_walker, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb72-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb72-7" tabindex="-1"></a>ldw_psid.ps_walker <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_walker, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
</div>
</div>
<div id="integrated-methods-2" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-and-matching" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Trimming and matching<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-and-matching" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The purpose of integrating trimming and matching is to address not only poor overlap, but also covariate imbalance. Matching creates comparable treated and control groups by pairing units with similar covariate profiles, thereby reducing covariate imbalance and confounding bias. We apply several matching methods as outlined by <span class="citation">Greifer (<a href="#ref-Greifer_3_2025">2025</a>)</span> in the following.</p>
<div class="callout-note">
<p>For comparison, an integrated method combining (maximum) threshold trimming and 1:1 matching is applied consistent with the procedure in the tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>, before all combinations of proposed trimming and matching method are applied to the initial observational samples.</p>
</div>
<div id="extended-samples" class="section level5 hasAnchor" number="2.4.2.1.1">
<h5><span class="header-section-number">2.4.2.1.1</span> Extended samples<a href="lalonde-dehejia-wahba-ldw-data.html#extended-samples" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>(Similar to tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-1" tabindex="-1"></a><span class="co"># apply trimming with a (maximum) threshold </span></span>
<span id="cb73-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-2" tabindex="-1"></a>ldw_cps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps_plus.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb73-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-3" tabindex="-1"></a>ldw_psid_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid_plus.ps, <span class="at">threshold =</span> <span class="fl">0.8</span>)</span>
<span id="cb73-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-5" tabindex="-1"></a><span class="co"># excluding the experimental controls</span></span>
<span id="cb73-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-6" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb73-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-7" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb73-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-8" tabindex="-1"></a></span>
<span id="cb73-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-9" tabindex="-1"></a><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span id="cb73-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-10" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_cps.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb73-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-11" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_psid.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb73-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-12" tabindex="-1"></a></span>
<span id="cb73-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-13" tabindex="-1"></a><span class="co"># further subset data and re-assign treat variable </span></span>
<span id="cb73-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-14" tabindex="-1"></a>ldw_trim_cps <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> ps_assoverlap <span class="sc">&lt;=</span> <span class="fl">0.9</span>)</span>
<span id="cb73-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-15" tabindex="-1"></a>ldw_trim_cps<span class="sc">$</span>treat[<span class="fu">which</span>(ldw_trim_cps<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb73-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-16" tabindex="-1"></a></span>
<span id="cb73-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-17" tabindex="-1"></a>ldw_trim_psid <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> ps_assoverlap <span class="sc">&lt;=</span> <span class="fl">0.8</span>)</span>
<span id="cb73-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-18" tabindex="-1"></a>ldw_trim_psid<span class="sc">$</span>treat[<span class="fu">which</span>(ldw_trim_psid<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div id="initial-samples" class="section level5 hasAnchor" number="2.4.2.1.2">
<h5><span class="header-section-number">2.4.2.1.2</span> Initial samples<a href="lalonde-dehejia-wahba-ldw-data.html#initial-samples" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-1" tabindex="-1"></a><span class="co"># combine trimmed samples</span></span>
<span id="cb74-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-2" tabindex="-1"></a>all_trim.cps  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb74-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-3" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_cps.ps_trim, </span>
<span id="cb74-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-4" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_cps.ps_common, </span>
<span id="cb74-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-5" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_cps.ps_stuermer, </span>
<span id="cb74-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-6" tabindex="-1"></a>  <span class="at">walker =</span> ldw_cps.ps_walker, </span>
<span id="cb74-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-7" tabindex="-1"></a>  <span class="at">crump =</span> ldw_cps.ps_crump)</span>
<span id="cb74-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-8" tabindex="-1"></a></span>
<span id="cb74-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-9" tabindex="-1"></a>all_trim.psid  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb74-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-10" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_psid.ps_trim, </span>
<span id="cb74-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-11" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_psid.ps_common, </span>
<span id="cb74-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-12" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_psid.ps_stuermer, </span>
<span id="cb74-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-13" tabindex="-1"></a>  <span class="at">walker =</span> ldw_psid.ps_walker, </span>
<span id="cb74-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb74-14" tabindex="-1"></a>  <span class="at">crump =</span> ldw_psid.ps_crump)</span></code></pre></div>
<div id="distance-matching" class="section level6 hasAnchor" number="2.4.2.1.2.1">
<h6><span class="header-section-number">2.4.2.1.2.1</span> Distance matching<a href="lalonde-dehejia-wahba-ldw-data.html#distance-matching" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol style="list-style-type: decimal">
<li>1:1 Nearest neighbor matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb75-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=1, logistic propensity score and replacement </span></span>
<span id="cb75-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb75-2" tabindex="-1"></a>nn_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb75-3" tabindex="-1"></a>nn_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>k:1 matching (k=2) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb76-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=2, logistic propensity score and replacement </span></span>
<span id="cb76-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb76-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb76-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb76-3" tabindex="-1"></a>k2_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb76-4" tabindex="-1"></a>k2_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>k:1 matching (k=3) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb77-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=3, logistic propensity score and replacement</span></span>
<span id="cb77-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb77-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb77-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb77-3" tabindex="-1"></a>k3_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb77-4" tabindex="-1"></a>k3_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Caliper matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb78-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with a caliper of 0.1 on the logistic propensity score and replacement </span></span>
<span id="cb78-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb78-2" tabindex="-1"></a>caliper_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb78-3" tabindex="-1"></a>caliper_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Common support restriction matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb79-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with exclusion of units outside common support and replacement</span></span>
<span id="cb79-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb79-2" tabindex="-1"></a>cs_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">reestimate =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb79-3" tabindex="-1"></a>cs_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">reestimate =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Mahalanobis distance matching (mahvars) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb80-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching using mahalanobis distance without replacement</span></span>
<span id="cb80-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb80-2" tabindex="-1"></a>mahvars_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb80-3" tabindex="-1"></a>mahvars_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Optimal pair matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb81-1" tabindex="-1"></a><span class="co"># perform optimal pair matching that minimizes total within-pair distance on propensity scores</span></span>
<span id="cb81-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb81-2" tabindex="-1"></a>optimal_pair_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb81-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb81-3" tabindex="-1"></a>optimal_pair_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Optimal full matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb82-1" tabindex="-1"></a><span class="co"># perform optimal full matching allowing sets with varying ratios of treated to controls and minimizing a global distance criterion</span></span>
<span id="cb82-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb82-2" tabindex="-1"></a>optimal_full_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb82-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb82-3" tabindex="-1"></a>optimal_full_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Generalized full matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb83-1" tabindex="-1"></a><span class="co"># perform generalized full matching using fast approximation and producing matched sets with flexible treated/control ratios </span></span>
<span id="cb83-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb83-2" tabindex="-1"></a>general_full_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb83-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb83-3" tabindex="-1"></a>general_full_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>Genetic matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-1" tabindex="-1"></a><span class="co"># perform genetic matching </span></span>
<span id="cb84-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-2" tabindex="-1"></a>genetic_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span>
<span id="cb84-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-3" tabindex="-1"></a>genetic_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span></code></pre></div>
</div>
<div id="stratum-matching" class="section level6 hasAnchor" number="2.4.2.1.2.2">
<h6><span class="header-section-number">2.4.2.1.2.2</span> Stratum matching<a href="lalonde-dehejia-wahba-ldw-data.html#stratum-matching" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol start="11" style="list-style-type: decimal">
<li>Exact matching (exact)</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-1" tabindex="-1"></a><span class="co"># match units exactly by raw covariate profiles </span></span>
<span id="cb85-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-2" tabindex="-1"></a>exact_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span>
<span id="cb85-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-3" tabindex="-1"></a>exact_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
<pre><code>## MATCHING SUMMARY: 3 succeeded, 2 failed. Failed: walker,</code></pre>
<ol start="12" style="list-style-type: decimal">
<li>Coarsened matching (cem)</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-1" tabindex="-1"></a><span class="co"># match units exactly within coarse strata </span></span>
<span id="cb87-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-2" tabindex="-1"></a>cem_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span>
<span id="cb87-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-3" tabindex="-1"></a>cem_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span></code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li>Subclassification</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-1" tabindex="-1"></a><span class="co"># partition sample into fixed number of bins based on propensity score </span></span>
<span id="cb88-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-2" tabindex="-1"></a>subcl_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">3</span>)</span>
<span id="cb88-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-3" tabindex="-1"></a>subcl_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="pure-subset-selection" class="section level6 hasAnchor" number="2.4.2.1.2.3">
<h6><span class="header-section-number">2.4.2.1.2.3</span> Pure subset selection<a href="lalonde-dehejia-wahba-ldw-data.html#pure-subset-selection" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol start="14" style="list-style-type: decimal">
<li>Cardinality profile matching</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-1" tabindex="-1"></a><span class="co"># select largest balanced subsample meeting covariate balance tolerances and a fixed ratio of controls to treated units</span></span>
<span id="cb89-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-2" tabindex="-1"></a>card_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span>
<span id="cb89-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-3" tabindex="-1"></a>card_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span></code></pre></div>
<ol start="15" style="list-style-type: decimal">
<li>Profile matching</li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-1" tabindex="-1"></a><span class="co"># select the largest control group subset balanced to the treated group (for ATT), leaving the treated group intact</span></span>
<span id="cb90-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-2" tabindex="-1"></a>profile_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span>
<span id="cb90-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-3" tabindex="-1"></a>profile_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="post-assessing-methods" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Post-assessing methods<a href="lalonde-dehejia-wahba-ldw-data.html#post-assessing-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now systematically reassess all methods described above by evaluating the overlapping coefficient (OVL) and the absolute standardized mean differences (ASMD). Specifically, we compute the ASMD and OVL for each approach to determine the most efficient methods for the observational samples.</p>
<div id="single-methods-1" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Single methods<a href="lalonde-dehejia-wahba-ldw-data.html#single-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-3" class="section level4 hasAnchor" number="2.5.1.1">
<h4><span class="header-section-number">2.5.1.1</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="smd" class="section level5 hasAnchor" number="2.5.1.1.1">
<h5><span class="header-section-number">2.5.1.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb91-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-2" tabindex="-1"></a>smd_trim.cps <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(all_trim.cps, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb91-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-3" tabindex="-1"></a>smd_trim.psid <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(all_trim.psid, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ovl" class="section level5 hasAnchor" number="2.5.1.1.2">
<h5><span class="header-section-number">2.5.1.1.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data.html#ovl" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb92-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-2" tabindex="-1"></a>ovl_trim.cps <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(all_trim.cps, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span>
<span id="cb92-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-3" tabindex="-1"></a>ovl_trim.psid <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(all_trim.psid, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="integrated-methods-3" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-and-matching-1" class="section level4 hasAnchor" number="2.5.2.1">
<h4><span class="header-section-number">2.5.2.1</span> Trimming and matching<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-and-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="extended-samples-1" class="section level5 hasAnchor" number="2.5.2.1.1">
<h5><span class="header-section-number">2.5.2.1.1</span> Extended samples<a href="lalonde-dehejia-wahba-ldw-data.html#extended-samples-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>(Similar to tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-1" tabindex="-1"></a><span class="co"># list all trimmed and matched samples</span></span>
<span id="cb93-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-2" tabindex="-1"></a>trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold_match =</span> ldw_cps.trim_match)</span>
<span id="cb93-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-3" tabindex="-1"></a>trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold_match =</span> ldw_psid.trim_match)</span></code></pre></div>
<div id="smd-1" class="section level6 hasAnchor" number="2.5.2.1.1.1">
<h6><span class="header-section-number">2.5.2.1.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb94-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-2" tabindex="-1"></a>smd_trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim_match_comb.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb94-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-3" tabindex="-1"></a>smd_trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim_match_comb.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ovl-1" class="section level6 hasAnchor" number="2.5.2.1.1.2">
<h6><span class="header-section-number">2.5.2.1.1.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data.html#ovl-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb95-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-2" tabindex="-1"></a>ovl_trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(trim_match_comb.cps_plus, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span>
<span id="cb95-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-3" tabindex="-1"></a>ovl_trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(trim_match_comb.psid_plus, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="initial-samples-1" class="section level5 hasAnchor" number="2.5.2.1.2">
<h5><span class="header-section-number">2.5.2.1.2</span> Initial samples<a href="lalonde-dehejia-wahba-ldw-data.html#initial-samples-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-1" tabindex="-1"></a><span class="co"># list all trimmed and matched samples</span></span>
<span id="cb96-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-2" tabindex="-1"></a>trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb96-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-3" tabindex="-1"></a>  <span class="at">nn =</span> nn_trim_comb.cps, </span>
<span id="cb96-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-4" tabindex="-1"></a>  <span class="at">k2 =</span> k2_trim_comb.cps,</span>
<span id="cb96-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-5" tabindex="-1"></a>  <span class="at">k3 =</span> k3_trim_comb.cps, </span>
<span id="cb96-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-6" tabindex="-1"></a>  <span class="at">caliper =</span> caliper_trim_comb.cps,</span>
<span id="cb96-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-7" tabindex="-1"></a>  <span class="at">cs =</span> cs_trim_comb.cps, </span>
<span id="cb96-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-8" tabindex="-1"></a>  <span class="at">mahvars =</span> mahvars_trim_comb.cps,</span>
<span id="cb96-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-9" tabindex="-1"></a>  <span class="at">optimal_pair =</span> optimal_pair_trim_comb.cps,</span>
<span id="cb96-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-10" tabindex="-1"></a>  <span class="at">optimal_full =</span> optimal_full_trim_comb.cps, </span>
<span id="cb96-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-11" tabindex="-1"></a>  <span class="at">genetic =</span> genetic_trim_comb.cps, </span>
<span id="cb96-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-12" tabindex="-1"></a>  <span class="at">exact =</span> exact_trim_comb.cps,</span>
<span id="cb96-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-13" tabindex="-1"></a>  <span class="at">cem =</span> cem_trim_comb.cps,</span>
<span id="cb96-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-14" tabindex="-1"></a>  <span class="at">subcl =</span> subcl_trim_comb.cps </span>
<span id="cb96-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-15" tabindex="-1"></a>)</span>
<span id="cb96-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-16" tabindex="-1"></a></span>
<span id="cb96-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-17" tabindex="-1"></a>trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb96-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-18" tabindex="-1"></a>  <span class="at">nn =</span> nn_trim_comb.psid,</span>
<span id="cb96-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-19" tabindex="-1"></a>  <span class="at">k2 =</span> k2_trim_comb.psid, </span>
<span id="cb96-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-20" tabindex="-1"></a>  <span class="at">k3 =</span> k3_trim_comb.psid, </span>
<span id="cb96-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-21" tabindex="-1"></a>  <span class="at">caliper =</span> caliper_trim_comb.psid, </span>
<span id="cb96-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-22" tabindex="-1"></a>  <span class="at">cs =</span> cs_trim_comb.psid,</span>
<span id="cb96-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-23" tabindex="-1"></a>  <span class="at">mahvars =</span> mahvars_trim_comb.psid,</span>
<span id="cb96-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-24" tabindex="-1"></a>  <span class="at">optimal_pair =</span> optimal_pair_trim_comb.psid, </span>
<span id="cb96-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-25" tabindex="-1"></a>  <span class="at">optimal_full =</span> optimal_full_trim_comb.psid, </span>
<span id="cb96-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-26" tabindex="-1"></a>  <span class="at">genetic =</span> genetic_trim_comb.psid,</span>
<span id="cb96-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-27" tabindex="-1"></a>  <span class="at">exact =</span> exact_trim_comb.psid,</span>
<span id="cb96-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-28" tabindex="-1"></a>  <span class="at">cem =</span> cem_trim_comb.psid,</span>
<span id="cb96-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-29" tabindex="-1"></a>  <span class="at">subcl =</span> subcl_trim_comb.psid </span>
<span id="cb96-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-30" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-2" class="section level6 hasAnchor" number="2.5.2.1.2.1">
<h6><span class="header-section-number">2.5.2.1.2.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb97-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-2" tabindex="-1"></a>smd_trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(trim_match_comb.cps, all_trim.cps) </span>
<span id="cb97-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-3" tabindex="-1"></a>smd_trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(trim_match_comb.psid, all_trim.psid)</span></code></pre></div>
</div>
<div id="ovl-2" class="section level6 hasAnchor" number="2.5.2.1.2.2">
<h6><span class="header-section-number">2.5.2.1.2.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data.html#ovl-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb98-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-2" tabindex="-1"></a>ovl_trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">compute_ovl_matchit</span>(trim_match_comb.cps, all_trim.cps, <span class="at">ps =</span> <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">covar =</span> covar)</span>
<span id="cb98-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-3" tabindex="-1"></a>ovl_trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">compute_ovl_matchit</span>(trim_match_comb.psid, all_trim.psid, <span class="at">ps =</span> <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">covar =</span> covar)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="identifying-most-efficient-methods" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Identifying most efficient methods<a href="lalonde-dehejia-wahba-ldw-data.html#identifying-most-efficient-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ranking" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Ranking<a href="lalonde-dehejia-wahba-ldw-data.html#ranking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To identify the top five methods for each observational sample, we first combine for each sample all results of the mean ASMD and OVL into a single data frame. This allows for a comprehensive comparison across all methods.</p>
<div class="callout-note">
<p>Only results based on the non-plus samples are included in the identification of the most efficient methods, as the objective is to identify the overall top-performing methods for the original observational samples.</p>
</div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb99-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-2" tabindex="-1"></a>all_cps <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;cps&quot;</span>)</span>
<span id="cb99-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-3" tabindex="-1"></a>all_psid <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;psid&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb100-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-2" tabindex="-1"></a><span class="fu">save_csv</span>(all_cps, <span class="st">&quot;ldw_model_a_cps1_all_results&quot;</span>)</span>
<span id="cb100-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-3" tabindex="-1"></a><span class="fu">save_csv</span>(all_psid, <span class="st">&quot;ldw_model_a_psid1_all_results&quot;</span>)</span></code></pre></div>
<p>Next, each method is evaluated according to its OVL and mean ASMD result. Specifically, the top five methods are selected based on the highest OVL value, as higher values indicate greater overlap between treated and control groups, before those are reranked based on the mean ASMD, where lower values indicate higher degrees of covariate balance.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-1" tabindex="-1"></a><span class="co"># rank comparatively</span></span>
<span id="cb101-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-2" tabindex="-1"></a>ranked_cps  <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_cps)</span>
<span id="cb101-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-3" tabindex="-1"></a>ranked_psid <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_psid)</span>
<span id="cb101-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-5" tabindex="-1"></a><span class="co"># get top 5 methods</span></span>
<span id="cb101-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-6" tabindex="-1"></a>top5_methods.cps <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_cps, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb101-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-7" tabindex="-1"></a>top5_methods.psid <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_psid, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb101-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-8" tabindex="-1"></a></span>
<span id="cb101-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-9" tabindex="-1"></a><span class="co"># rerank top 5 methods</span></span>
<span id="cb101-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-10" tabindex="-1"></a>top5_methods_df.cps <span class="ot">&lt;-</span> ranked_cps <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(OVL)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Mean_Abs_SMD)</span>
<span id="cb101-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-11" tabindex="-1"></a>top5_methods_df.psid <span class="ot">&lt;-</span> ranked_psid <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(OVL)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Mean_Abs_SMD)</span>
<span id="cb101-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-12" tabindex="-1"></a></span>
<span id="cb101-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-13" tabindex="-1"></a><span class="co"># get results</span></span>
<span id="cb101-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-14" tabindex="-1"></a>top5_methods.cps <span class="ot">&lt;-</span> top5_methods_df.cps<span class="sc">$</span>Method</span>
<span id="cb101-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-15" tabindex="-1"></a>top5_methods.psid <span class="ot">&lt;-</span> top5_methods_df.psid<span class="sc">$</span>Method</span>
<span id="cb101-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-16" tabindex="-1"></a></span>
<span id="cb101-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-17" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb101-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-18" tabindex="-1"></a><span class="fu">datatable</span>(top5_methods_df.cps, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for CPS-1&quot;</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-6e8228581aa3e4de6c04" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6e8228581aa3e4de6c04">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top 5 Methods for CPS-1<\/caption>","data":[["1","2","3","4","5"],["genetic_crump","cem_stuermer","k2_crump","cs_crump","nn_crump"],[0.850933186077787,0.8193785911492623,0.7716541936879706,0.7873162267564067,0.7692221715185186],[0.004515425969352413,0.01627673527419387,0.02704156801802792,0.03119385647290294,0.03261487861450352]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>OVL<\/th>\n      <th>Mean_Abs_SMD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"OVL","targets":2},{"name":"Mean_Abs_SMD","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb102-1" tabindex="-1"></a><span class="fu">datatable</span>(top5_methods_df.psid, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for PSID-1&quot;</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d3a15b670239e029179d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d3a15b670239e029179d">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top 5 Methods for PSID-1<\/caption>","data":[["1","2","3","4","5"],["genetic_walker","mahvars_walker","k2_walker","optimal_pair_stuermer","optimal_pair_walker"],[0.8675488561025312,0.8251150991554902,0.8500174800781986,0.8313451765645876,0.8586132679367899],[0.05208158276381278,0.07862041257173061,0.08871457121474206,0.1052693880034169,0.1261359811827029]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>OVL<\/th>\n      <th>Mean_Abs_SMD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"OVL","targets":2},{"name":"Mean_Abs_SMD","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb103-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-2" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.cps, <span class="st">&quot;ldw_model_a_cps1_top5_methods&quot;</span>)</span>
<span id="cb103-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-3" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.psid, <span class="st">&quot;ldw_model_a_psid1_top5_methods&quot;</span>)</span></code></pre></div>
</div>
<div id="sample-construction" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Sample construction<a href="lalonde-dehejia-wahba-ldw-data.html#sample-construction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the subsequent estimation, we need to construct samples based on the top‑ranked methods. Therefore, we match all method names back to their corresponding data, or objects and construct corresponding samples.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-1" tabindex="-1"></a><span class="co"># create lookup lists</span></span>
<span id="cb104-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-2" tabindex="-1"></a>match_lookup_cps <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb104-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-3" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(nn_trim_comb.cps, all_trim.cps, <span class="st">&quot;nn&quot;</span>),</span>
<span id="cb104-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-4" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k2_trim_comb.cps, all_trim.cps, <span class="st">&quot;k2&quot;</span>),</span>
<span id="cb104-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-5" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k3_trim_comb.cps, all_trim.cps, <span class="st">&quot;k3&quot;</span>),</span>
<span id="cb104-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-6" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(caliper_trim_comb.cps, all_trim.cps, <span class="st">&quot;caliper&quot;</span>),</span>
<span id="cb104-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-7" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cs_trim_comb.cps, all_trim.cps, <span class="st">&quot;cs&quot;</span>),</span>
<span id="cb104-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-8" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(mahvars_trim_comb.cps, all_trim.cps, <span class="st">&quot;mahvars&quot;</span>),</span>
<span id="cb104-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-9" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_pair_trim_comb.cps, all_trim.cps, <span class="st">&quot;optimal_pair&quot;</span>),</span>
<span id="cb104-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-10" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_full_trim_comb.cps, all_trim.cps, <span class="st">&quot;optimal_full&quot;</span>),</span>
<span id="cb104-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-11" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(genetic_trim_comb.cps, all_trim.cps, <span class="st">&quot;genetic&quot;</span>),</span>
<span id="cb104-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-12" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(exact_trim_comb.cps, all_trim.cps, <span class="st">&quot;exact&quot;</span>),</span>
<span id="cb104-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-13" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cem_trim_comb.cps, all_trim.cps, <span class="st">&quot;cem&quot;</span>),</span>
<span id="cb104-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-14" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(subcl_trim_comb.cps, all_trim.cps, <span class="st">&quot;subcl&quot;</span>)</span>
<span id="cb104-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-15" tabindex="-1"></a>)</span>
<span id="cb104-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-16" tabindex="-1"></a></span>
<span id="cb104-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-17" tabindex="-1"></a>match_lookup_psid <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb104-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-18" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(nn_trim_comb.psid, all_trim.psid, <span class="st">&quot;nn&quot;</span>),</span>
<span id="cb104-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-19" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k2_trim_comb.psid, all_trim.psid, <span class="st">&quot;k2&quot;</span>),</span>
<span id="cb104-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-20" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k3_trim_comb.psid, all_trim.psid, <span class="st">&quot;k3&quot;</span>),</span>
<span id="cb104-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-21" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(caliper_trim_comb.psid, all_trim.psid, <span class="st">&quot;caliper&quot;</span>),</span>
<span id="cb104-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-22" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cs_trim_comb.psid, all_trim.psid, <span class="st">&quot;cs&quot;</span>),</span>
<span id="cb104-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-23" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(mahvars_trim_comb.psid, all_trim.psid, <span class="st">&quot;mahvars&quot;</span>),</span>
<span id="cb104-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-24" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_pair_trim_comb.psid, all_trim.psid, <span class="st">&quot;optimal_pair&quot;</span>),</span>
<span id="cb104-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-25" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_full_trim_comb.psid, all_trim.psid, <span class="st">&quot;optimal_full&quot;</span>),</span>
<span id="cb104-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-26" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(genetic_trim_comb.psid, all_trim.psid, <span class="st">&quot;genetic&quot;</span>),</span>
<span id="cb104-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-27" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(exact_trim_comb.psid, all_trim.psid, <span class="st">&quot;exact&quot;</span>),</span>
<span id="cb104-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-28" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cem_trim_comb.psid, all_trim.psid, <span class="st">&quot;cem&quot;</span>),</span>
<span id="cb104-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-29" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(subcl_trim_comb.psid, all_trim.psid, <span class="st">&quot;subcl&quot;</span>)</span>
<span id="cb104-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-30" tabindex="-1"></a>)</span>
<span id="cb104-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-31" tabindex="-1"></a></span>
<span id="cb104-32"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-32" tabindex="-1"></a>list_cps <span class="ot">&lt;-</span> <span class="fu">c</span>(all_trim.cps, match_lookup_cps)</span>
<span id="cb104-33"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-33" tabindex="-1"></a>list_psid <span class="ot">&lt;-</span> <span class="fu">c</span>(all_trim.psid, match_lookup_psid)</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-1" tabindex="-1"></a><span class="co"># create samples corresponding to the top 5 methods for each sample</span></span>
<span id="cb105-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-2" tabindex="-1"></a>top5_samples.cps <span class="ot">&lt;-</span> <span class="fu">create_top5_samples</span>(list_cps, top5_methods.cps)</span>
<span id="cb105-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-3" tabindex="-1"></a>top5_samples.psid <span class="ot">&lt;-</span> <span class="fu">create_top5_samples</span>(list_psid, top5_methods.psid)</span>
<span id="cb105-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-4" tabindex="-1"></a></span>
<span id="cb105-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-5" tabindex="-1"></a><span class="co"># extract top 5 objects </span></span>
<span id="cb105-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-6" tabindex="-1"></a>top5_objects.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_methods.cps, <span class="cf">function</span>(d) list_cps[[d]])</span>
<span id="cb105-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-7" tabindex="-1"></a>top5_objects.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_methods.psid, <span class="cf">function</span>(d) list_psid[[d]])</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-1" tabindex="-1"></a><span class="co"># save samples into .RData files</span></span>
<span id="cb106-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-2" tabindex="-1"></a><span class="fu">save_top5_samples</span>(list_cps, top5_methods.cps, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_cps1&quot;</span>)</span>
<span id="cb106-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-3" tabindex="-1"></a><span class="fu">save_top5_samples</span>(list_psid, top5_methods.psid, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_psid1&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="estimating-1" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Estimating<a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-treatment-effect-on-the-treated-att" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Average treatment effect on the treated (ATT)<a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we estimate the average treatment effect on the treated (ATT) using the LDW-Experimental sample, the top‑ranked observational samples (LDW‑CPS-1 and LDW‑PSID-1), and, for comparison, the plus‑samples. We employ a suite of estimators, including difference-in-means, regression adjustment, the Oaxaca-Blinder estimator, generalized random forests (GRF) as an outcome model, 1:5 nearest neighbor matching with bias correction, inverse probability weighting (IPW) with GRF-based propensity scores, covariate balancing propensity score (CBPS), entropy balancing, double/debiased machine learning using elastic net, and augmented inverse probability weighting via GRF (AIPW-GRF). We also incorporate the recently introduced estimand-specific AIPW estimator implemented through an expansion of the <code>OutcomeWeights</code> R package by <span class="citation">Knaus and Pfleiderer (<a href="#ref-OW_Package">2024</a>)</span> (AIPW-OW). We utilize the <code>estimate_all()</code> and <code>plot_coef()</code> functions as defined by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-1" tabindex="-1"></a><span class="co"># estimate ATT</span></span>
<span id="cb107-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-2" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb107-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-3" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb107-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-4" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb108-1" tabindex="-1"></a>out.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb108-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb108-2" tabindex="-1"></a>out.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb108-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb108-3" tabindex="-1"></a>out.cps_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb108-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb108-4" tabindex="-1"></a>out.psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/trimmed.RData&quot;</span>)</span>
<span id="cb109-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-2" tabindex="-1"></a>out4 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb109-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-3" tabindex="-1"></a>out5 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb109-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-4" tabindex="-1"></a>out6 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps_trim, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb109-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-5" tabindex="-1"></a>out7 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid_trim, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="callout-note">
<p>In each plot the black dots represent the ATT point estimates from the respective sample. The red dashed line indicates the respective benchmark and the light red band the 95% confidence interval.</p>
</div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb110-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-2" tabindex="-1"></a></span>
<span id="cb110-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-3" tabindex="-1"></a><span class="co"># get experimental benchmark</span></span>
<span id="cb110-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-4" tabindex="-1"></a>band.exp <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb110-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-5" tabindex="-1"></a>est.exp  <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb110-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-7" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb110-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out1,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp, </span>
<span id="cb110-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(A) LDW-Experimental&quot;</span>)</span>
<span id="cb110-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-10" tabindex="-1"></a></span>
<span id="cb110-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out2,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp, </span>
<span id="cb110-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>)</span>
<span id="cb110-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-13" tabindex="-1"></a></span>
<span id="cb110-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-14" tabindex="-1"></a><span class="fu">plot_coef</span>(out3,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp,</span>
<span id="cb110-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-15" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb110-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-16" tabindex="-1"></a></span>
<span id="cb110-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-17" tabindex="-1"></a><span class="co"># get benchmarks</span></span>
<span id="cb110-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-18" tabindex="-1"></a>method_names_cps <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.cps, <span class="cf">function</span>(m) {</span>
<span id="cb110-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-19" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb110-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb110-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-21" tabindex="-1"></a>})</span>
<span id="cb110-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-22" tabindex="-1"></a>method_names_psid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.psid, <span class="cf">function</span>(m) {</span>
<span id="cb110-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-23" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb110-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-24" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb110-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-25" tabindex="-1"></a>})</span>
<span id="cb110-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-26" tabindex="-1"></a></span>
<span id="cb110-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-27" tabindex="-1"></a>band.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb110-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-28" tabindex="-1"></a>est.cps  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb110-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-29" tabindex="-1"></a>band.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb110-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-30" tabindex="-1"></a>est.psid  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb110-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-31" tabindex="-1"></a></span>
<span id="cb110-32"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-32" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb110-33"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-33" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.cps)) {</span>
<span id="cb110-34"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-34" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps[i])</span>
<span id="cb110-35"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-35" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.cps[[i]], <span class="at">band =</span> band.cps[[i]], <span class="at">line =</span> est.cps[[i]],</span>
<span id="cb110-36"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-36" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb110-37"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-37" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-96-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-96-1.png" alt="FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.6: FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-96-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-96-2.png" alt="FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.7: FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.psid)) {</span>
<span id="cb111-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-2" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid[i])</span>
<span id="cb111-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-3" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.psid[[i]], <span class="at">band =</span> band.psid[[i]], <span class="at">line =</span> est.psid[[i]],</span>
<span id="cb111-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-4" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb111-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-96-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-96-3.png" alt="FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.8: FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-1" tabindex="-1"></a><span class="co"># get benchmarks</span></span>
<span id="cb112-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-2" tabindex="-1"></a>band.cps_plus <span class="ot">&lt;-</span> out4[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb112-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-3" tabindex="-1"></a>est.cps_plus <span class="ot">&lt;-</span> out4[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb112-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-4" tabindex="-1"></a>band.psid_plus <span class="ot">&lt;-</span> out5[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb112-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-5" tabindex="-1"></a>est.psid_plus <span class="ot">&lt;-</span> out5[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb112-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-6" tabindex="-1"></a></span>
<span id="cb112-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-7" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb112-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out6, <span class="at">band =</span> band.cps_plus, <span class="at">line =</span> est.cps_plus, </span>
<span id="cb112-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>)</span>
<span id="cb112-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-10" tabindex="-1"></a></span>
<span id="cb112-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out7, <span class="at">band =</span> band.psid_plus, <span class="at">line =</span> est.psid_plus, </span>
<span id="cb112-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-96-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-96-4.png" alt="FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.9: FIGUREA2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1. SubfigureD-H:Top-LDW-CPS1. SubfigureI-M:Top-LDW-PSID1. SubfigureN:LDW-CPS1-PLUS. SubfigureO:LDW-PSID1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-1" tabindex="-1"></a><span class="co"># get all outputs</span></span>
<span id="cb113-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-2" tabindex="-1"></a>all_outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1, out2, out3), out.cps, out.psid, <span class="fu">list</span>(out6, out7))</span>
<span id="cb113-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-3" tabindex="-1"></a></span>
<span id="cb113-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-4" tabindex="-1"></a><span class="co"># get all plot titles</span></span>
<span id="cb113-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-5" tabindex="-1"></a>all_plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>, <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>,</span>
<span id="cb113-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-6" tabindex="-1"></a>                      <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps),</span>
<span id="cb113-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-7" tabindex="-1"></a>                      <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid),</span>
<span id="cb113-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-8" tabindex="-1"></a>                      <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb113-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-9" tabindex="-1"></a></span>
<span id="cb113-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-10" tabindex="-1"></a><span class="co"># get all confidence interval bounds</span></span>
<span id="cb113-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-11" tabindex="-1"></a>all_bands <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(band.exp, band.exp, band.exp), band.cps, band.psid, <span class="fu">list</span>(band.cps_plus, band.psid_plus))</span>
<span id="cb113-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-12" tabindex="-1"></a>all_ests <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(est.exp, est.exp, est.exp), est.cps, est.psid, <span class="fu">list</span>(est.cps_plus, est.psid_plus))</span>
<span id="cb113-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-13" tabindex="-1"></a></span>
<span id="cb113-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-14" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb113-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-15" tabindex="-1"></a><span class="fu">save_att_panels</span>(</span>
<span id="cb113-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-16" tabindex="-1"></a>    <span class="at">out_list    =</span> all_outs,</span>
<span id="cb113-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-17" tabindex="-1"></a>    <span class="at">plot_titles =</span> all_plot_titles,</span>
<span id="cb113-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-18" tabindex="-1"></a>    <span class="at">band_list   =</span> all_bands,</span>
<span id="cb113-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-19" tabindex="-1"></a>    <span class="at">est_list    =</span> all_ests,</span>
<span id="cb113-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-20" tabindex="-1"></a>    <span class="at">prefix      =</span> <span class="st">&quot;ldw_model_a_est_comb&quot;</span></span>
<span id="cb113-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-21" tabindex="-1"></a>)</span></code></pre></div>
<p>The above figures show the ATT estimates and their 95% confidence intervals for fifteen samples: LDW-Experimental, LDW-CPS-1, LDW-PSID-1, a series of top-ranked samples of both LDW-CPS-1 and LDW-PSID-1 based on various trimming and integrated trimming and matching criteria and trimmed and matched versions of the LDW-CPS-1-PLUS and LDW-PSID-1-PLUS samples (similar to <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>).</p>
<p>Figure (A) presents the benchmark from the experimental sample (LDW-Experimental), serving as a reference for bias and variance assessment of observational samples. Figures (B) and (C) show results for the original observational samples, LDW-CPS-1 and LDW-PSID-1, while figures (D) through (H) display results for LDW-CPS-1-based samples constructed with the top-ranked methods. Analogously, figures (I) through (M) summarize results for the corresponding LDW-PSID-1-based samples under parallel rules. Figures (N) and (O) present results for the trimmed and matched versions of the LDW-CPS-1-PLUS and LDW-PSID-1-PLUS, replicating the tutorial results of Imbens &amp; Xu (2024).</p>
<p>The LDW-CPS-1 sample produces ATT estimates that closely align with the experimental benchmark with an exception for one estimator. Its top-ranked samples produce ATT estimates that are consistently positive and cluster reasonably close around the benchmark, except for the <code>cem_stuermer</code> (G) sample that exhibits somewhat larger deviations from the benchmark and increased standard errors.</p>
<p>In contrast, the LDW-PSID-1 sample and its top-ranked samples frequently exhibit greater dispersion and substantially higher standard errors compared to the LDW-CPS-1 samples, while almost all its ATT estimates are negative.</p>
<p>Further, while ATT estimates for LDW-CPS1-PLUS overly resemble those obtained from respective non-plus samples, the LDW-PSID-PLUS sample produces ATT estimates notably closer to the benchmark compared to all LDW-PSID-1-based samples, demonstrating that the trimmed and matched approach of the extended sample may improve the accuracy of the ATT estimates.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-1" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb114-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-2" tabindex="-1"></a>all_summaries <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_outs, eval_att)</span>
<span id="cb114-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-3" tabindex="-1"></a>att_summary <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, all_summaries)</span>
<span id="cb114-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-4" tabindex="-1"></a><span class="fu">rownames</span>(att_summary) <span class="ot">&lt;-</span> all_plot_titles</span>
<span id="cb114-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-5" tabindex="-1"></a></span>
<span id="cb114-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-6" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb114-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-7" tabindex="-1"></a><span class="fu">datatable</span>(att_summary, <span class="at">caption =</span> <span class="st">&quot;ATT Summary Statistics&quot;</span>,</span>
<span id="cb114-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-8" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2a8e9539872343d5916c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2a8e9539872343d5916c">{"x":{"filter":"none","vertical":false,"caption":"<caption>ATT Summary Statistics<\/caption>","data":[["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: genetic_crump","(E) Top CPS-1: cem_stuermer","(F) Top CPS-1: k2_crump","(G) Top CPS-1: cs_crump","(H) Top CPS-1: nn_crump","(I) Top PSID-1: genetic_walker","(J) Top PSID-1: mahvars_walker","(K) Top PSID-1: k2_walker","(L) Top PSID-1: optimal_pair_stuermer","(M) Top PSID-1: optimal_pair_walker","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[674.874222740201,668.8769004181214,831.1210487112708,884.366920957581,1779.851080308885,862.4975730811275,904.8395947205895,931.6682301468441,1532.0214095632,1479.28557171798,1338.087310233404,1102.822989687836,1330.376118456777,806.6840007710841,1184.485076019196],[1670.708802371074,-8497.516148135088,-15204.77742149167,2036.763274859741,1190.750243764784,1572.669811439371,1206.051198306502,1559.689716958679,-4811.54914198134,-4538.465244411895,-5366.872275933164,-984.9586151123042,-3518.308517659508,878.3361620054663,-2430.146387786865],[1873.748568486395,1729.118299124028,3093.015349648971,2658.711604280722,3540.919533623585,2350.134982693457,2408.324560360267,2532.294998378941,-2542.109544117073,-2593.791443243539,-747.0342224080129,210.6393626005673,-1541.92541741129,2137.900192750088,-1456.009040863639],[203.0397661153213,10226.63444725912,18297.79277114064,621.9483294209806,2350.169289858801,777.4651712540858,1202.273362053765,972.6052814202626,2269.439597864267,1944.673801168356,4619.838053525151,1195.597977712871,1976.383100248217,1259.564030744621,974.137346923226]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean_SE<\/th>\n      <th>Min_Estimate<\/th>\n      <th>Max_Estimate<\/th>\n      <th>Diff_Estimate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Mean_SE","targets":1},{"name":"Min_Estimate","targets":2},{"name":"Max_Estimate","targets":3},{"name":"Diff_Estimate","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The ATT results are presented in the table below.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-1" tabindex="-1"></a><span class="co"># get result matrix</span></span>
<span id="cb115-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-2" tabindex="-1"></a>out.cps_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]])</span>
<span id="cb115-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-3" tabindex="-1"></a>out.psid_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]])</span>
<span id="cb115-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-4" tabindex="-1"></a>all_out_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1), out.cps_top, out.psid_top, <span class="fu">list</span>(out4, out5))</span>
<span id="cb115-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-5" tabindex="-1"></a>result_mat <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs, all_out_mat, all_plot_titles)</span>
<span id="cb115-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-6" tabindex="-1"></a></span>
<span id="cb115-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-7" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb115-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-8" tabindex="-1"></a><span class="fu">datatable</span>(result_mat, <span class="at">caption =</span> <span class="st">&quot;ATT Estimates and SEs&quot;</span>,</span>
<span id="cb115-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-9" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-5bc403e1f7b162d7d6b0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5bc403e1f7b162d7d6b0">{"x":{"filter":"none","vertical":false,"caption":"<caption>ATT Estimates and SEs<\/caption>","data":[["Experimental Benchmark","diff","reg","om.reg","om.grf","matching","psm","ipw","cbps","ebal","dml","aipw_grf","aipw_ow"],["1794.34","1794.34","1670.71","1706.20","1799.75","1757.17","1873.75","1790.66","1709.55","1712.12","1814.98","1718.35","1831.33"],["(670.82)","(670.82)","(680.20)","(587.94)","(581.81)","(764.06)","(693.72)","(679.48)","(699.04)","(699.26)","(670.37)","(690.60)","(681.18)"],["1794.34","-8497.52","1066.38","1133.28","1098.04","1729.12","1191.09","1223.33","1408.01","1406.27","207.06","1546.90","1412.96"],["(670.82)","(581.92)","(626.85)","(624.26)","(629.63)","(815.38)","(739.06)","(684.66)","(654.96)","(654.93)","(611.41)","(713.24)","(690.23)"],["1794.34","-15204.78","4.16","687.82","744.36","2255.47","3093.02","685.05","2437.70","2420.49","-115.40","1387.93","1324.99"],["(670.82)","(655.91)","(854.15)","(635.26)","(634.10)","(1403.83)","(718.06)","(899.39)","(877.80)","(876.85)","(884.52)","(773.40)","(760.19)"],["1115.83","2097.59","2209.49","2188.29","2239.43","2440.30","2036.76","2625.08","2625.08","2202.41","2164.99","2658.71","2485.70"],["(756.66)","(911.51)","(912.08)","(672.25)","(664.14)","(1097.27)","(810.93)","(914.97)","(914.97)","(930.89)","(909.30)","(905.87)","(968.22)"],["-2010.83","3540.92","2488.10","1383.50","3002.79","1216.31","3410.00","2023.00","2023.00","1190.75","3320.93","2568.16","2635.80"],["(977.24)","(1502.86)","(1598.70)","(1932.23)","(1421.79)","(2178.03)","(2053.18)","(1843.71)","(1843.71)","(2084.26)","(1526.07)","(1695.94)","(1677.75)"],["1115.83","1572.67","1985.17","2048.47","1903.86","2304.78","2305.56","2128.95","2128.95","1918.28","1650.61","2212.75","2350.13"],["(756.66)","(867.14)","(876.69)","(679.74)","(666.70)","(1010.85)","(825.94)","(962.74)","(962.74)","(878.07)","(872.36)","(860.27)","(886.73)"],["1115.83","1525.33","2060.01","2408.32","1820.06","2027.88","1206.05","1789.78","1789.78","2217.16","1467.89","2228.81","1735.46"],["(756.66)","(933.10)","(955.38)","(683.70)","(665.73)","(1194.88)","(830.76)","(947.84)","(947.84)","(887.84)","(926.00)","(910.37)","(974.62)"],["1115.83","2112.96","2254.33","2107.32","2317.02","2513.23","1559.69","2313.60","2313.60","2055.01","2101.25","2532.29","2228.93"],["(756.66)","(953.72)","(994.23)","(694.42)","(662.28)","(1153.12)","(862.11)","(976.06)","(976.06)","(985.22)","(950.48)","(959.26)","(1013.07)"],["-6336.72","-3126.92","-2542.11","-2892.35","-2899.56","-3920.62","-4811.55","-2799.44","-2799.44","-2857.81","-3067.89","-2914.40","-3661.01"],["(1078.19)","(1649.91)","(1525.04)","(1355.53)","(1009.05)","(1634.75)","(1287.64)","(1602.53)","(1602.53)","(1790.33)","(1614.34)","(1556.75)","(1755.86)"],["-6336.72","-3746.73","-2955.41","-2593.79","-3403.07","-3424.78","-4538.47","-3746.73","-3746.73","-2602.35","-3168.03","-3378.61","-3578.38"],["(1078.19)","(1606.17)","(1445.85)","(1446.15)","(1076.62)","(1691.29)","(1526.17)","(1606.17)","(1606.17)","(1505.39)","(1330.24)","(1469.28)","(1441.91)"],["-6336.72","-1907.04","-1634.10","-1130.13","-1035.33","-1609.47","-5366.87","-2151.58","-2151.58","-1396.13","-2326.76","-747.03","-934.16"],["(1078.19)","(1358.75)","(1246.79)","(1331.94)","(1068.42)","(1511.55)","(1596.83)","(1409.66)","(1409.66)","(1367.85)","(1314.47)","(1192.58)","(1248.54)"],["-5162.17","-984.96","-679.38","-450.36","-298.73","-242.07","-584.01","-984.96","-984.96","-167.40","-895.93","-49.55","210.64"],["(961.14)","(1167.43)","(1092.13)","(936.57)","(838.78)","(1196.73)","(1127.31)","(1167.43)","(1167.43)","(1113.36)","(1145.32)","(1141.97)","(1139.42)"],["-6336.72","-3063.53","-2458.62","-1632.41","-2556.38","-1541.93","-3518.31","-3063.53","-3063.53","-1837.12","-3130.95","-2275.64","-2381.84"],["(1078.19)","(1391.53)","(1183.22)","(1296.09)","(1022.68)","(1490.18)","(1197.59)","(1391.53)","(1391.53)","(1474.37)","(1349.25)","(1378.77)","(1397.79)"],["1911.04","1483.82","1751.16","1507.48","1507.21","2137.90","878.34","1382.32","1471.35","1472.12","1510.78","1408.05","1649.66"],["(737.71)","(824.44)","(824.20)","(672.08)","(664.96)","(946.11)","(835.48)","(823.10)","(813.29)","(812.92)","(814.91)","(815.26)","(833.45)"],["306.29","-1505.24","-1939.59","-1511.20","-1456.01","-1564.93","-2430.15","-1985.31","-1885.28","-1776.73","-1559.00","-1928.77","-1817.01"],["(985.98)","(1219.89)","(1154.45)","(900.46)","(797.20)","(1209.89)","(1272.65)","(1250.72)","(1369.64)","(1551.89)","(1126.52)","(1175.70)","(1184.81)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(A) LDW-Experimental<\/th>\n      <th>V2<\/th>\n      <th>(B) LDW-CPS-1<\/th>\n      <th>V4<\/th>\n      <th>(C) LDW-PSID-1<\/th>\n      <th>V6<\/th>\n      <th>(D) Top CPS-1: genetic_crump<\/th>\n      <th>V8<\/th>\n      <th>(E) Top CPS-1: cem_stuermer<\/th>\n      <th>V10<\/th>\n      <th>(F) Top CPS-1: k2_crump<\/th>\n      <th>V12<\/th>\n      <th>(G) Top CPS-1: cs_crump<\/th>\n      <th>V14<\/th>\n      <th>(H) Top CPS-1: nn_crump<\/th>\n      <th>V16<\/th>\n      <th>(I) Top PSID-1: genetic_walker<\/th>\n      <th>V18<\/th>\n      <th>(J) Top PSID-1: mahvars_walker<\/th>\n      <th>V20<\/th>\n      <th>(K) Top PSID-1: k2_walker<\/th>\n      <th>V22<\/th>\n      <th>(L) Top PSID-1: optimal_pair_stuermer<\/th>\n      <th>V24<\/th>\n      <th>(M) Top PSID-1: optimal_pair_walker<\/th>\n      <th>V26<\/th>\n      <th>(N) Trimmed LDW-CPS-1-PLUS<\/th>\n      <th>V28<\/th>\n      <th>(O) Trimmed LDW-PSID-1-PLUS<\/th>\n      <th>V30<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"(A) LDW-Experimental","targets":1},{"name":"V2","targets":2},{"name":"(B) LDW-CPS-1","targets":3},{"name":"V4","targets":4},{"name":"(C) LDW-PSID-1","targets":5},{"name":"V6","targets":6},{"name":"(D) Top CPS-1: genetic_crump","targets":7},{"name":"V8","targets":8},{"name":"(E) Top CPS-1: cem_stuermer","targets":9},{"name":"V10","targets":10},{"name":"(F) Top CPS-1: k2_crump","targets":11},{"name":"V12","targets":12},{"name":"(G) Top CPS-1: cs_crump","targets":13},{"name":"V14","targets":14},{"name":"(H) Top CPS-1: nn_crump","targets":15},{"name":"V16","targets":16},{"name":"(I) Top PSID-1: genetic_walker","targets":17},{"name":"V18","targets":18},{"name":"(J) Top PSID-1: mahvars_walker","targets":19},{"name":"V20","targets":20},{"name":"(K) Top PSID-1: k2_walker","targets":21},{"name":"V22","targets":22},{"name":"(L) Top PSID-1: optimal_pair_stuermer","targets":23},{"name":"V24","targets":24},{"name":"(M) Top PSID-1: optimal_pair_walker","targets":25},{"name":"V26","targets":26},{"name":"(N) Trimmed LDW-CPS-1-PLUS","targets":27},{"name":"V28","targets":28},{"name":"(O) Trimmed LDW-PSID-1-PLUS","targets":29},{"name":"V30","targets":30}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="callout-note">
<p>The first value in each cell represents the point estimate from the respective estimator and sample. The number in brackets directly following shows the robust standard error (SE) associated with that estimate, indicating the uncertainty or variability around the point estimate.</p>
</div>
<p>The tabulated results confirm visual patterns: Column (A) reports the estimates for the LDW-Experimental sample, column (B) for the LDW-CPS-1 sample, and column (C) for the LDW-PSID-1 sample. Columns (D)-(O) summarize the top-ranked sample results for both LDW-CPS-1 and LDW-PSID-1. Columns (N) and (O) present estimates for the trimmed and matched versions of the LDW-PSID-1-PLUS and LDW-PSID-1-PLUS samples.</p>
<p>For most LDW-CPS-1-based samples, estimates remain not only positive but also comparatively close to the experimental benchmark, with moderate variance inflation. In contrast, the LDW-PSID-1-based samples produce estimates that exhibit greater variability, more frequently negative values, and larger standard errors, reflecting an increased challenge of achieving adequate estimates in the LDW-PSID-1 sample.</p>
<p>Overall, figures and table jointly demonstrate that ATT estimates from observational samples tend to have larger standard errors compared to the experimental sample, reflecting greater statistical uncertainty in non-experimental effect estimation, and that certain criteria can bring observational estimates closer to the benchmark. Nevertheless, significant estimator-dependent variability and sensitivity to sample construction persist.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb116-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat, <span class="st">&quot;ldw_att_est_model_a&quot;</span>)</span></code></pre></div>
<div class="callout-tip">
<p>Improved overlap generally leads to estimates closer to the experimental benchmark, but often at the cost of increased standard errors. This trade-off highlights the need to carefully balance bias reduction against precision when selecting methods for robust causal inference.</p>
</div>
<p>Next, we explore alternative estimands such as heterogeneous treatment effects and quantile treatment effects, which may provide deeper insights into the validity of the unconfoundedness assumption.</p>
</div>
<div id="conditional-average-treatment-effect-on-the-treated-catt-1" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> Conditional average treatment effect on the treated (CATT)<a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>CATT enables analysis of treatment effect heterogeneity across covariate-defined subpopulations. We estimate the CATT for the same samples previously considered in the ATT estimation by AIPW-GRF via the <code>catt()</code> function established by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-1" tabindex="-1"></a><span class="co"># estimate CATT</span></span>
<span id="cb117-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-2" tabindex="-1"></a>catt.ldw <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw, Y, treat, covar)</span>
<span id="cb117-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-3" tabindex="-1"></a>catt.cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps, Y, treat, covar)</span>
<span id="cb117-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-4" tabindex="-1"></a>catt.psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid, Y, treat, covar)</span>
<span id="cb117-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-5" tabindex="-1"></a>catt.top5_cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.cps, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb117-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-6" tabindex="-1"></a>catt.top5_psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.psid, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb117-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-7" tabindex="-1"></a>catt.top5_cps_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb117-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-8" tabindex="-1"></a>catt.top5_psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-1" tabindex="-1"></a><span class="co"># similar to Imbens &amp; Xu (2024) </span></span>
<span id="cb118-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-2" tabindex="-1"></a>catt.trim_cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_trim_cps, Y, treat, covar) </span>
<span id="cb118-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-3" tabindex="-1"></a>catt.trim_psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_trim_psid, Y, treat, covar) </span>
<span id="cb118-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-4" tabindex="-1"></a>catt.cps_trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps_trim, Y, treat, covar)  </span>
<span id="cb118-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-5" tabindex="-1"></a>catt.psid_trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid_trim, Y, treat, covar) </span></code></pre></div>
<p>Then, we employ the function <code>plot_catt()</code> from <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span> to visualize the results for the initial observational samples and plus-samples, as well as a modified version of this function for the remaining samples. This approach plots the estimated CATTs for all samples at the covariate values of each treated unit against their corresponding benchmarks.</p>
<div class="callout-note">
<p>In the CATT plots, the gray dots represent pairs of CATT estimates, while the red crosses indicate pairs of estimated ATTs.</p>
</div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) </span>
<span id="cb119-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb119-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-3" tabindex="-1"></a></span>
<span id="cb119-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-4" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb119-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-5" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb119-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-6" tabindex="-1"></a>  <span class="at">catt1 =</span> catt.ldw<span class="sc">$</span>catt,</span>
<span id="cb119-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-7" tabindex="-1"></a>  <span class="at">catt2 =</span> catt.cps<span class="sc">$</span>catt,</span>
<span id="cb119-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-8" tabindex="-1"></a>  <span class="at">att1  =</span> catt.ldw<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb119-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-9" tabindex="-1"></a>  <span class="at">att2  =</span> catt.cps<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb119-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-10" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb119-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-11" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (CPS-1)&quot;</span>,</span>
<span id="cb119-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-12" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, </span>
<span id="cb119-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-13" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb119-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-14" tabindex="-1"></a>)</span>
<span id="cb119-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-15" tabindex="-1"></a></span>
<span id="cb119-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-16" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb119-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-17" tabindex="-1"></a>  <span class="at">catt1 =</span> catt.ldw<span class="sc">$</span>catt,</span>
<span id="cb119-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-18" tabindex="-1"></a>  <span class="at">catt2 =</span> catt.psid<span class="sc">$</span>catt,</span>
<span id="cb119-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-19" tabindex="-1"></a>  <span class="at">att1  =</span> catt.ldw<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb119-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-20" tabindex="-1"></a>  <span class="at">att2  =</span> catt.psid<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb119-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-21" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb119-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-22" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (PSID-1)&quot;</span>,</span>
<span id="cb119-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-23" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>,</span>
<span id="cb119-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-24" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb119-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-25" tabindex="-1"></a>)</span>
<span id="cb119-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-26" tabindex="-1"></a></span>
<span id="cb119-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-27" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(</span>
<span id="cb119-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-28" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_cps_trim,</span>
<span id="cb119-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-29" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_cps,</span>
<span id="cb119-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-30" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps)</span>
<span id="cb119-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-31" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-103-1.png" alt="FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.10: FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-103-2.png" alt="FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.11: FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-1" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(</span>
<span id="cb120-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-2" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_psid_trim,</span>
<span id="cb120-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-3" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_psid,</span>
<span id="cb120-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-4" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid)</span>
<span id="cb120-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-103-3.png" alt="FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.12: FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-103-4.png" alt="FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.13: FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-1" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb121-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-2" tabindex="-1"></a>  catt1 <span class="ot">&lt;-</span> catt.trim_cps<span class="sc">$</span>catt,</span>
<span id="cb121-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-3" tabindex="-1"></a>  catt2 <span class="ot">&lt;-</span> catt.cps_trim<span class="sc">$</span>catt,</span>
<span id="cb121-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-4" tabindex="-1"></a>  att1 <span class="ot">&lt;-</span> catt.trim_cps<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb121-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-5" tabindex="-1"></a>  att2 <span class="ot">&lt;-</span> catt.cps_trim<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb121-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-6" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb121-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-7" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (CPS-1-PLUS-Trimmed)&quot;</span>,</span>
<span id="cb121-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-8" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>, </span>
<span id="cb121-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-9" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb121-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-10" tabindex="-1"></a>)</span>
<span id="cb121-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-11" tabindex="-1"></a></span>
<span id="cb121-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-12" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb121-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-13" tabindex="-1"></a>  catt1 <span class="ot">&lt;-</span> catt.trim_psid<span class="sc">$</span>catt,</span>
<span id="cb121-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-14" tabindex="-1"></a>  catt2 <span class="ot">&lt;-</span> catt.psid_trim<span class="sc">$</span>catt,</span>
<span id="cb121-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-15" tabindex="-1"></a>  att1 <span class="ot">&lt;-</span> catt.trim_psid<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb121-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-16" tabindex="-1"></a>  att2 <span class="ot">&lt;-</span> catt.psid_trim<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb121-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-17" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb121-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-18" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (PSID-1-PLUS-Trimmed)&quot;</span>,</span>
<span id="cb121-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-19" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>,</span>
<span id="cb121-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-20" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb121-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-21" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-103-5.png" alt="FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.14: FIGUREA3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-1" tabindex="-1"></a><span class="co"># combine all catt objects </span></span>
<span id="cb122-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-2" tabindex="-1"></a>all_catt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(catt.ldw, catt.cps, catt.psid), </span>
<span id="cb122-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-3" tabindex="-1"></a>              catt.top5_cps, catt.top5_psid, </span>
<span id="cb122-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-4" tabindex="-1"></a>              <span class="fu">list</span>(catt.cps_trim, catt.psid_trim))</span>
<span id="cb122-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-5" tabindex="-1"></a></span>
<span id="cb122-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-6" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb122-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-7" tabindex="-1"></a>all_catt_eval <span class="ot">&lt;-</span> <span class="fu">eval_catt</span>(all_catt, all_plot_titles)</span>
<span id="cb122-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-8" tabindex="-1"></a></span>
<span id="cb122-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-9" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb122-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-10" tabindex="-1"></a><span class="fu">datatable</span>(all_catt_eval, <span class="at">caption =</span> <span class="st">&quot;CATT Summary Statistics&quot;</span>,</span>
<span id="cb122-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-11" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-f4997105858173027594" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f4997105858173027594">{"x":{"filter":"none","vertical":false,"caption":"<caption>CATT Summary Statistics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: genetic_crump","(E) Top CPS-1: cem_stuermer","(F) Top CPS-1: k2_crump","(G) Top CPS-1: cs_crump","(H) Top CPS-1: nn_crump","(I) Top PSID-1: genetic_walker","(J) Top PSID-1: mahvars_walker","(K) Top PSID-1: k2_walker","(L) Top PSID-1: optimal_pair_stuermer","(M) Top PSID-1: optimal_pair_walker","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[-106.7321643140053,-5334.044075748703,-8552.257371395845,36.99544997048382,1966.858321635873,213.2307825213647,-381.0939789521464,1256.674953057136,-3790.542400335253,-5379.3816887227,-2700.410028512049,-2083.055905110039,-3839.838778877983,-2217.949804719869,-7111.525022419901],[4009.537992262409,6947.077936308383,4635.637115822673,5313.684370893083,3362.493830619712,4243.61939152072,4355.206461099385,3380.157402573853,-2608.808444756143,-2029.953993221407,-13.77658383527797,1416.735910149057,-1583.281326514687,5586.226229671729,1591.256956761309],[1748.618274620151,2063.032106869762,766.4958109274427,2431.74234694154,2730.363164348413,2093.15386951697,2073.890511444237,2289.887060102853,-2879.50252638747,-3250.437889157534,-844.9767327154374,-23.60685945416944,-2219.144599021287,1372.197508044146,-1826.114037066464],[4116.270156576415,12281.12201205709,13187.89448721852,5276.688920922599,1395.635508983839,4030.388608999355,4736.300440051531,2123.482449516717,1181.73395557911,3349.427695501294,2686.633444676771,3499.791815259095,2256.557452363296,7804.176034391598,8702.781979181209]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Min_Catt<\/th>\n      <th>Max_Catt<\/th>\n      <th>Mean_Catt<\/th>\n      <th>Diff_Catt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Min_Catt","targets":2},{"name":"Max_Catt","targets":3},{"name":"Mean_Catt","targets":4},{"name":"Diff_Catt","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Specifically, with the LDW-CPS-1 sample, CATT estimates span from $-5,334.04 to $6,947.08, contrasting with the CATT estimated from experimental data (LDW-Experimental) which ranges from $-106.73 to $4009.54, with a mean CATT estimate of $1,748.62. The LDW-PSID-1 sample shows an even broader CATT estimate range, spanning from $-8,552.26 to $4,635.64, and a notably lower mean of approximately $766.50.</p>
<p>Among the top-ranked LDW-CPS-1 samples, CATT ranges vary substantially, yet their mean estimates are generally closer to the experimental benchmark compared to the LDW-CPS-1 sample. The sample <code>cs_crump</code> (E) produces the minimum CATT estimate among corresponding top-ranked samples, but still produces a positive mean CATT estimate.</p>
<p>The CATT estimates for the LDW-PSID-1 top-ranked samples reveal substantially decreased mean CATT estimates compared to the LDW-CPS-1 top-ranked samples, reflecting greater difficulties in producing reliable treatment effect estimates.</p>
<p>The mean CATT estimate for the trimmed and matched version of the LDW-CPS-1-PLUS sample aligns more closely with the benchmark, whereas for the trimmed and matched version
of the LDW-PSID-1-PLUS sample the mean CATT estimates remains notably lower.</p>
<p>This variation in range and means across methods and samples reflects substantial heterogeneity in treatment effect estimation, indicating that while some criteria improve alignment with the experimental benchmark, others introduce considerable discrepancies and variability in estimated heterogeneous effects.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb123-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-2" tabindex="-1"></a><span class="fu">save_main_catt_panels</span>(</span>
<span id="cb123-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-3" tabindex="-1"></a>  <span class="at">catt_refs =</span> <span class="fu">list</span>(catt.ldw),</span>
<span id="cb123-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-4" tabindex="-1"></a>  <span class="at">catt_comps =</span> <span class="fu">list</span>(catt.cps, catt.psid),</span>
<span id="cb123-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-5" tabindex="-1"></a>  <span class="at">ylabels =</span> <span class="fu">c</span>(<span class="st">&quot;CATT (CPS-1)&quot;</span>, <span class="st">&quot;CATT (PSID-1)&quot;</span>),</span>
<span id="cb123-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-6" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_catt_main_panels&quot;</span>,</span>
<span id="cb123-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-7" tabindex="-1"></a>  <span class="at">main_titles =</span> <span class="fu">c</span>(<span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb123-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-8" tabindex="-1"></a>)</span>
<span id="cb123-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-9" tabindex="-1"></a></span>
<span id="cb123-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-10" tabindex="-1"></a><span class="fu">save_catt_panels</span>(</span>
<span id="cb123-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-11" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_cps_trim,</span>
<span id="cb123-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-12" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_cps,</span>
<span id="cb123-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-13" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps),</span>
<span id="cb123-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-14" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_catt_top5_cps&quot;</span></span>
<span id="cb123-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-15" tabindex="-1"></a>)</span>
<span id="cb123-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-16" tabindex="-1"></a></span>
<span id="cb123-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-17" tabindex="-1"></a><span class="fu">save_catt_panels</span>(</span>
<span id="cb123-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-18" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_psid_trim,</span>
<span id="cb123-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-19" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_psid,</span>
<span id="cb123-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-20" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid),</span>
<span id="cb123-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-21" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_catt_top5_psid&quot;</span></span>
<span id="cb123-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-22" tabindex="-1"></a>)</span>
<span id="cb123-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-23" tabindex="-1"></a></span>
<span id="cb123-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-24" tabindex="-1"></a><span class="fu">save_plus_catt_panels</span>(</span>
<span id="cb123-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-25" tabindex="-1"></a>  <span class="at">catt1_list =</span> <span class="fu">list</span>(catt.trim_cps, catt.trim_psid),</span>
<span id="cb123-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-26" tabindex="-1"></a>  <span class="at">catt2_list =</span> <span class="fu">list</span>(catt.cps_trim, catt.psid_trim),</span>
<span id="cb123-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-27" tabindex="-1"></a>  <span class="at">ylabels =</span> <span class="fu">c</span>(<span class="st">&quot;CATT (Trimmed CPS-1-PLUS)&quot;</span>, <span class="st">&quot;CATT (Trimmed PSID-1-PLUS)&quot;</span>),</span>
<span id="cb123-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-28" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_catt_plus_panels&quot;</span>,</span>
<span id="cb123-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-29" tabindex="-1"></a>  <span class="at">main_titles =</span> <span class="fu">c</span>(<span class="st">&quot;(N) LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(O) LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb123-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-30" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="quantile-treatment-effect-on-the-treated-qtet" class="section level3 hasAnchor" number="2.7.3">
<h3><span class="header-section-number">2.7.3</span> Quantile treatment effect on the treated (QTET)<a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>QTET provides a robust way to analyze treatment effect heterogeneity while being less impacted by outliers compared to average treatment effect measures. The QTET estimates are obtained using the propensity score re-weighting method introduced by <span class="citation">Firpo (<a href="#ref-Firpo_2007">2007</a>)</span>, implemented through the <code>est_qte()</code> function established by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>. Visualization is conducted using their <code>plot_qte()</code> function and a modified version thereof.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-1" tabindex="-1"></a><span class="co"># estimate QTET</span></span>
<span id="cb124-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-2" tabindex="-1"></a>qte.ldw <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb124-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-3" tabindex="-1"></a>qte.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps)</span>
<span id="cb124-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-4" tabindex="-1"></a>qte.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid)</span>
<span id="cb124-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-5" tabindex="-1"></a>qte.top5_cps  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb124-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-6" tabindex="-1"></a>qte.top5_psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.psid, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb124-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-7" tabindex="-1"></a>qte.top5_cps_trim  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte_safe</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb124-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-8" tabindex="-1"></a>qte.top5_psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">est_qte_safe</span>(Y, treat, covar, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb125-1" tabindex="-1"></a>qte.trim.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_trim_cps) </span>
<span id="cb125-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb125-2" tabindex="-1"></a>qte.trim.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_trim_psid) </span>
<span id="cb125-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb125-3" tabindex="-1"></a>qte.ldw_cps.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps_trim) </span>
<span id="cb125-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb125-4" tabindex="-1"></a>qte.ldw_psid.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid_trim) </span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-1" tabindex="-1"></a>qte.ldw0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw)</span>
<span id="cb126-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-2" tabindex="-1"></a>qte.ldw_cps0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps)</span>
<span id="cb126-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-3" tabindex="-1"></a>qte.ldw_psid0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid)</span>
<span id="cb126-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-4" tabindex="-1"></a>qte.top5_cps_trim0  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span>
<span id="cb126-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-5" tabindex="-1"></a>qte.top5_psid_trim0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.psid, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb127-1" tabindex="-1"></a>qte.ldw_cps.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps_trim) </span>
<span id="cb127-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb127-2" tabindex="-1"></a>qte.ldw_psid.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid_trim) </span></code></pre></div>
<div class="callout-note">
<p>Each QTET plot displays three distinct series for every sample analyzed: (1) The blue line with diamond-shaped points represents QTET estimates derived from the experimental sample, serving as the benchmark. (2) The red line with triangles shows QTET estimates from the observational data before any adjustment. (3) The black line with circles presents QTET estimates for the observational data after applying covariate adjustment.</p>
</div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb128-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb128-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-3" tabindex="-1"></a>ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>)</span>
<span id="cb128-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-4" tabindex="-1"></a></span>
<span id="cb128-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-5" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb128-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-6" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps, qte.ldw_cps0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, ylim)</span>
<span id="cb128-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb128-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-8" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb128-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-9" tabindex="-1"></a></span>
<span id="cb128-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-10" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid, qte.ldw_psid0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>, ylim)</span>
<span id="cb128-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb128-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-12" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb128-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-13" tabindex="-1"></a></span>
<span id="cb128-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-14" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_cps_trim, qte.top5_cps_trim0, qte.top5_cps, all_plot_titles, <span class="at">main_start =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-110-1.png" alt="FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.15: FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb129-1" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_psid_trim, qte.top5_psid_trim0, qte.top5_psid, all_plot_titles, <span class="at">main_start =</span> <span class="dv">9</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-110-2.png" alt="FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.16: FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-110-3.png" alt="FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.17: FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-1" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps.trim, qte.ldw_cps.trim0, qte.trim.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>, ylim)</span>
<span id="cb130-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb130-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-3" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb130-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-4" tabindex="-1"></a></span>
<span id="cb130-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-5" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid.trim, qte.ldw_psid.trim0, qte.trim.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>, ylim)</span>
<span id="cb130-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb130-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-7" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-110-4.png" alt="FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.18: FIGUREA4. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<p>These figures display QTET estimates derived from both the experimental and various observational samples.</p>
<p>The QTETs estimated from the LDW-CPS-1 sample (B) and their top-ranked samples (D, E and H), except for <code>k2_crump</code> (F) and <code>cem_stuermer</code> (G), corresponds well with the true QTET, although the estimates are often underpowered. The QTET estimates from the trimmed and matched version of LDW-CPS-1-PLUS (N) also correspond well with the true QTET.</p>
<p>The QTET estimates from the LDW-PSID-1 (C) and their top-ranked samples (I-M) show clear biases and noticeably wider confidence bands when compared to the experimental benchmark, which clusters near zero, indicating greater estimation uncertainty. Only the top-ranked samples <code>mahvars_walker</code> (L) and <code>k2_walker</code> (K) produce QTET estimates that are slightly closer to the true QTET. The QTET estimates from the trimmed and matched version of LDW-PSID-1-PLUS (N) also exhibit clear biases.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-1" tabindex="-1"></a><span class="co"># list results</span></span>
<span id="cb131-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-2" tabindex="-1"></a>plots_ldw <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps, <span class="at">mod0 =</span> qte.ldw_cps0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>),</span>
<span id="cb131-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid, <span class="at">mod0 =</span> qte.ldw_psid0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>),</span>
<span id="cb131-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps.trim, <span class="at">mod0 =</span> qte.ldw_cps.trim0, <span class="at">bm =</span> qte.trim.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>),</span>
<span id="cb131-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-6" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid.trim, <span class="at">mod0 =</span> qte.ldw_psid.trim0, <span class="at">bm =</span> qte.trim.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb131-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-7" tabindex="-1"></a>)</span>
<span id="cb131-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-8" tabindex="-1"></a></span>
<span id="cb131-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-9" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb131-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-10" tabindex="-1"></a><span class="fu">save_qtet</span>(plots_ldw, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a&quot;</span>)</span>
<span id="cb131-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-11" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_cps_trim, qte.top5_cps_trim0, qte.top5_cps, all_plot_titles, <span class="at">main_start =</span> <span class="dv">4</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_top&quot;</span>)</span>
<span id="cb131-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-12" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_psid_trim, qte.top5_psid_trim0, qte.top5_psid, all_plot_titles, <span class="at">main_start =</span> <span class="dv">9</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_top&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-outcome-weights-ow" class="section level3 hasAnchor" number="2.7.4">
<h3><span class="header-section-number">2.7.4</span> Assessing outcome weights (OW)<a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="callout-caution">
<p>The outcome weights are not obtained directly from the ATT point estimates due to computational design of other methods. Instead, the ATT is separately estimated for each sample following the approach developed by <span class="citation">Knaus and Pfleiderer (<a href="#ref-OW_Package">2024</a>)</span>. Subsequently, the outcome weights are derived and analysed.</p>
</div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb132-1" tabindex="-1"></a><span class="co"># list all samples</span></span>
<span id="cb132-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb132-2" tabindex="-1"></a>all_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(ldw, ldw_cps, ldw_psid), top5_samples.cps, top5_samples.psid, <span class="fu">list</span>(ldw_trim_cps, ldw_trim_psid))</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb133-1" tabindex="-1"></a><span class="co"># estimate ATT </span></span>
<span id="cb133-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb133-2" tabindex="-1"></a>res_att <span class="ot">&lt;-</span> <span class="fu">get_res_att</span>(all_samples, Y, treat, covar)</span></code></pre></div>
<pre><code>## OUTCOME WEIGHTS SUMMARY: 15 succeeded, 0 failed out of 15 samples</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb135-1" tabindex="-1"></a><span class="co"># extract outcome weights</span></span>
<span id="cb135-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb135-2" tabindex="-1"></a>ow_att <span class="ot">&lt;-</span> <span class="fu">derive_ow</span>(res_att)</span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb136-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb136-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-3" tabindex="-1"></a></span>
<span id="cb136-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-4" tabindex="-1"></a><span class="co"># plot outcome weights distribution</span></span>
<span id="cb136-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-5" tabindex="-1"></a><span class="fu">plot_ow</span>(ow_att, all_plot_titles) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-114-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-114-1.png" alt="FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.19: FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-114-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-114-2.png" alt="FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.20: FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-114-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-114-3.png" alt="FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.21: FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-114-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-114-4.png" alt="FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.22: FIGUREA5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model A using LDW Data
</p>
</div>
<p>The results of the behavior of outcome weights are presented in the table below.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-1" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb137-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-2" tabindex="-1"></a>res_ow <span class="ot">&lt;-</span> <span class="fu">eval_ow</span>(ow_att, all_samples, all_plot_titles, treat, <span class="st">&quot;AIPW-ATT&quot;</span>)</span>
<span id="cb137-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-3" tabindex="-1"></a></span>
<span id="cb137-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-4" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb137-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-5" tabindex="-1"></a><span class="fu">datatable</span>(res_ow, <span class="at">caption =</span> <span class="st">&quot;Outcome Weights for Treated and Untreated&quot;</span>,</span>
<span id="cb137-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-6" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-01f665b989270420b066" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-01f665b989270420b066">{"x":{"filter":"none","vertical":false,"caption":"<caption>Outcome Weights for Treated and Untreated<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: genetic_crump","(E) Top CPS-1: cem_stuermer","(F) Top CPS-1: k2_crump","(G) Top CPS-1: cs_crump","(H) Top CPS-1: nn_crump","(I) Top PSID-1: genetic_walker","(J) Top PSID-1: mahvars_walker","(K) Top PSID-1: k2_walker","(L) Top PSID-1: optimal_pair_stuermer","(M) Top PSID-1: optimal_pair_walker","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[1,1,0.9999999999999999,1,0.9999999999999998,1,1,1,1,1,0.9999999999999999,1,1,1,1],[-1,-0.9999999999999998,-1,-1,-0.9999999999999999,-0.9999999999999999,-1,-1,-1,-1,-1,-0.9999999999999999,-1,-1,-1],[0,2.220446049250313e-16,-1.110223024625157e-16,0,-1.110223024625157e-16,1.110223024625157e-16,0,0,0,0,-1.110223024625157e-16,1.110223024625157e-16,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Sum_Treated<\/th>\n      <th>Sum_Untreated<\/th>\n      <th>Total_Sum<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Sum_Treated","targets":2},{"name":"Sum_Untreated","targets":3},{"name":"Total_Sum","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The evaluation reveals that across each sample the estimated outcome weights sum to one within the treated group and minus one within the untreated group, resulting in an overall sum of zero. Note, that minor deviations from exact values are attributable to floating-point rounding error in numerical summation.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-1" tabindex="-1"></a><span class="co">#save results</span></span>
<span id="cb138-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-2" tabindex="-1"></a><span class="fu">save_ow</span>(ow_att, all_plot_titles, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a&quot;</span>)</span>
<span id="cb138-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-3" tabindex="-1"></a><span class="fu">save_csv</span>(res_ow, <span class="st">&quot;ldw_model_a_ow&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="validation-through-placebo-analyses" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Validation through placebo analyses<a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To further evaluate the credibility of the unconfoundedness assumption, a placebo analysis is performed by designating 1975 earnings (<code>re75</code>) as the (placebo) outcome variable and omitting both <code>re75</code> and <code>u75</code> from the set of covariates. The analysis uses all previously considered samples and recomputes the ATT via the function <code>estimate_all</code>, initially established by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span> and adapted for specific purposes within this study, conditioning only on the remaining set of covariates.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb139-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re75&quot;</span></span>
<span id="cb139-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb139-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;u74&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb140-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on original and observational samples</span></span>
<span id="cb140-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb140-2" tabindex="-1"></a>out1_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb140-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb140-3" tabindex="-1"></a>out2_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb140-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb140-4" tabindex="-1"></a>out3_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, Y, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb141-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on top ranked samples</span></span>
<span id="cb141-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb141-2" tabindex="-1"></a>out.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb141-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb141-3" tabindex="-1"></a>out.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_samples.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb141-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb141-4" tabindex="-1"></a>out.cps_trim_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb141-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb141-5" tabindex="-1"></a>out.psid_trim_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on plus samples</span></span>
<span id="cb142-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/trimmed.RData&quot;</span>)</span>
<span id="cb142-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-3" tabindex="-1"></a>out4_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_cps_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb142-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-4" tabindex="-1"></a>out5_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_psid_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb142-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-5" tabindex="-1"></a>out6_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps_trim_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb142-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb142-6" tabindex="-1"></a>out7_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid_trim_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb143-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-2" tabindex="-1"></a></span>
<span id="cb143-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-3" tabindex="-1"></a><span class="co"># get experimental benchmark</span></span>
<span id="cb143-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-4" tabindex="-1"></a>band.exp_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb143-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-5" tabindex="-1"></a>est.exp_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb143-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-6" tabindex="-1"></a></span>
<span id="cb143-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-7" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb143-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out1_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl, </span>
<span id="cb143-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(A) LDW-Experimental&quot;</span>)</span>
<span id="cb143-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-10" tabindex="-1"></a></span>
<span id="cb143-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out2_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl, </span>
<span id="cb143-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>)</span>
<span id="cb143-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-13" tabindex="-1"></a></span>
<span id="cb143-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-14" tabindex="-1"></a><span class="fu">plot_coef</span>(out3_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl,</span>
<span id="cb143-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-15" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb143-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-16" tabindex="-1"></a></span>
<span id="cb143-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-17" tabindex="-1"></a><span class="co"># get benchmarks</span></span>
<span id="cb143-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-18" tabindex="-1"></a>method_names_cps <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.cps, <span class="cf">function</span>(m) {</span>
<span id="cb143-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-19" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim_pl)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim_pl), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb143-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb143-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-21" tabindex="-1"></a>})</span>
<span id="cb143-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-22" tabindex="-1"></a>method_names_psid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.psid, <span class="cf">function</span>(m) {</span>
<span id="cb143-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-23" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.psid_trim_pl)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.psid_trim_pl), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb143-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-24" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb143-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-25" tabindex="-1"></a>})</span>
<span id="cb143-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-26" tabindex="-1"></a></span>
<span id="cb143-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-27" tabindex="-1"></a>band.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) {<span class="fu">as.numeric</span>(out.cps_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])})</span>
<span id="cb143-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-28" tabindex="-1"></a>est.cps_pl  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb143-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-29" tabindex="-1"></a>band.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) {<span class="fu">as.numeric</span>(out.psid_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])})</span>
<span id="cb143-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-30" tabindex="-1"></a>est.psid_pl  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb143-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-31" tabindex="-1"></a></span>
<span id="cb143-32"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-32" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb143-33"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-33" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.cps_pl)) {</span>
<span id="cb143-34"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-34" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps[i])</span>
<span id="cb143-35"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-35" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.cps_pl[[i]], <span class="at">band =</span> band.cps_pl[[i]], <span class="at">line =</span> est.cps_pl[[i]],</span>
<span id="cb143-36"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-36" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb143-37"><a href="lalonde-dehejia-wahba-ldw-data.html#cb143-37" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-1.png" alt="FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.23: FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-2.png" alt="FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.24: FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb144-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.psid_pl)) {</span>
<span id="cb144-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb144-2" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid[i])</span>
<span id="cb144-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb144-3" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.psid_pl[[i]], <span class="at">band =</span> band.psid_pl[[i]], <span class="at">line =</span> est.psid_pl[[i]],</span>
<span id="cb144-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb144-4" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb144-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb144-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-3.png" alt="FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.25: FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-1" tabindex="-1"></a><span class="co"># get benchmarks</span></span>
<span id="cb145-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-2" tabindex="-1"></a>band.cps_plus_pl <span class="ot">&lt;-</span> out4_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb145-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-3" tabindex="-1"></a>est.cps_plus_pl <span class="ot">&lt;-</span> out4_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb145-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-4" tabindex="-1"></a>band.psid_plus_pl <span class="ot">&lt;-</span> out5_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb145-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-5" tabindex="-1"></a>est.psid_plus_pl <span class="ot">&lt;-</span> out5_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb145-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-6" tabindex="-1"></a></span>
<span id="cb145-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-7" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb145-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out6_pl, <span class="at">band =</span> band.cps_plus_pl, <span class="at">line =</span> est.cps_plus_pl, </span>
<span id="cb145-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12000</span>, <span class="dv">2000</span>), <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>)</span>
<span id="cb145-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-10" tabindex="-1"></a></span>
<span id="cb145-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out7_pl, <span class="at">band =</span> band.psid_plus_pl, <span class="at">line =</span> est.psid_plus_pl, </span>
<span id="cb145-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb145-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12000</span>, <span class="dv">2000</span>), <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-4.png" alt="FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.26: FIGUREA6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model A: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb146-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-2" tabindex="-1"></a>all_outs_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl), out.cps_pl, out.psid_pl, <span class="fu">list</span>(out6_pl, out7_pl))</span>
<span id="cb146-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-3" tabindex="-1"></a>all_bands_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(band.exp_pl, band.exp_pl, band.exp_pl), band.cps_pl, band.psid_pl, <span class="fu">list</span>(band.cps_plus_pl, band.psid_plus_pl))</span>
<span id="cb146-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-4" tabindex="-1"></a>all_ests_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(est.exp_pl, est.exp_pl, est.exp_pl), est.cps_pl, est.psid_pl, <span class="fu">list</span>(est.cps_plus_pl, est.psid_plus_pl))</span>
<span id="cb146-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-5" tabindex="-1"></a></span>
<span id="cb146-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-6" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb146-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-7" tabindex="-1"></a><span class="fu">save_att_panels</span>(</span>
<span id="cb146-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-8" tabindex="-1"></a>    <span class="at">out_list    =</span> all_outs_pl,</span>
<span id="cb146-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-9" tabindex="-1"></a>    <span class="at">plot_titles =</span> all_plot_titles,</span>
<span id="cb146-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-10" tabindex="-1"></a>    <span class="at">band_list   =</span> all_bands_pl,</span>
<span id="cb146-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-11" tabindex="-1"></a>    <span class="at">est_list    =</span> all_ests_pl,</span>
<span id="cb146-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-12" tabindex="-1"></a>    <span class="at">prefix      =</span> <span class="st">&quot;ldw_model_a_pl_est_comb&quot;</span></span>
<span id="cb146-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-13" tabindex="-1"></a>)</span></code></pre></div>
<p>The placebo ATT results are presented in the table below.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-1" tabindex="-1"></a><span class="co"># get all placebo results</span></span>
<span id="cb147-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-2" tabindex="-1"></a>all_outs_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl), out.cps_pl, out.psid_pl, <span class="fu">list</span>(out6_pl, out7_pl))</span>
<span id="cb147-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-3" tabindex="-1"></a>out.cps_top_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim_pl[[j]])</span>
<span id="cb147-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-4" tabindex="-1"></a>out.psid_top_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim_pl[[j]])</span>
<span id="cb147-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-5" tabindex="-1"></a>all_out_mat_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl), out.cps_top_pl, out.psid_top_pl, <span class="fu">list</span>(out4_pl, out5_pl))</span>
<span id="cb147-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-6" tabindex="-1"></a></span>
<span id="cb147-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-7" tabindex="-1"></a><span class="co"># create result matrix</span></span>
<span id="cb147-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-8" tabindex="-1"></a>result_mat_pl <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs_pl, all_out_mat_pl, all_plot_titles)</span>
<span id="cb147-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-9" tabindex="-1"></a></span>
<span id="cb147-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-10" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb147-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-11" tabindex="-1"></a><span class="fu">datatable</span>(result_mat_pl, <span class="at">caption =</span> <span class="st">&quot;Placebo ATT Estimates and SEs&quot;</span>,</span>
<span id="cb147-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb147-12" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e36ce9489c4bd308ea22" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e36ce9489c4bd308ea22">{"x":{"filter":"none","vertical":false,"caption":"<caption>Placebo ATT Estimates and SEs<\/caption>","data":[["Experimental Benchmark","diff","reg","om.reg","om.grf","matching","psm","ipw","cbps","ebal","dml","aipw_grf","aipw_ow"],["265.15","265.15","224.34","165.70","115.67","148.67","277.10","180.76","188.34","189.20","267.63","82.43","108.01"],["(305.00)","(305.00)","(218.33)","(284.98)","(283.09)","(227.58)","(299.90)","(309.68)","(304.79)","(304.71)","(252.22)","(231.26)","(233.22)"],["265.15","-12118.75","-1134.82","-1096.70","-1590.61","-1465.93","-1423.50","-1552.48","-1227.83","-1228.49","-2250.46","-1285.84","-1318.36"],["(305.00)","(247.18)","(272.44)","(395.18)","(373.01)","(351.78)","(416.96)","(335.84)","(297.89)","(297.88)","(242.07)","(267.60)","(276.40)"],["265.15","-17531.28","-2757.40","-2640.76","-4290.47","-1913.65","-2688.25","-3224.79","-2282.31","-2250.80","-3510.17","-2408.26","-2904.04"],["(305.00)","(360.60)","(589.02)","(367.46)","(343.87)","(805.37)","(503.26)","(738.21)","(834.92)","(842.15)","(553.39)","(616.07)","(648.78)"],["-891.68","-445.02","-190.25","-152.56","-194.39","-207.23","-678.19","-29.25","-29.25","-151.02","-286.02","-158.27","-199.68"],["(203.57)","(267.17)","(197.97)","(165.20)","(156.34)","(205.54)","(209.95)","(232.05)","(232.05)","(235.34)","(227.36)","(199.69)","(223.48)"],["-2306.65","898.54","-411.38","-346.95","600.76","-140.68","1046.68","-153.02","-153.02","-468.67","431.73","396.49","644.50"],["(657.81)","(799.10)","(389.31)","(1044.20)","(802.77)","(368.44)","(752.97)","(1091.15)","(1091.15)","(1454.91)","(844.17)","(823.79)","(748.05)"],["-891.68","-527.59","-262.15","-326.60","-313.01","-143.07","-321.10","5.44","5.44","-317.76","-458.77","-209.65","-260.51"],["(203.57)","(286.13)","(275.00)","(152.45)","(146.06)","(197.43)","(253.68)","(238.85)","(238.85)","(331.74)","(282.61)","(237.06)","(269.45)"],["-891.68","-374.50","-68.24","-64.64","-191.36","-234.42","-352.51","14.73","14.73","-57.44","-265.32","-44.12","-32.76"],["(203.57)","(253.68)","(216.21)","(151.69)","(140.05)","(232.03)","(195.80)","(251.60)","(251.60)","(222.22)","(233.76)","(216.07)","(256.36)"],["-891.68","-279.48","16.04","-33.40","5.45","57.31","-85.24","22.35","22.35","-10.74","-146.75","77.58","117.28"],["(203.57)","(262.33)","(203.27)","(157.88)","(149.18)","(207.58)","(186.76)","(305.75)","(305.75)","(232.49)","(235.06)","(195.15)","(206.65)"],["-3734.08","-704.97","99.64","242.59","-478.97","-123.41","-1515.81","-284.74","-284.74","208.94","-906.81","-490.30","-674.98"],["(803.52)","(1208.00)","(962.31)","(1015.11)","(817.84)","(950.09)","(1241.00)","(1095.25)","(1095.25)","(1036.29)","(1133.19)","(866.81)","(1162.69)"],["-3734.08","-1001.79","-349.26","-269.75","-1042.58","-488.43","539.00","-1001.79","-1001.79","-388.42","-735.83","-1181.99","-1019.83"],["(803.52)","(1107.56)","(890.25)","(1009.03)","(835.92)","(887.94)","(931.21)","(1107.56)","(1107.56)","(961.58)","(922.90)","(806.46)","(907.26)"],["-3734.08","-840.48","-646.95","-704.70","-708.83","-758.12","-974.36","-317.39","-317.39","-734.73","-829.79","-653.26","-532.85"],["(803.52)","(965.51)","(895.88)","(893.62)","(775.13)","(826.35)","(915.10)","(872.37)","(872.37)","(967.96)","(953.97)","(854.13)","(986.52)"],["-3189.39","-603.15","-933.17","-519.99","-561.38","-443.50","-1277.67","-603.15","-603.15","-465.62","-587.45","-612.14","-484.50"],["(667.03)","(714.29)","(569.35)","(673.03)","(620.28)","(767.98)","(654.62)","(714.29)","(714.29)","(768.31)","(690.66)","(623.37)","(685.54)"],["-3734.08","-366.14","-244.42","170.29","-157.56","89.31","-668.28","-366.14","-366.14","9.95","-273.87","-133.57","-77.86"],["(803.52)","(937.20)","(776.82)","(882.62)","(768.11)","(930.28)","(988.40)","(937.20)","(937.20)","(1012.29)","(899.32)","(841.58)","(937.10)"],["273.86","-1456.55","-1256.96","-1232.17","-1322.64","-1411.42","-1471.17","-1707.45","-1231.13","-1231.01","-1401.40","-1403.47","-1404.97"],["(334.27)","(484.60)","(329.96)","(402.36)","(363.31)","(357.45)","(445.71)","(500.96)","(468.41)","(468.56)","(372.90)","(363.24)","(404.34)"],["-210.15","-4670.77","-3694.56","-3528.62","-3909.10","-3790.08","-5585.69","-4143.55","-3676.24","-3551.89","-4431.04","-3627.63","-4053.03"],["(693.12)","(1057.12)","(852.84)","(827.83)","(667.37)","(929.82)","(1067.77)","(1014.73)","(1059.83)","(1062.82)","(893.88)","(812.35)","(890.84)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(A) LDW-Experimental<\/th>\n      <th>V2<\/th>\n      <th>(B) LDW-CPS-1<\/th>\n      <th>V4<\/th>\n      <th>(C) LDW-PSID-1<\/th>\n      <th>V6<\/th>\n      <th>(D) Top CPS-1: genetic_crump<\/th>\n      <th>V8<\/th>\n      <th>(E) Top CPS-1: cem_stuermer<\/th>\n      <th>V10<\/th>\n      <th>(F) Top CPS-1: k2_crump<\/th>\n      <th>V12<\/th>\n      <th>(G) Top CPS-1: cs_crump<\/th>\n      <th>V14<\/th>\n      <th>(H) Top CPS-1: nn_crump<\/th>\n      <th>V16<\/th>\n      <th>(I) Top PSID-1: genetic_walker<\/th>\n      <th>V18<\/th>\n      <th>(J) Top PSID-1: mahvars_walker<\/th>\n      <th>V20<\/th>\n      <th>(K) Top PSID-1: k2_walker<\/th>\n      <th>V22<\/th>\n      <th>(L) Top PSID-1: optimal_pair_stuermer<\/th>\n      <th>V24<\/th>\n      <th>(M) Top PSID-1: optimal_pair_walker<\/th>\n      <th>V26<\/th>\n      <th>(N) Trimmed LDW-CPS-1-PLUS<\/th>\n      <th>V28<\/th>\n      <th>(O) Trimmed LDW-PSID-1-PLUS<\/th>\n      <th>V30<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"(A) LDW-Experimental","targets":1},{"name":"V2","targets":2},{"name":"(B) LDW-CPS-1","targets":3},{"name":"V4","targets":4},{"name":"(C) LDW-PSID-1","targets":5},{"name":"V6","targets":6},{"name":"(D) Top CPS-1: genetic_crump","targets":7},{"name":"V8","targets":8},{"name":"(E) Top CPS-1: cem_stuermer","targets":9},{"name":"V10","targets":10},{"name":"(F) Top CPS-1: k2_crump","targets":11},{"name":"V12","targets":12},{"name":"(G) Top CPS-1: cs_crump","targets":13},{"name":"V14","targets":14},{"name":"(H) Top CPS-1: nn_crump","targets":15},{"name":"V16","targets":16},{"name":"(I) Top PSID-1: genetic_walker","targets":17},{"name":"V18","targets":18},{"name":"(J) Top PSID-1: mahvars_walker","targets":19},{"name":"V20","targets":20},{"name":"(K) Top PSID-1: k2_walker","targets":21},{"name":"V22","targets":22},{"name":"(L) Top PSID-1: optimal_pair_stuermer","targets":23},{"name":"V24","targets":24},{"name":"(M) Top PSID-1: optimal_pair_walker","targets":25},{"name":"V26","targets":26},{"name":"(N) Trimmed LDW-CPS-1-PLUS","targets":27},{"name":"V28","targets":28},{"name":"(O) Trimmed LDW-PSID-1-PLUS","targets":29},{"name":"V30","targets":30}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The placebo analysis reveals that the experimental benchmark is positive, near zero and statistically insignificant, while all benchmarks for the top-ranked samples negative and all estimators applied to the observational samples, LDW-CPS-1 and LDW-PSID-1, yield by majority large, negative ATT estimates.</p>
<p>For LDW-CPS-1 (B), most ATT estimates are negative. For LDW-CPS-1 top-ranked samples (D-H), ATT estimates remain largely negative with only a few exceptions but show reasonable improvement in ATT estimates towards the benchmark and overly decreased standard errors compared to the LDW-CPS-1 (B) sample, still indicating persistent bias. For LDW-PSID-1 top-ranked samples (I-M) a similar pattern results compared to the LDW-PSID-1 sample.</p>
<p>The trimmed and matched versions of LDW-CPS-1-PLUS and LDW-PSID-1-PLUS exhibit mainly even larger negative ATT estimates compared to the initial observational samples, reflecting substantial bias and deviation from the true effect.</p>
<p>Overall, across most observational samples and estimators, the placebo test produces ATT estimates that are substantially biased and far from the benchmark. This highlights the persistent challenge in recovering unbiased ATT estimates outside of experimental data.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb148-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb148-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb148-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat_pl, <span class="st">&quot;ldw_att_estimates_pl_model_a&quot;</span>)</span></code></pre></div>
</div>
<div id="validation-through-sensitivity-analyses" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Validation through sensitivity analyses<a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, a sensitivity analyses using the LDW data is conducted and results are depicted in contour plots using the function <code>sens_ana</code> introduced by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb149-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb149-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb149-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span></span>
<span id="cb149-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb149-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb149-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb149-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>)</span>
<span id="cb149-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb149-5" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;re75&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb150-1" tabindex="-1"></a><span class="co"># check for valid samples </span></span>
<span id="cb150-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb150-2" tabindex="-1"></a>filtered_samples_sens <span class="ot">&lt;-</span> <span class="fu">check_filter_samples</span>(all_samples, Y, treat, covar, bm)</span></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb151-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb151-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-3" tabindex="-1"></a></span>
<span id="cb151-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-4" tabindex="-1"></a><span class="co"># loop over valid samples and plot results </span></span>
<span id="cb151-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(filtered_samples_sens)) {</span>
<span id="cb151-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-6" tabindex="-1"></a>    <span class="fu">sens_ana</span>(filtered_samples_sens[[i]], Y, treat, covar, bm, <span class="at">kd =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb151-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-7" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> all_plot_titles[i])</span>
<span id="cb151-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb151-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-127-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-127-1.png" alt="FIGUREA7.  SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.27: FIGUREA7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-127-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-127-2.png" alt="FIGUREA7.  SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.28: FIGUREA7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-127-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-127-3.png" alt="FIGUREA7.  SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.29: FIGUREA7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-127-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-127-4.png" alt="FIGUREA7.  SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.30: FIGUREA7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model A
</p>
</div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb152-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb152-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb152-2" tabindex="-1"></a><span class="fu">save_sensitivity_plots</span>(filtered_samples_sens, Y, treat, covar, bm, all_plot_titles, <span class="st">&quot;ldw_model_a&quot;</span>)</span></code></pre></div>
<pre><code>## SUMMARY: Sensitivity plots - 15 succeeded, 0 failed out of 15 total</code></pre>
<p>The sensitivity analysis shows that for the LDW-Experimental sample, as well as for the LDW-CPS-1 (B) and its top-ranked samples <code>nn_crump</code>, <code>cs_crump</code>,<code>k2_crump</code> and <code>genetic_crump</code> (D-F and H) the estimated treatment effects are fairly robust to increasing confounder strength, as indicated by relatively stable values despite up to triple the correlation levels of the confounder.</p>
<p>For the trimmed and matched LDW-CPS1-PLUS and LDW-PSID-1-PLUS samples (N-O) the estimated treatment effects remain also consistently robust, indicating improved resistance to unmeasured confounding.</p>
<p>For the top-ranked sample <code>cem_stuermer</code> (G) of the LDW-CPS-1 sample as well as for the LDW-PSID-1 sample (C) and all its top-ranked samples (I-M) the estimated treatment effects are sensitive to unmeasured confounding with more pronounced swings, as evidenced by sizable shifts in the estimates.</p>
<p>Overall, these results highlight sample-specific differences in robustness against potential unobserved confounding.</p>
<div class="callout-tip">
<p>The analyses suggest that some samples maintain stable treatment effect estimates despite increasing confounder strength, while others show greater sensitivity. This highlights the importance of assessing robustness across different samples (respectively methods used to derive specific samples) to account for potential unobserved confounding.</p>
</div>
</div>
<div id="inspection-of-re74-and-re75" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Inspection of re74 and re75<a href="lalonde-dehejia-wahba-ldw-data.html#inspection-of-re74-and-re75" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="correlation" class="section level3 hasAnchor" number="2.10.1">
<h3><span class="header-section-number">2.10.1</span> Correlation<a href="lalonde-dehejia-wahba-ldw-data.html#correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To evaluate potential collinearity between <code>re74</code> and <code>re75</code>, we compute their correlation. To determine whether <code>re74</code> may act as a confounder in the treatment effect estimation, we report its correlation with both the treatment assignment (<code>treat</code>) and the outcome (<code>re78</code>).</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-1" tabindex="-1"></a><span class="co"># compute correlations</span></span>
<span id="cb154-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-2" tabindex="-1"></a>cor_treat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_samples, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>treat, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb154-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-3" tabindex="-1"></a>cor_outcome <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_samples, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>re78, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb154-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-4" tabindex="-1"></a>cor_cov <span class="ot">&lt;-</span>  <span class="fu">sapply</span>(all_samples, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>re75, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb154-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-5" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Method =</span> all_plot_titles, <span class="at">Cor_re74_treat =</span> cor_treat, <span class="at">Cor_re74_out =</span> cor_outcome, <span class="at">Cor_re74_re75 =</span> cor_cov)</span>
<span id="cb154-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-6" tabindex="-1"></a></span>
<span id="cb154-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-7" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb154-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-8" tabindex="-1"></a><span class="fu">datatable</span>(cor_table, <span class="at">caption =</span> <span class="st">&quot;Correlations of re74 with treatment and outcome across samples&quot;</span>,</span>
<span id="cb154-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-9" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-dc0f64dbf7ed44db7581" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dc0f64dbf7ed44db7581">{"x":{"filter":"none","vertical":false,"caption":"<caption>Correlations of re74 with treatment and outcome across samples<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: genetic_crump","(E) Top CPS-1: cem_stuermer","(F) Top CPS-1: k2_crump","(G) Top CPS-1: cs_crump","(H) Top CPS-1: nn_crump","(I) Top PSID-1: genetic_walker","(J) Top PSID-1: mahvars_walker","(K) Top PSID-1: k2_walker","(L) Top PSID-1: optimal_pair_stuermer","(M) Top PSID-1: optimal_pair_walker","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[-0.001053570876315096,-0.1318589171128933,-0.3205498776935601,-0.07695061060785235,0.1842958229031346,-0.0971369984756099,-0.0925296180950313,-0.06995640345945964,-0.06101706310412591,-0.06022913028986222,-0.008121510236594895,0.05571581706111429,0.0297236931102002,-0.006795889901496777,-0.08856539121720285],[0.08538444807049547,0.6403298797173105,0.7037833918980824,-0.03210253089134894,0.3208953504934447,0.01573337072620831,-0.03424934967355504,0.01040475996315702,0.4361069920183605,0.5232095861492088,0.3353892681109454,0.2580028514563373,0.3803279398886555,0.06827093779599486,0.1103138278032386],[0.6552006463328206,0.8719266231341293,0.8558591757325856,0.4896797457532465,0.7208107731763188,0.3757034520111525,0.4069126410633624,0.4957329579564542,0.582590222242054,0.6170489840618059,0.4909467011333986,0.4809674438525204,0.4865281543106275,0.6460144798540387,0.5451711804205687]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Cor_re74_treat<\/th>\n      <th>Cor_re74_out<\/th>\n      <th>Cor_re74_re75<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Cor_re74_treat","targets":2},{"name":"Cor_re74_out","targets":3},{"name":"Cor_re74_re75","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The tabulated results indicate that 1974 earnings (<code>re74</code>) is effectively independent of the treatment assignment across all samples, with correlations ranging from approximately −0.32 to 0.18. In contrast, 1974 earnings exhibits moderately strong positive correlations with the outcome, ranging from approximately −0.03 to 0.70, suggesting that this pretreatment characteristic constitutes a meaningful confounder of post-program earnings, but not an important determinant of the treatment assignment. Further, 1974 earnings exhibits substantial correlation with 1975 earnings, implying considerable collinearity between these two lagged covariates and suggesting that the informational gain from including both may be limited.</p>
<p>Overall, these results do not provide clear guidance on whether to include 1974 earnings in the set of covariates, but suggest that one should weigh the trade-off between potential omitted variable bias and increased collinearity when making covariate selection decisions.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb155-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb155-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb155-2" tabindex="-1"></a><span class="fu">save_csv</span>(cor_table, <span class="st">&quot;ldw_model_a_corr_results&quot;</span>)</span></code></pre></div>
</div>
<div id="distributional-balance" class="section level3 hasAnchor" number="2.10.2">
<h3><span class="header-section-number">2.10.2</span> Distributional balance<a href="lalonde-dehejia-wahba-ldw-data.html#distributional-balance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further assess the risk of confounding, we examine the distributional balance of <code>re74</code> and, for comparison, of <code>re75</code> by plotting their density distributions for treated and control units. As model B intentionally omits <code>re74</code>, the analysis directly informs whether any covariate imbalance may induce bias in estimated treatment effects.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-1" tabindex="-1"></a><span class="co"># re75</span></span>
<span id="cb156-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(all_samples)) {</span>
<span id="cb156-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-3" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb156-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-4" tabindex="-1"></a>    <span class="fu">print</span>(</span>
<span id="cb156-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-5" tabindex="-1"></a>      <span class="fu">bal.plot</span>(treat <span class="sc">~</span> re75, <span class="at">data =</span> all_samples[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span></span>
<span id="cb156-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-6" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(all_plot_titles[i])</span>
<span id="cb156-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-7" tabindex="-1"></a>    )</span>
<span id="cb156-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-8" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb156-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-9" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, all_plot_titles[i], e<span class="sc">$</span>message))</span>
<span id="cb156-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-10" tabindex="-1"></a>  })</span>
<span id="cb156-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-1.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.31: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-2.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.32: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-3.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.33: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-4.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.34: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-5.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.35: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-6.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.36: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-7.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.37: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-8.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.38: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-9.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.39: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-10.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.40: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-11.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.41: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-12.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.42: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-13.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.43: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-14.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.44: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-15.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.45: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-1" tabindex="-1"></a><span class="co"># re74</span></span>
<span id="cb157-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(all_samples)) {</span>
<span id="cb157-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-3" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb157-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-4" tabindex="-1"></a>    <span class="fu">print</span>(</span>
<span id="cb157-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-5" tabindex="-1"></a>      <span class="fu">bal.plot</span>(treat <span class="sc">~</span> re74, <span class="at">data =</span> all_samples[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span></span>
<span id="cb157-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-6" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(all_plot_titles[i])</span>
<span id="cb157-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-7" tabindex="-1"></a>    )</span>
<span id="cb157-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-8" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb157-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-9" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, all_plot_titles[i], e<span class="sc">$</span>message))</span>
<span id="cb157-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-10" tabindex="-1"></a>  })</span>
<span id="cb157-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-16.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.46: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-17.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.47: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-18.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.48: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-19.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.49: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-20.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.50: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-21.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.51: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-22.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.52: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-23.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.53: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-24.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.54: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-25.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.55: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-26.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.56: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-27.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.57: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-28.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.58: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-29.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.59: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-30.png" alt="FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75" width="100%" />
<p class="caption">
Figure 2.60: FIGUREA8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model A of re75
</p>
</div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb158-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb158-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb158-2" tabindex="-1"></a><span class="fu">save_balance</span>(all_samples, all_plot_titles, <span class="at">balance_var =</span> <span class="st">&quot;re75&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_balance_panels_75&quot;</span>)</span>
<span id="cb158-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb158-3" tabindex="-1"></a><span class="fu">save_balance</span>(all_samples, all_plot_titles, <span class="at">balance_var =</span> <span class="st">&quot;re74&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_balance_panels_74&quot;</span>)</span></code></pre></div>
<p>The density plots indicate that treated and control units do not substantially differ in <code>re74</code> across all samples. However, clear while moderate discrepancies are present in the top‑ranked LDW–PSID‑1 samples. The corresponding plots for <code>re75</code> show a broadly comparable degree of difference but slightly more pronounced distributional differences between treated and control units across most samples. Overall, this pattern suggests that the risk of confounding from <code>re74</code> is limited and that the bias from omitting re74 from the covariate set is reasonably small.</p>
<p>Thus, considering the pronounced collinearity with 1975 earnings, the moderate correlation with the outcome, and the minor balance concerns, 1974 earnings may be excluded from the covariate set. However, whether its inclusion or exclusion materially affects the treatment effect estimates warrants validation. Accordingly, model B is specified without 1974 earnings and the complete analysis is redone.</p>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Summary<a href="lalonde-dehejia-wahba-ldw-data.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After reexamining model A, that is based on the LDW sample, several insights emerge. First, we confirm that ensuring overlap between treated and control groups remains crucial for credible causal estimation. The LDW-Experimental sample exhibits almost perfect overlap, while the observational samples show poorer overlap, with many treated units outside the control range.</p>
<p>Second, controlling for covariates such as age, education, race, and prior earnings, and using various methods including trimming, and integrated approaches, largely yields consistent effect estimates. Thereby, the propensity score plays an important role in constructing samples and assessing overlap between groups.</p>
<p>Further, placebo tests and sensitivity analyses reveal lingering concerns about the unconfoundedness assumption and robustness of some estimators.</p>
<p>The correlation and balance analysis reveals that its important to control for 1975 earnings, while for 1974 earnings it may be limited, although this warrants further investigation.</p>
<p>Overall, this section highlights the importance of overlap, the utility of propensity scores, and the need for rigorous validation of the unconfoundedness assumption to produce credible effect estimates.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Firpo_2007" class="csl-entry">
Firpo, Sergio. 2007. <span>“Efficient Semiparametric Estimation of Quantile Treatment Effects.”</span>
</div>
<div id="ref-Greifer_3_2025" class="csl-entry">
Greifer, Noah. 2025. <span>“Matching Methods.”</span>
</div>
<div id="ref-imbens2024" class="csl-entry">
Imbens, Guido W., and Yiqing Xu. 2024. <span>“LaLonde (1986) After Nearly Four Decades: Lessons Learned.”</span>
</div>
<div id="ref-OW_Package" class="csl-entry">
Knaus, Michael C., and Henri Pfleiderer. 2024. <span>“Outcome Weights.”</span>
</div>
<div id="ref-Stuermer_2021" class="csl-entry">
Stürmer, Til, Michael Webster-Clark, Jennifer L. Lund, Richard Wyss, Alan R. Ellis, Mark Lunt, Kenneth J. Rothman, and Robert J. Glynn. 2021. <span>“Propensity Score Weighting and Trimming Strategies for Reducing Variance and Bias of Treatment Effect Estimates: A Simulation Study.”</span> <em>American Journal of Epidemiology</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lalonde-dehejia-wahba-ldw-data-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study/edit/main/tutorial/02-LDW-Model-A.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Outcome-Weights.pdf", "Outcome-Weights.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
