<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</title>
  <meta name="description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  <meta name="github-repo" content="lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  
  <meta name="twitter:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  

<meta name="author" content="Laura Kreisel" />


<meta name="date" content="2025-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html"/>
<link rel="next" href="lalonde-dehejia-wahba-ldw-data-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tutorial/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Application of Outcome Weights Framework for DML to Lalonde Study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#wrapper-functions"><i class="fa fa-check"></i><b>1.2</b> Wrapper functions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started.html"><a href="getting-started.html#overview"><i class="fa fa-check"></i><b>1.2.1</b> Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started.html"><a href="getting-started.html#inspection"><i class="fa fa-check"></i><b>1.2.2</b> Inspection</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started.html"><a href="getting-started.html#improving-covariate-balance-and-overlap"><i class="fa fa-check"></i><b>1.2.3</b> Improving covariate balance and overlap</a></li>
<li class="chapter" data-level="1.2.4" data-path="getting-started.html"><a href="getting-started.html#reassessing-methods"><i class="fa fa-check"></i><b>1.2.4</b> Reassessing methods</a></li>
<li class="chapter" data-level="1.2.5" data-path="getting-started.html"><a href="getting-started.html#estimating"><i class="fa fa-check"></i><b>1.2.5</b> Estimating</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#outcome-weights-analysis"><i class="fa fa-check"></i><b>1.3</b> Outcome weights analysis</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#sensitivity-analysis"><i class="fa fa-check"></i><b>1.4</b> Sensitivity analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html"><i class="fa fa-check"></i><b>2</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#set-up"><i class="fa fa-check"></i><b>2.1</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data"><i class="fa fa-check"></i><b>2.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="2.1.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data"><i class="fa fa-check"></i><b>2.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="2.1.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data"><i class="fa fa-check"></i><b>2.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#model-a"><i class="fa fa-check"></i><b>2.2</b> Model A</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-overlap-and-covariate-balance"><i class="fa fa-check"></i><b>2.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-covariate-balance"><i class="fa fa-check"></i><b>2.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#matching-2"><i class="fa fa-check"></i><b>2.3.1</b> Matching</a></li>
<li class="chapter" data-level="2.3.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#weighting-2"><i class="fa fa-check"></i><b>2.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-overlap"><i class="fa fa-check"></i><b>2.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#truncation-2"><i class="fa fa-check"></i><b>2.4.1</b> Truncation</a></li>
<li class="chapter" data-level="2.4.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#trimming-2"><i class="fa fa-check"></i><b>2.4.2</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods"><i class="fa fa-check"></i><b>2.5</b> Integrated methods</a></li>
<li class="chapter" data-level="2.6" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#reassessing-methods-1"><i class="fa fa-check"></i><b>2.6</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#matching-3"><i class="fa fa-check"></i><b>2.6.1</b> Matching</a></li>
<li class="chapter" data-level="2.6.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#weighting-3"><i class="fa fa-check"></i><b>2.6.2</b> Weighting</a></li>
<li class="chapter" data-level="2.6.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#truncation-3"><i class="fa fa-check"></i><b>2.6.3</b> Truncation</a></li>
<li class="chapter" data-level="2.6.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#trimming-3"><i class="fa fa-check"></i><b>2.6.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-1"><i class="fa fa-check"></i><b>2.7</b> Integrated methods</a></li>
<li class="chapter" data-level="2.8" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#top-methods-and-datasets"><i class="fa fa-check"></i><b>2.8</b> Top methods and datasets</a></li>
<li class="chapter" data-level="2.9" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1"><i class="fa fa-check"></i><b>2.9</b> Estimating</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att"><i class="fa fa-check"></i><b>2.9.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="2.9.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1"><i class="fa fa-check"></i><b>2.9.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="2.9.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet"><i class="fa fa-check"></i><b>2.9.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="2.9.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow"><i class="fa fa-check"></i><b>2.9.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses"><i class="fa fa-check"></i><b>2.10</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="2.11" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses"><i class="fa fa-check"></i><b>2.11</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="2.12" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#summary"><i class="fa fa-check"></i><b>2.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html"><i class="fa fa-check"></i><b>3</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1"><i class="fa fa-check"></i><b>3.1</b> Set up</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1"><i class="fa fa-check"></i><b>3.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="3.1.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1"><i class="fa fa-check"></i><b>3.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="3.1.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#model-b"><i class="fa fa-check"></i><b>3.2</b> Model B</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-overlap-and-covariate-balance-1"><i class="fa fa-check"></i><b>3.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-covariate-balance-1"><i class="fa fa-check"></i><b>3.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-4"><i class="fa fa-check"></i><b>3.3.1</b> Matching</a></li>
<li class="chapter" data-level="3.3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-4"><i class="fa fa-check"></i><b>3.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-overlap-1"><i class="fa fa-check"></i><b>3.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-4"><i class="fa fa-check"></i><b>3.4.1</b> Truncation</a></li>
<li class="chapter" data-level="3.4.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-4"><i class="fa fa-check"></i><b>3.4.2</b> Trimming</a></li>
<li class="chapter" data-level="3.4.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-2"><i class="fa fa-check"></i><b>3.4.3</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#reassessing-methods-2"><i class="fa fa-check"></i><b>3.5</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-5"><i class="fa fa-check"></i><b>3.5.1</b> Matching</a></li>
<li class="chapter" data-level="3.5.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-5"><i class="fa fa-check"></i><b>3.5.2</b> Weighting</a></li>
<li class="chapter" data-level="3.5.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-5"><i class="fa fa-check"></i><b>3.5.3</b> Truncation</a></li>
<li class="chapter" data-level="3.5.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-5"><i class="fa fa-check"></i><b>3.5.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-3"><i class="fa fa-check"></i><b>3.6</b> Integrated methods</a></li>
<li class="chapter" data-level="3.7" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#top-methods-and-datasets-1"><i class="fa fa-check"></i><b>3.7</b> Top methods and datasets</a></li>
<li class="chapter" data-level="3.8" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2"><i class="fa fa-check"></i><b>3.8</b> Estimating</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1"><i class="fa fa-check"></i><b>3.8.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="3.8.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2"><i class="fa fa-check"></i><b>3.8.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="3.8.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1"><i class="fa fa-check"></i><b>3.8.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="3.8.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1"><i class="fa fa-check"></i><b>3.8.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1"><i class="fa fa-check"></i><b>3.9</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="3.10" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1"><i class="fa fa-check"></i><b>3.10</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="3.11" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1"><i class="fa fa-check"></i><b>3.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html"><i class="fa fa-check"></i><b>4</b> LaLonde (NSW) Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#set-up-2"><i class="fa fa-check"></i><b>4.1</b> Set up</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#source-functions-and-load-data-2"><i class="fa fa-check"></i><b>4.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="4.1.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#load-and-preprocess-data-2"><i class="fa fa-check"></i><b>4.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="4.1.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#inspect-data-2"><i class="fa fa-check"></i><b>4.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#nsw"><i class="fa fa-check"></i><b>4.2</b> NSW</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-overlap-and-covariate-balance-2"><i class="fa fa-check"></i><b>4.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-primarily-covariate-balance-2"><i class="fa fa-check"></i><b>4.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#matching-6"><i class="fa fa-check"></i><b>4.3.1</b> Matching</a></li>
<li class="chapter" data-level="4.3.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#weighting-6"><i class="fa fa-check"></i><b>4.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-primarily-overlap-2"><i class="fa fa-check"></i><b>4.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#truncation-6"><i class="fa fa-check"></i><b>4.4.1</b> Truncation</a></li>
<li class="chapter" data-level="4.4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#trimming-6"><i class="fa fa-check"></i><b>4.4.2</b> Trimming</a></li>
<li class="chapter" data-level="4.4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-4"><i class="fa fa-check"></i><b>4.4.3</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#reassessing-methods-3"><i class="fa fa-check"></i><b>4.5</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#matching-7"><i class="fa fa-check"></i><b>4.5.1</b> Matching</a></li>
<li class="chapter" data-level="4.5.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#weighting-7"><i class="fa fa-check"></i><b>4.5.2</b> Weighting</a></li>
<li class="chapter" data-level="4.5.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#truncation-7"><i class="fa fa-check"></i><b>4.5.3</b> Truncation</a></li>
<li class="chapter" data-level="4.5.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#trimming-7"><i class="fa fa-check"></i><b>4.5.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-5"><i class="fa fa-check"></i><b>4.6</b> Integrated methods</a></li>
<li class="chapter" data-level="4.7" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#top-methods-and-datasets-2"><i class="fa fa-check"></i><b>4.7</b> Top methods and datasets</a></li>
<li class="chapter" data-level="4.8" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#estimating-3"><i class="fa fa-check"></i><b>4.8</b> Estimating</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#average-treatment-effect-on-the-treated-att-2"><i class="fa fa-check"></i><b>4.8.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="4.8.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#conditional-average-treatment-effect-on-the-treated-catt-3"><i class="fa fa-check"></i><b>4.8.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="4.8.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#quantile-treatment-effect-on-the-treated-qtet-2"><i class="fa fa-check"></i><b>4.8.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="4.8.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-outcome-weights-ow-2"><i class="fa fa-check"></i><b>4.8.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#validation-through-sensitivity-analyses-2"><i class="fa fa-check"></i><b>4.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="4.10" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#summary-2"><i class="fa fa-check"></i><b>4.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html"><i class="fa fa-check"></i><b>5</b> LaLonde-Calónico-Smith (LCS) Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#set-up-3"><i class="fa fa-check"></i><b>5.1</b> Set up</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#source-functions-and-load-data-3"><i class="fa fa-check"></i><b>5.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="5.1.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#load-and-preprocess-data-3"><i class="fa fa-check"></i><b>5.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="5.1.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#inspect-data-3"><i class="fa fa-check"></i><b>5.1.3</b> Inspect data</a></li>
<li class="chapter" data-level="5.1.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-overlap-and-covariate-balance-3"><i class="fa fa-check"></i><b>5.1.4</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-primarily-covariate-balance-3"><i class="fa fa-check"></i><b>5.2</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#matching-8"><i class="fa fa-check"></i><b>5.2.1</b> Matching</a></li>
<li class="chapter" data-level="5.2.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#weighting-8"><i class="fa fa-check"></i><b>5.2.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-primarily-overlap-3"><i class="fa fa-check"></i><b>5.3</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#truncation-8"><i class="fa fa-check"></i><b>5.3.1</b> Truncation</a></li>
<li class="chapter" data-level="5.3.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#trimming-8"><i class="fa fa-check"></i><b>5.3.2</b> Trimming</a></li>
<li class="chapter" data-level="5.3.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#combination-of-methods"><i class="fa fa-check"></i><b>5.3.3</b> Combination of methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#reassessing-methods-4"><i class="fa fa-check"></i><b>5.4</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#matching-9"><i class="fa fa-check"></i><b>5.4.1</b> Matching</a></li>
<li class="chapter" data-level="5.4.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#weighting-9"><i class="fa fa-check"></i><b>5.4.2</b> Weighting</a></li>
<li class="chapter" data-level="5.4.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#truncation-9"><i class="fa fa-check"></i><b>5.4.3</b> Truncation</a></li>
<li class="chapter" data-level="5.4.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#trimming-9"><i class="fa fa-check"></i><b>5.4.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-6"><i class="fa fa-check"></i><b>5.5</b> Integrated methods</a></li>
<li class="chapter" data-level="5.6" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#top-methods-and-datasets-3"><i class="fa fa-check"></i><b>5.6</b> Top methods and datasets</a></li>
<li class="chapter" data-level="5.7" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#estimating-4"><i class="fa fa-check"></i><b>5.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#average-treatment-effect-on-the-treated-att-3"><i class="fa fa-check"></i><b>5.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="5.7.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#conditional-average-treatment-effect-on-the-treated-catt-4"><i class="fa fa-check"></i><b>5.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="5.7.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#quantile-treatment-effect-on-the-treated-qtet-3"><i class="fa fa-check"></i><b>5.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="5.7.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-outcome-weights-ow-3"><i class="fa fa-check"></i><b>5.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-placebo-analyses-2"><i class="fa fa-check"></i><b>5.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="5.9" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-sensitivity-analyses-3"><i class="fa fa-check"></i><b>5.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="5.10" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#summary-3"><i class="fa fa-check"></i><b>5.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lalonde-dehejia-wahba-ldw-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> LaLonde-Dehejia-Wahba (LDW) Data<a href="lalonde-dehejia-wahba-ldw-data.html#lalonde-dehejia-wahba-ldw-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>LaLonde (1986) evaluated the effect of the National Supported Work Demonstration (NSW) program on both female and male participants. While the female participants were drawn from the Aid to Families with Dependent Children (AFDC) program, the male participants were drawn from three other groups: former drug addicts, ex-criminal offenders, and high-school dropouts. LaLonde relied on two main data sources:
(1) CPS-SSA-1, based on Westat’s Matched Current Population Survey–Social Security Administration File for individuals under 55 matching specific criteria;
(2) PSID-1, based on Panel Study of Income Dynamics for household heads under 55 from specific years who were not retired in 1975, adjusted for factors like employment status and poverty level, resulting in four additional comparison groups;</p>
<p>Dehejia and Wahba (1999) constructed a subset of LaLonde’s original data, retaining 62% of observations and restricting the focus to male participants based on their 1974 earnings. As the dataset was formed entirely on pretreatment information like employment records or month of assignment, treatment allocation was effectively independent of all pretreatment variables. Thus they concluded that this subset, known as the LaLonde-Dehejia-Wahba (LDW) data, constitutes a valid experimental sample.</p>
<p>The analysis in this section (2) and section 3 builds on the LDW data and considers in total three samples:
(1) LDW-Experimental, consisting of 185 treated individuals and 280 controls from the experimental data;
(2) LDW-CPS1, which pairs the same treated sample with 15,992 controls from CPS-SSA-1;
(3) LDW-PSID1, featuring the same treated sample with 2,490 controls from PSID-1;
In section 4, the analysis applies the same set of statistical tools to analyze a fourth sample as an additional demonstration:
(4) LaLonde male samples (1986).
In the last section, the analysis applies a reduced set of statistical tools to analyze a fifth sample again as an additional demonstration:
(5) LaLonde female samples (2017).</p>
<p>This section (2) covers model A, which includes the outcome variable 1978 earnings (<code>re78</code>) and adjusts for a set of covariates: age, education, race (black, hispanic), marital status, lack of high school degree, 1974 and 1975 earnings (<code>re74</code>, <code>re75</code>), and unemployment status in 1974 and 1975 (<code>u74</code>, <code>u75</code>). The model is defined by a regression formula for treatment assignment using these covariates. To improve covariate balance and overlap between treated and control groups, various methods are applied and are structured into five parts: Matching, Weighting, Truncation, Trimming and Combined Methods integrating these techniques. From these methods, the top 5 ranked are identified based on absolute standardized mean differences (SMDs) and effective sample size (ESS). The corresponding datasets are used to estimate the average treatment effect on the treated (ATT). Notably, the estimation incorporates the recently introduced augmented inverse probability weighting (AIPW) estimator, implemented via the <code>OutcomeWeights</code> R package. Subsequently, alternative estimands are considered, including the conditional average treatment effect for the treated (CATT) and the quantile treatment effect on the treated (QTET). After estimating these effects, outcome weights are analyzed to identify potential patterns in the contribution of individual observations to the ATT. Placebo tests are then conducted using 1975 earnings (<code>re75</code>) as an outcome to assess potential biases and the validity of unconfoundedness assumptions. Finally, sensitivity analyses are performed to evaluate the robustness of treatment effect estimates to violations of these assumptions.</p>
<div id="set-up" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Set up<a href="lalonde-dehejia-wahba-ldw-data.html#set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="source-functions-and-load-data" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Source functions and load data<a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb63-1" tabindex="-1"></a><span class="co"># source functions</span></span>
<span id="cb63-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb63-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://github.com/xuyiqing/lalonde/blob/main/tutorial/functions.R?raw=TRUE&quot;</span>)</span>
<span id="cb63-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb63-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;tutorial/functions.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb64-1" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb64-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb64-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/lalonde.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb65-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb65-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb65-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="inspect-data" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Inspect data<a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-1" tabindex="-1"></a><span class="co"># collect datasets in a list</span></span>
<span id="cb66-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">lalonde =</span> lalonde, <span class="at">ldw_tr =</span> ldw_tr, <span class="at">ldw_co =</span> ldw_co, <span class="at">ldw_cps =</span> ldw_cps, <span class="at">ldw_psid =</span> ldw_psid)</span>
<span id="cb66-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-3" tabindex="-1"></a></span>
<span id="cb66-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-4" tabindex="-1"></a><span class="co"># inspect key metrics of each dataset</span></span>
<span id="cb66-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-5" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(data)</span>
<span id="cb66-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb66-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-67">Table 2.1: </span>Summary Statistics</caption>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dataset</th>
<th align="right">num_obs</th>
<th align="right">num_vars</th>
<th align="left">name_vars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lalonde</td>
<td align="right">2675</td>
<td align="right">13</td>
<td align="left">nsw, age, educ, black, hisp, married, re74, re75, re78, u74, u75, u78, nodegr</td>
</tr>
<tr class="even">
<td align="left">ldw_tr</td>
<td align="right">185</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="odd">
<td align="left">ldw_co</td>
<td align="right">260</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="even">
<td align="left">ldw_cps</td>
<td align="right">16177</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="odd">
<td align="left">ldw_psid</td>
<td align="right">2675</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
</tbody>
</table>
</div>
<div id="load-and-preprocess-data" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Load and preprocess data<a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We merge the experimental controls from LDW-Experimental into LDW-CPS1 and LDW-PSID1 to augment the control groups with additional observations, following a similar approach as by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-1" tabindex="-1"></a><span class="co"># assigns 1 to the experimental controls</span></span>
<span id="cb67-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-2" tabindex="-1"></a>ldw_co<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-3" tabindex="-1"></a></span>
<span id="cb67-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-4" tabindex="-1"></a><span class="co"># merge experimental data with CPS1 data</span></span>
<span id="cb67-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-5" tabindex="-1"></a>ldw_cps_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb67-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-6" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb67-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-7" tabindex="-1"></a>  ldw_cps    <span class="co"># CPS1 data (16177 observations)</span></span>
<span id="cb67-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-8" tabindex="-1"></a>)</span>
<span id="cb67-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-9" tabindex="-1"></a></span>
<span id="cb67-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-10" tabindex="-1"></a><span class="co"># merge experimental data with PSID1 data</span></span>
<span id="cb67-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-11" tabindex="-1"></a>ldw_psid_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb67-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-12" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb67-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-13" tabindex="-1"></a>  ldw_psid   <span class="co"># PSID1 data (2675 observations)</span></span>
<span id="cb67-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-14" tabindex="-1"></a>)</span>
<span id="cb67-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-15" tabindex="-1"></a></span>
<span id="cb67-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-16" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw_cps_plus  =</span> ldw_cps_plus, <span class="at">ldw_psid_plus =</span> ldw_psid_plus)</span>
<span id="cb67-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-17" tabindex="-1"></a></span>
<span id="cb67-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-18" tabindex="-1"></a><span class="co"># inspect key metrics of each dataset</span></span>
<span id="cb67-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-19" tabindex="-1"></a>summary_stats_plus <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(datasets)</span>
<span id="cb67-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb67-20" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats_plus, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-68">Table 2.2: </span>Summary Statistics</caption>
<colgroup>
<col width="10%" />
<col width="5%" />
<col width="6%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dataset</th>
<th align="right">num_obs</th>
<th align="right">num_vars</th>
<th align="left">name_vars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ldw_cps_plus</td>
<td align="right">16437</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="even">
<td align="left">ldw_psid_plus</td>
<td align="right">2935</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="model-a" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Model A<a href="lalonde-dehejia-wahba-ldw-data.html#model-a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb68-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span> </span>
<span id="cb68-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span> </span>
<span id="cb68-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, </span>
<span id="cb68-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb68-5" tabindex="-1"></a>           <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>) <span class="co">#re74 included</span></span></code></pre></div>
<div id="assessing-overlap-and-covariate-balance" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Assessing overlap and covariate balance<a href="lalonde-dehejia-wahba-ldw-data.html#assessing-overlap-and-covariate-balance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="overlap" class="section level4 hasAnchor" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> Overlap<a href="lalonde-dehejia-wahba-ldw-data.html#overlap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To identify the average causal effect under unconfoundedness (that asserts that the treatment assignment is independent of the potential outcomes), it must be ensured that one can estimate the average effect at every value for the covariates. Thus, overlaps between the treated and untreated units (meaning that for every combination of covariates, there are both treated and untreated units in the dataset) are required. The <code>assess_overlap()</code> function of <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span> is used to assess overlaps in the propensity scores and to visualize results using histograms of their log-odds.</p>
<p>In a properly balanced experimental design, the distributions of the treatment group (red) and the control group (gray) would show considerable coverage.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-1" tabindex="-1"></a><span class="co"># assess overlap</span></span>
<span id="cb69-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb69-2" tabindex="-1"></a>ldw.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -1.310867 0.7158619</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-70-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-70-1.png" alt="FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 2.1: FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb71-1" tabindex="-1"></a>ldw_cps.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 1.787343</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-70-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-70-2.png" alt="FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 2.2: FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb73-1" tabindex="-1"></a>ldw_psid.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.752723</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-70-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-70-3.png" alt="FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 2.3: FIGURE A1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<p>As anticipated, LDW-Experimental exhibits an almost perfect overlap. In contrast, the observational datasets LDW-CPS1 and LDW-PSID1 show weak overlap. In particular, many treated units have propensity scores outside the range of the controls, while a large share of control units have propensity scores concentrated at very low log-odds.</p>
<p>Next, we examine the overlap of the expanded observational datasets.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb75-1" tabindex="-1"></a><span class="co"># assess overlap</span></span>
<span id="cb75-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb75-2" tabindex="-1"></a>ldw_cps_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.63151</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-71-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-71-1.png" alt="FIGURE A1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.4: FIGURE A1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb77-1" tabindex="-1"></a>ldw_psid_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 7.271394</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-71-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-71-2.png" alt="FIGURE A1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.5: FIGURE A1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<p>As expected, the datasets LDW-CPS1-PLUS and LDW-PSID1-PLUS show an improved overlap compared to their non-plus states.</p>
<p>For the following analysis, we set up a model formula.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb79-1" tabindex="-1"></a><span class="co"># set model formula</span></span>
<span id="cb79-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb79-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(treat, <span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(covar, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)))</span></code></pre></div>
</div>
<div id="covariate-balance" class="section level4 hasAnchor" number="2.2.1.2">
<h4><span class="header-section-number">2.2.1.2</span> Covariate balance<a href="lalonde-dehejia-wahba-ldw-data.html#covariate-balance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Initial covariate balance checks reveal the degree to which treatment and control groups differ on observed characteristics. We employ the <code>bal.tab()</code> function from the cobalt package to generate detailed balance statistics, complemented by visual summaries using <code>love.plot()</code>, which depicts standardized mean differences across covariates before and after adjustment.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb80-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_cps, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-73-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-73-1.png" alt="FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.6: FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb81-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_cps_plus, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-73-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-73-2.png" alt="FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.7: FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb82-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_psid, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-73-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-73-3.png" alt="FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.8: FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb83-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_psid_plus, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-73-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-73-4.png" alt="FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 2.9: FIGURE A2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<p>Neither LDW-CPS1-PLUS nor LDW-PSID1-PLUS shows consistently improved covariate balance compared with their non-plus counterparts based on raw standardized mean differences. Although some specific covariates improve slightly, most show the same or increased imbalance.</p>
<div class="callout-note">
<p>For the subsequent analysis aimed at enhancing covariate balance and overlap, only the two datasets LDW-CPS1-PLUS and LDW-PSID1-PLUS are used. The LDW-Experimental dataset is excluded from these steps, as randomization already ensures adequate covariate balance and overlap.</p>
</div>
</div>
</div>
</div>
<div id="improving-primarily-covariate-balance" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Improving primarily covariate balance<a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-covariate-balance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="matching-2" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Matching<a href="lalonde-dehejia-wahba-ldw-data.html#matching-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The purpose of matching is to create comparable treated and control groups by pairing units with similar covariate profiles, thereby reducing covariate imbalance and confounding bias. We apply several matching methods in the following.</p>
<div id="distance-matching" class="section level4 hasAnchor" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> Distance Matching<a href="lalonde-dehejia-wahba-ldw-data.html#distance-matching" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="nearest-neighbor-matching" class="section level5 hasAnchor" number="2.3.1.1.1">
<h5><span class="header-section-number">2.3.1.1.1</span> 1:1 Nearest neighbor matching<a href="lalonde-dehejia-wahba-ldw-data.html#nearest-neighbor-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=1, logistic propensity score and replacement</span></span>
<span id="cb84-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-2" tabindex="-1"></a>m.out.cps_plus.nearest <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb84-3" tabindex="-1"></a>m.out.psid_plus.nearest <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="k1-matching-k2" class="section level5 hasAnchor" number="2.3.1.1.2">
<h5><span class="header-section-number">2.3.1.1.2</span> k:1 matching (k=2)<a href="lalonde-dehejia-wahba-ldw-data.html#k1-matching-k2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb85-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-2" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=2, logistic propensity score and replacement</span></span>
<span id="cb85-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-3" tabindex="-1"></a>m.out.cps_plus.k2 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb85-4" tabindex="-1"></a>m.out.psid_plus.k2 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="k1-matching-k3" class="section level5 hasAnchor" number="2.3.1.1.3">
<h5><span class="header-section-number">2.3.1.1.3</span> k:1 matching (k=3)<a href="lalonde-dehejia-wahba-ldw-data.html#k1-matching-k3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb86-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb86-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb86-2" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=3, logistic propensity score and replacement</span></span>
<span id="cb86-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb86-3" tabindex="-1"></a>m.out.cps_plus.k3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb86-4" tabindex="-1"></a>m.out.psid_plus.k3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="caliper-matching" class="section level5 hasAnchor" number="2.3.1.1.4">
<h5><span class="header-section-number">2.3.1.1.4</span> Caliper matching<a href="lalonde-dehejia-wahba-ldw-data.html#caliper-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with a caliper of 0.1 on the logistic propensity score </span></span>
<span id="cb87-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-2" tabindex="-1"></a>m.out.cps_plus.caliper <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb87-3" tabindex="-1"></a>m.out.psid_plus.caliper <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="common-support-restriction-matching" class="section level5 hasAnchor" number="2.3.1.1.5">
<h5><span class="header-section-number">2.3.1.1.5</span> Common support restriction matching<a href="lalonde-dehejia-wahba-ldw-data.html#common-support-restriction-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with exclusion of units outside common support</span></span>
<span id="cb88-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-2" tabindex="-1"></a>m.out.cps_plus.cs <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb88-3" tabindex="-1"></a>m.out.psid_plus.cs <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="mahalanobis-distance-matching-mahvars" class="section level5 hasAnchor" number="2.3.1.1.6">
<h5><span class="header-section-number">2.3.1.1.6</span> Mahalanobis distance matching (mahvars)<a href="lalonde-dehejia-wahba-ldw-data.html#mahalanobis-distance-matching-mahvars" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching using mahalanobis distance on selected covariates</span></span>
<span id="cb89-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-2" tabindex="-1"></a>m.out.cps_plus.mahvars <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.2</span>, <span class="at">mahvars =</span> <span class="sc">~</span> age <span class="sc">+</span> education <span class="sc">+</span> re74 <span class="sc">+</span> re75, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb89-3" tabindex="-1"></a>m.out.psid_plus.mahvars <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.2</span>, <span class="at">mahvars =</span> <span class="sc">~</span> age <span class="sc">+</span> education <span class="sc">+</span> re74 <span class="sc">+</span> re75, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="optimal-pair-matching" class="section level5 hasAnchor" number="2.3.1.1.7">
<h5><span class="header-section-number">2.3.1.1.7</span> Optimal pair matching<a href="lalonde-dehejia-wahba-ldw-data.html#optimal-pair-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-1" tabindex="-1"></a><span class="co"># perform optimal pair matching that minimizes total within-pair distance on propensity scores</span></span>
<span id="cb90-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-2" tabindex="-1"></a>m.out.cps_plus.optimal_pair <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb90-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb90-3" tabindex="-1"></a>m.out.psid_plus.optimal_pair <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="optimal-full-matching" class="section level5 hasAnchor" number="2.3.1.1.8">
<h5><span class="header-section-number">2.3.1.1.8</span> Optimal full matching<a href="lalonde-dehejia-wahba-ldw-data.html#optimal-full-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-1" tabindex="-1"></a><span class="co"># perform optimal full matching allowing sets with varying ratios of treated to controls and minimizing a global distance criterion</span></span>
<span id="cb91-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-2" tabindex="-1"></a>m.out.cps_plus.optimal_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb91-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb91-3" tabindex="-1"></a>m.out.psid_plus.optimal_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="generalized-full-matching" class="section level5 hasAnchor" number="2.3.1.1.9">
<h5><span class="header-section-number">2.3.1.1.9</span> Generalized full matching<a href="lalonde-dehejia-wahba-ldw-data.html#generalized-full-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-1" tabindex="-1"></a><span class="co"># perform generalized full matching using fast approximation and producing matched sets with flexible treated/control ratios </span></span>
<span id="cb92-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-2" tabindex="-1"></a>m.out.cps_plus.general_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb92-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb92-3" tabindex="-1"></a>m.out.psid_plus.general_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="genetic-matching" class="section level5 hasAnchor" number="2.3.1.1.10">
<h5><span class="header-section-number">2.3.1.1.10</span> Genetic matching<a href="lalonde-dehejia-wahba-ldw-data.html#genetic-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-1" tabindex="-1"></a><span class="co"># perform genetic matching </span></span>
<span id="cb93-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-2" tabindex="-1"></a>m.out.cps_plus.genetic <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span>
<span id="cb93-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb93-3" tabindex="-1"></a>m.out.psid_plus.genetic <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span></code></pre></div>
</div>
</div>
<div id="stratum-matching" class="section level4 hasAnchor" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> Stratum matching<a href="lalonde-dehejia-wahba-ldw-data.html#stratum-matching" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="exact-matching-exact" class="section level5 hasAnchor" number="2.3.1.2.1">
<h5><span class="header-section-number">2.3.1.2.1</span> Exact matching (exact)<a href="lalonde-dehejia-wahba-ldw-data.html#exact-matching-exact" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Strata = unique covariate profiles (raw covariates)</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-1" tabindex="-1"></a><span class="co"># match units exactly by raw covariate profiles </span></span>
<span id="cb94-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-2" tabindex="-1"></a>m.out.cps_plus.exact <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span>
<span id="cb94-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb94-3" tabindex="-1"></a>m.out.psid_plus.exact <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
</div>
<div id="coarsened-matching-cem" class="section level5 hasAnchor" number="2.3.1.2.2">
<h5><span class="header-section-number">2.3.1.2.2</span> Coarsened matching (cem)<a href="lalonde-dehejia-wahba-ldw-data.html#coarsened-matching-cem" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Strata = coarsened versions of covariates</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-1" tabindex="-1"></a><span class="co"># match units exactly within coarse strata </span></span>
<span id="cb95-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-2" tabindex="-1"></a>m.out.cps_plus.cem <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span>
<span id="cb95-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb95-3" tabindex="-1"></a>m.out.psid_plus.cem <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span></code></pre></div>
</div>
<div id="subclassification" class="section level5 hasAnchor" number="2.3.1.2.3">
<h5><span class="header-section-number">2.3.1.2.3</span> Subclassification<a href="lalonde-dehejia-wahba-ldw-data.html#subclassification" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Strata = bins of the propensity score</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-1" tabindex="-1"></a><span class="co"># partition sample into fixed number of bins based on propensity score </span></span>
<span id="cb96-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-2" tabindex="-1"></a>m.out.cps_plus.subcl <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">5</span>)</span>
<span id="cb96-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb96-3" tabindex="-1"></a>m.out.psid_plus.subcl <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">5</span>)</span></code></pre></div>
</div>
</div>
<div id="pure-subset-selection" class="section level4 hasAnchor" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> Pure subset selection<a href="lalonde-dehejia-wahba-ldw-data.html#pure-subset-selection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="cardinality-profile-matching" class="section level5 hasAnchor" number="2.3.1.3.1">
<h5><span class="header-section-number">2.3.1.3.1</span> Cardinality profile matching<a href="lalonde-dehejia-wahba-ldw-data.html#cardinality-profile-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-1" tabindex="-1"></a><span class="co"># select largest balanced subsample meeting covariate balance tolerances and a fixed ratio of controls to treated units</span></span>
<span id="cb97-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-2" tabindex="-1"></a>m.out.cps_plus.card <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>)</span>
<span id="cb97-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb97-3" tabindex="-1"></a>m.out.psid_plus.card <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="profile-matching" class="section level5 hasAnchor" number="2.3.1.3.2">
<h5><span class="header-section-number">2.3.1.3.2</span> Profile matching<a href="lalonde-dehejia-wahba-ldw-data.html#profile-matching" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-1" tabindex="-1"></a><span class="co"># select the largest control group subset balanced to the treated group (for ATT), leaving the treated group intact</span></span>
<span id="cb98-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-2" tabindex="-1"></a>m.out.cps_plus.profile <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">solver =</span> <span class="st">&quot;highs&quot;</span>)</span>
<span id="cb98-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb98-3" tabindex="-1"></a>m.out.psid_plus.profile <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">solver =</span> <span class="st">&quot;highs&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="weighting-2" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Weighting<a href="lalonde-dehejia-wahba-ldw-data.html#weighting-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The purpose of weighting is to reweight the units in order to create a synthetic population in which the distributions of covariates is balanced between treatment and control groups. In the following, several weighting methods are applied.</p>
<div id="inverse-probability-weights-ipw" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Inverse probability weights (IPW)<a href="lalonde-dehejia-wahba-ldw-data.html#inverse-probability-weights-ipw" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-1" tabindex="-1"></a><span class="co"># calculate inverse probability weights (IPW) for ATE by assigning weight = 1/PS to treated units and weight = 1/(1-PS) to untreated units</span></span>
<span id="cb99-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>ipw_weight <span class="ot">&lt;-</span> <span class="fu">create_iptw_weights</span>(ldw_cps_plus, treat, covar)</span>
<span id="cb99-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb99-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>ipw_weight <span class="ot">&lt;-</span> <span class="fu">create_iptw_weights</span>(ldw_psid_plus, treat, covar)</span></code></pre></div>
</div>
<div id="standardized-mortality-ratio-smr-treated-weights" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Standardized mortality ratio (SMR) treated weights<a href="lalonde-dehejia-wahba-ldw-data.html#standardized-mortality-ratio-smr-treated-weights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-1" tabindex="-1"></a><span class="co"># calculate weights for ATT by assigning weight = 1 to treated units and weight = PS/(1-PS) to control units</span></span>
<span id="cb100-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>smr_weight <span class="ot">&lt;-</span> <span class="fu">create_smr_weights</span>(ldw_cps_plus, treat, covar, <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb100-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb100-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>smr_weight <span class="ot">&lt;-</span> <span class="fu">create_smr_weights</span>(ldw_psid_plus, treat, covar, <span class="st">&quot;ATT&quot;</span>)</span></code></pre></div>
</div>
<div id="matching-weights" class="section level4 hasAnchor" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> Matching weights<a href="lalonde-dehejia-wahba-ldw-data.html#matching-weights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-1" tabindex="-1"></a><span class="co"># calculate matching weights by assigning weight = min(PS, 1-PS)/PS to treated units and min(PS, 1-PS)/(1-PS) to controls</span></span>
<span id="cb101-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>opt_weight <span class="ot">&lt;-</span> <span class="fu">create_matching_weights</span>(ldw_cps_plus, treat, covar)</span>
<span id="cb101-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb101-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>opt_weight <span class="ot">&lt;-</span> <span class="fu">create_matching_weights</span>(ldw_psid_plus, treat, covar)</span></code></pre></div>
</div>
<div id="overlap-weights" class="section level4 hasAnchor" number="2.3.2.4">
<h4><span class="header-section-number">2.3.2.4</span> Overlap weights<a href="lalonde-dehejia-wahba-ldw-data.html#overlap-weights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb102-1" tabindex="-1"></a><span class="co"># calculate overlap weights by assigning weight = 1-PS to treated units and weight = PS, emphasizing units with propensity scores near 0.5</span></span>
<span id="cb102-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb102-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>overlap_weight <span class="ot">&lt;-</span> <span class="fu">create_overlap_weights</span>(ldw_cps_plus, treat, covar)</span>
<span id="cb102-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb102-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>overlap_weight <span class="ot">&lt;-</span> <span class="fu">create_overlap_weights</span>(ldw_psid_plus, treat, covar)</span></code></pre></div>
</div>
<div id="entropy-weights" class="section level4 hasAnchor" number="2.3.2.5">
<h4><span class="header-section-number">2.3.2.5</span> Entropy weights<a href="lalonde-dehejia-wahba-ldw-data.html#entropy-weights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-1" tabindex="-1"></a><span class="co"># calculate entropy weights by assigning weight = -[PS × log(PS) + (1 − PS) × log(1 − PS)]/PS to treated units and -[PS × log(PS) + (1 − PS) × log(1 − PS)]/(1 − PS) to control units</span></span>
<span id="cb103-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>ebal_weight <span class="ot">&lt;-</span> <span class="fu">create_entropy_weights</span>(ldw_cps_plus, treat, covar)</span>
<span id="cb103-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb103-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>ebal_weight <span class="ot">&lt;-</span> <span class="fu">create_entropy_weights</span>(ldw_psid_plus, treat, covar)</span></code></pre></div>
</div>
</div>
</div>
<div id="improving-primarily-overlap" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Improving primarily overlap<a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-overlap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Truncation aims at limiting the influence of extreme weights by capping them at a specified threshold. This helps to reduce variance and improve the stability of causal effect estimates. In the following, several truncation methods are applied.</p>
<div id="truncation-2" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Truncation<a href="lalonde-dehejia-wahba-ldw-data.html#truncation-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-1" tabindex="-1"></a><span class="co"># list weight columns to apply truncation </span></span>
<span id="cb104-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb104-2" tabindex="-1"></a>weight_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ipw_weight&quot;</span>, <span class="st">&quot;smr_weight&quot;</span>, <span class="st">&quot;opt_weight&quot;</span>, <span class="st">&quot;overlap_weight&quot;</span>, <span class="st">&quot;ebal_weight&quot;</span>)</span></code></pre></div>
<div id="fixed-maximum-value-truncation" class="section level4 hasAnchor" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Fixed maximum value truncation<a href="lalonde-dehejia-wahba-ldw-data.html#fixed-maximum-value-truncation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-1" tabindex="-1"></a><span class="co"># truncate weights by imposing a minimum and maximum threshold</span></span>
<span id="cb105-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-2" tabindex="-1"></a>ldw_cps_plus.fixed <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb105-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb105-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.fixed)) {</span>
<span id="cb105-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-5" tabindex="-1"></a>    ldw_cps_plus.fixed <span class="ot">&lt;-</span> <span class="fu">truncate_weights_fixed</span>(ldw_cps_plus.fixed, <span class="at">weight_col =</span> wcol, <span class="at">lower =</span> <span class="fl">0.025</span>, <span class="at">upper =</span> <span class="fl">0.975</span>) </span>
<span id="cb105-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-6" tabindex="-1"></a>  }</span>
<span id="cb105-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-7" tabindex="-1"></a>}</span>
<span id="cb105-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-8" tabindex="-1"></a></span>
<span id="cb105-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-9" tabindex="-1"></a>ldw_psid_plus.fixed <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb105-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb105-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.fixed)) {</span>
<span id="cb105-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-12" tabindex="-1"></a>    ldw_psid_plus.fixed <span class="ot">&lt;-</span> <span class="fu">truncate_weights_fixed</span>(ldw_psid_plus.fixed, <span class="at">weight_col =</span> wcol, <span class="at">lower =</span> <span class="fl">0.025</span>, <span class="at">upper =</span> <span class="fl">0.975</span>)</span>
<span id="cb105-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-13" tabindex="-1"></a>  }</span>
<span id="cb105-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb105-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="at-percentile-truncation" class="section level4 hasAnchor" number="2.4.1.2">
<h4><span class="header-section-number">2.4.1.2</span> At percentile truncation<a href="lalonde-dehejia-wahba-ldw-data.html#at-percentile-truncation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-1" tabindex="-1"></a><span class="co"># truncate weights such that values below the 5th percentile and above the 95th percentile are capped</span></span>
<span id="cb106-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-2" tabindex="-1"></a>ldw_cps_plus.percent <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb106-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb106-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.percent)) {</span>
<span id="cb106-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-5" tabindex="-1"></a>    ldw_cps_plus.percent <span class="ot">&lt;-</span> <span class="fu">truncate_weights_percentile</span>(ldw_cps_plus.percent, <span class="at">weight_col =</span> wcol, <span class="at">lower =</span> <span class="fl">0.01</span>, <span class="at">upper =</span> <span class="fl">0.99</span>)</span>
<span id="cb106-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-6" tabindex="-1"></a>  }</span>
<span id="cb106-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-7" tabindex="-1"></a>}</span>
<span id="cb106-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-8" tabindex="-1"></a></span>
<span id="cb106-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-9" tabindex="-1"></a>ldw_psid_plus.percent <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb106-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb106-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.percent)) {</span>
<span id="cb106-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-12" tabindex="-1"></a>    ldw_psid_plus.percent <span class="ot">&lt;-</span> <span class="fu">truncate_weights_percentile</span>(ldw_psid_plus.percent, <span class="at">weight_col =</span> wcol, <span class="at">lower =</span> <span class="fl">0.01</span>, <span class="at">upper =</span> <span class="fl">0.99</span>)</span>
<span id="cb106-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-13" tabindex="-1"></a>  }</span>
<span id="cb106-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb106-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="adaptive-weight-truncation" class="section level4 hasAnchor" number="2.4.1.3">
<h4><span class="header-section-number">2.4.1.3</span> Adaptive weight truncation<a href="lalonde-dehejia-wahba-ldw-data.html#adaptive-weight-truncation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We first inspect the variance of the weights. If variance is zero, adaptive weight truncation is not meaningful.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-1" tabindex="-1"></a><span class="co"># inspect variance of weights</span></span>
<span id="cb107-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-2" tabindex="-1"></a>cps_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb107-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-3" tabindex="-1"></a>psid_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb107-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-4" tabindex="-1"></a></span>
<span id="cb107-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-5" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb107-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-6" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus)) {</span>
<span id="cb107-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-7" tabindex="-1"></a>    cps_results[[<span class="fu">paste0</span>(<span class="st">&quot;cps_&quot;</span>, wcol)]] <span class="ot">&lt;-</span> <span class="fu">check_weights</span>(ldw_cps_plus, wcol)</span>
<span id="cb107-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-8" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb107-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-9" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Column&quot;</span>, wcol, <span class="st">&quot;not found in ldw_cps_plus&quot;</span>))</span>
<span id="cb107-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-10" tabindex="-1"></a>  }</span>
<span id="cb107-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-11" tabindex="-1"></a>}</span>
<span id="cb107-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-12" tabindex="-1"></a></span>
<span id="cb107-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-13" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb107-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-14" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus)) {</span>
<span id="cb107-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-15" tabindex="-1"></a>    psid_results[[<span class="fu">paste0</span>(<span class="st">&quot;psid_&quot;</span>, wcol)]] <span class="ot">&lt;-</span> <span class="fu">check_weights</span>(ldw_psid_plus, wcol)</span>
<span id="cb107-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-16" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb107-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-17" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Column&quot;</span>, wcol, <span class="st">&quot;not found in ldw_psid_plus&quot;</span>))</span>
<span id="cb107-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-18" tabindex="-1"></a>  }</span>
<span id="cb107-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-19" tabindex="-1"></a>}</span>
<span id="cb107-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-20" tabindex="-1"></a></span>
<span id="cb107-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-21" tabindex="-1"></a>var_cps_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cps_results)</span>
<span id="cb107-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-22" tabindex="-1"></a>var_psid_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(psid_results)</span>
<span id="cb107-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-23" tabindex="-1"></a></span>
<span id="cb107-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb107-24" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(var_cps_table, <span class="at">caption =</span> <span class="st">&quot;Variance of Weights (CPS)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-97">Table 2.3: </span>Variance of Weights (CPS)</caption>
<thead>
<tr class="header">
<th align="left">Weight_Column</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ipw_weight</td>
<td align="right">338.9040468</td>
</tr>
<tr class="even">
<td align="left">smr_weight</td>
<td align="right">0.2216346</td>
</tr>
<tr class="odd">
<td align="left">opt_weight</td>
<td align="right">0.0206569</td>
</tr>
<tr class="even">
<td align="left">overlap_weight</td>
<td align="right">0.0111059</td>
</tr>
<tr class="odd">
<td align="left">ebal_weight</td>
<td align="right">0.1536573</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb108-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(var_psid_table, <span class="at">caption =</span> <span class="st">&quot;Variance of Weights (PSID)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-97">Table 2.3: </span>Variance of Weights (PSID)</caption>
<thead>
<tr class="header">
<th align="left">Weight_Column</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ipw_weight</td>
<td align="right">6.0921363</td>
</tr>
<tr class="even">
<td align="left">smr_weight</td>
<td align="right">1.6728072</td>
</tr>
<tr class="odd">
<td align="left">opt_weight</td>
<td align="right">0.0527586</td>
</tr>
<tr class="even">
<td align="left">overlap_weight</td>
<td align="right">0.0264972</td>
</tr>
<tr class="odd">
<td align="left">ebal_weight</td>
<td align="right">0.2945454</td>
</tr>
</tbody>
</table>
<p>Regarding above results, we apply adaptive weight truncation to all weights, where it may help mitigate the influence of extreme weights.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-1" tabindex="-1"></a><span class="co"># truncate adaptively at mean + 3 standard deviations </span></span>
<span id="cb109-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-2" tabindex="-1"></a>ldw_cps_plus.adapt <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb109-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb109-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.adapt)) {</span>
<span id="cb109-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-5" tabindex="-1"></a>    ldw_cps_plus.adapt <span class="ot">&lt;-</span> <span class="fu">truncate_weights_adaptive</span>(ldw_cps_plus.adapt, <span class="at">weight_col =</span> wcol, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb109-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-6" tabindex="-1"></a>  }</span>
<span id="cb109-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-7" tabindex="-1"></a>}</span>
<span id="cb109-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-8" tabindex="-1"></a></span>
<span id="cb109-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-9" tabindex="-1"></a>ldw_psid_plus.adapt <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb109-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb109-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.adapt)) {</span>
<span id="cb109-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-12" tabindex="-1"></a>    ldw_psid_plus.adapt <span class="ot">&lt;-</span> <span class="fu">truncate_weights_adaptive</span>(ldw_psid_plus.adapt, <span class="at">weight_col =</span> wcol, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb109-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-13" tabindex="-1"></a>  }</span>
<span id="cb109-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb109-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="trimming-2" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The purpose of trimming is to remove units whose propensity scores are too dissimilar from the opposite group, thereby improving covariate balance between treated and control groups. We employ several trimming methods below.</p>
<div id="propensity-score-threshold-trimming-similar-to-tutorial-by-imbens2024" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Propensity score threshold trimming (similar to tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)<a href="lalonde-dehejia-wahba-ldw-data.html#propensity-score-threshold-trimming-similar-to-tutorial-by-imbens2024" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-1" tabindex="-1"></a><span class="co"># apply trimming with thresholds 0.9 and 0.8 </span></span>
<span id="cb110-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-2" tabindex="-1"></a>ldw_cps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps_plus.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb110-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-3" tabindex="-1"></a>ldw_psid_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid_plus.ps, <span class="at">threshold =</span> <span class="fl">0.8</span>)</span>
<span id="cb110-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-4" tabindex="-1"></a></span>
<span id="cb110-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-5" tabindex="-1"></a><span class="co"># exclude experimental controls, subset trimmed data appropriately</span></span>
<span id="cb110-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-6" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb110-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-7" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb110-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-8" tabindex="-1"></a></span>
<span id="cb110-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-9" tabindex="-1"></a><span class="co"># re-assign treat variable for controls in sample 3 or 4 (non-treated group)</span></span>
<span id="cb110-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-10" tabindex="-1"></a>ldw_cps.trim_match<span class="sc">$</span>treat[ldw_cps.trim_match<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb110-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-11" tabindex="-1"></a>ldw_psid.trim_match<span class="sc">$</span>treat[ldw_psid.trim_match<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb110-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-12" tabindex="-1"></a></span>
<span id="cb110-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-13" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data and perform 1:1 matching</span></span>
<span id="cb110-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-14" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_cps.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb110-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb110-15" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_psid.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span></code></pre></div>
</div>
<div id="common-range-trimming" class="section level4 hasAnchor" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Common range trimming<a href="lalonde-dehejia-wahba-ldw-data.html#common-range-trimming" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-1" tabindex="-1"></a><span class="co"># trim observations outside the common support region of propensity scores</span></span>
<span id="cb111-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-2" tabindex="-1"></a>ldw_cps_plus.common   <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb111-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb111-3" tabindex="-1"></a>ldw_psid_plus.common  <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
<div id="propensity-score-trimming-crump" class="section level4 hasAnchor" number="2.4.2.3">
<h4><span class="header-section-number">2.4.2.3</span> Propensity score trimming (Crump)<a href="lalonde-dehejia-wahba-ldw-data.html#propensity-score-trimming-crump" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-1" tabindex="-1"></a><span class="co"># trim observations with propensity scores outside [0.1, 0.9] interval</span></span>
<span id="cb112-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-2" tabindex="-1"></a>ldw_cps_plus.crump  <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_cps_plus.ps, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fl">0.9</span>)</span>
<span id="cb112-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb112-3" tabindex="-1"></a>ldw_psid_plus.crump <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_psid_plus.ps, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fl">0.9</span>)</span></code></pre></div>
</div>
<div id="stuermer-trimming" class="section level4 hasAnchor" number="2.4.2.4">
<h4><span class="header-section-number">2.4.2.4</span> Stuermer trimming<a href="lalonde-dehejia-wahba-ldw-data.html#stuermer-trimming" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-1" tabindex="-1"></a><span class="co"># trim observations based on propensity score quantiles separately for treated and control</span></span>
<span id="cb113-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-2" tabindex="-1"></a>ldw_cps_plus.stuermer  <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb113-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb113-3" tabindex="-1"></a>ldw_psid_plus.stuermer <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
<div id="walker-trimming" class="section level4 hasAnchor" number="2.4.2.5">
<h4><span class="header-section-number">2.4.2.5</span> Walker trimming<a href="lalonde-dehejia-wahba-ldw-data.html#walker-trimming" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-1" tabindex="-1"></a><span class="co"># trim observations based on preference scores that adjust for treatment prevalence using logit transformations</span></span>
<span id="cb114-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-2" tabindex="-1"></a>ldw_cps_plus.walker   <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb114-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb114-3" tabindex="-1"></a>ldw_psid_plus.walker  <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
</div>
</div>
<div id="integrated-methods" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The purpose of combining trimming and weighting methods is to leverage the strengths of both approaches for causal effect estimation. Trimming enhances overlap and reduces the influence of outliers by excluding units with extreme or non-comparable propensity scores, while weighting further adjusts for remaining covariate imbalance among the retained units.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-1" tabindex="-1"></a><span class="co"># list trimming methods</span></span>
<span id="cb115-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-2" tabindex="-1"></a>trim_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ps_threshold&quot;</span>, <span class="st">&quot;common_range&quot;</span>, <span class="st">&quot;stuermer&quot;</span>, <span class="st">&quot;walker&quot;</span>, <span class="st">&quot;crump&quot;</span>)</span>
<span id="cb115-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-3" tabindex="-1"></a>trimmed_cps  <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold =</span> ldw_cps_trim, <span class="at">common_range =</span> ldw_cps_plus.common, <span class="at">stuermer =</span> ldw_cps_plus.stuermer, <span class="at">walker =</span> ldw_cps_plus.walker, <span class="at">crump =</span> ldw_cps_plus.crump)</span>
<span id="cb115-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb115-4" tabindex="-1"></a>trimmed_psid <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold =</span> ldw_psid_trim, <span class="at">common_range =</span> ldw_psid_plus.common, <span class="at">stuermer =</span> ldw_psid_plus.stuermer, <span class="at">walker =</span> ldw_psid_plus.walker, <span class="at">crump =</span> ldw_psid_plus.crump)</span></code></pre></div>
<div id="ipw-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="section level4 hasAnchor" number="2.5.0.1">
<h4><span class="header-section-number">2.5.0.1</span> IPW with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data.html#ipw-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-1" tabindex="-1"></a><span class="co"># apply inverse probability weighting (IPW) with trimming and attach IPW weights</span></span>
<span id="cb116-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-2" tabindex="-1"></a>ipw_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb116-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;ipw_weight&quot;</span>)),</span>
<span id="cb116-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-4" tabindex="-1"></a>  trim_names</span>
<span id="cb116-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-5" tabindex="-1"></a>)</span>
<span id="cb116-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-6" tabindex="-1"></a>ipw_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb116-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;ipw_weight&quot;</span>)),</span>
<span id="cb116-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-8" tabindex="-1"></a>  trim_names</span>
<span id="cb116-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb116-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="smr-treated-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="section level4 hasAnchor" number="2.5.0.2">
<h4><span class="header-section-number">2.5.0.2</span> SMR treated weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data.html#smr-treated-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-1" tabindex="-1"></a><span class="co"># apply standardized mortality ratio (SMR) weighting with trimming and attach SMR weights</span></span>
<span id="cb117-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-2" tabindex="-1"></a>smr_treat_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb117-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;smr_weight&quot;</span>)),</span>
<span id="cb117-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-4" tabindex="-1"></a>  trim_names</span>
<span id="cb117-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-5" tabindex="-1"></a>)</span>
<span id="cb117-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-6" tabindex="-1"></a>smr_treat_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb117-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;smr_weight&quot;</span>)),</span>
<span id="cb117-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-8" tabindex="-1"></a>  trim_names</span>
<span id="cb117-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb117-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="overlap-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="section level4 hasAnchor" number="2.5.0.3">
<h4><span class="header-section-number">2.5.0.3</span> Overlap weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data.html#overlap-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-1" tabindex="-1"></a><span class="co"># apply overlap weighting with trimming and attach overlap weights</span></span>
<span id="cb118-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-2" tabindex="-1"></a>ov_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb118-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;overlap_weight&quot;</span>)),</span>
<span id="cb118-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-4" tabindex="-1"></a>  trim_names</span>
<span id="cb118-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-5" tabindex="-1"></a>)</span>
<span id="cb118-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-6" tabindex="-1"></a>ov_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb118-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;overlap_weight&quot;</span>)),</span>
<span id="cb118-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-8" tabindex="-1"></a>  trim_names</span>
<span id="cb118-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb118-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="entropy-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="section level4 hasAnchor" number="2.5.0.4">
<h4><span class="header-section-number">2.5.0.4</span> Entropy weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data.html#entropy-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-1" tabindex="-1"></a><span class="co"># apply entropy balancing weights with trimming and attach entropy weights</span></span>
<span id="cb119-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-2" tabindex="-1"></a>entropy_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb119-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;ebal_weight&quot;</span>)),</span>
<span id="cb119-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-4" tabindex="-1"></a>  trim_names</span>
<span id="cb119-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-5" tabindex="-1"></a>)</span>
<span id="cb119-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-6" tabindex="-1"></a>entropy_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb119-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;ebal_weight&quot;</span>)),</span>
<span id="cb119-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-8" tabindex="-1"></a>  trim_names</span>
<span id="cb119-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb119-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="reassessing-methods-1" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Reassessing methods<a href="lalonde-dehejia-wahba-ldw-data.html#reassessing-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now systematically reassess all methods described above by evaluating covariate balance and sample representativeness. Specifically, we examine SMDs and ESS for each approach and use visual diagnostics—such as love plots and histograms—to assess covariate balance and overlap between treated and control groups.</p>
<div id="matching-3" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Matching<a href="lalonde-dehejia-wahba-ldw-data.html#matching-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-1" tabindex="-1"></a><span class="co"># list all matching methods</span></span>
<span id="cb120-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-2" tabindex="-1"></a>methods.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb120-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-3" tabindex="-1"></a>  <span class="at">nn =</span> m.out.cps_plus.nearest,</span>
<span id="cb120-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-4" tabindex="-1"></a>  <span class="at">k2 =</span> m.out.cps_plus.k2,</span>
<span id="cb120-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-5" tabindex="-1"></a>  <span class="at">k3 =</span> m.out.cps_plus.k3,</span>
<span id="cb120-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-6" tabindex="-1"></a>  <span class="at">caliper =</span> m.out.cps_plus.caliper,</span>
<span id="cb120-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-7" tabindex="-1"></a>  <span class="at">cS =</span> m.out.cps_plus.cs,</span>
<span id="cb120-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-8" tabindex="-1"></a>  <span class="at">mahvars =</span> m.out.cps_plus.mahvars,</span>
<span id="cb120-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-9" tabindex="-1"></a>  <span class="at">optimal_pair =</span> m.out.cps_plus.optimal_pair,</span>
<span id="cb120-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-10" tabindex="-1"></a>  <span class="at">optimal_full =</span> m.out.cps_plus.optimal_full,</span>
<span id="cb120-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-11" tabindex="-1"></a>  <span class="at">gen_full =</span> m.out.cps_plus.general_full,</span>
<span id="cb120-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-12" tabindex="-1"></a>  <span class="at">genetic =</span> m.out.cps_plus.genetic,</span>
<span id="cb120-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-13" tabindex="-1"></a>  <span class="at">exact =</span> m.out.cps_plus.exact,</span>
<span id="cb120-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-14" tabindex="-1"></a>  <span class="at">cem =</span> m.out.cps_plus.cem,</span>
<span id="cb120-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-15" tabindex="-1"></a>  <span class="at">card =</span> m.out.cps_plus.card,</span>
<span id="cb120-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-16" tabindex="-1"></a>  <span class="at">profile =</span> m.out.cps_plus.profile,</span>
<span id="cb120-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-17" tabindex="-1"></a>  <span class="at">subcl =</span> m.out.cps_plus.subcl</span>
<span id="cb120-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-18" tabindex="-1"></a>)</span>
<span id="cb120-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-19" tabindex="-1"></a></span>
<span id="cb120-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-20" tabindex="-1"></a>methods.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb120-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-21" tabindex="-1"></a>  <span class="at">nn =</span> m.out.psid_plus.nearest,</span>
<span id="cb120-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-22" tabindex="-1"></a>  <span class="at">k2 =</span> m.out.psid_plus.k2,</span>
<span id="cb120-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-23" tabindex="-1"></a>  <span class="at">k3 =</span> m.out.psid_plus.k3,</span>
<span id="cb120-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-24" tabindex="-1"></a>  <span class="at">caliper =</span> m.out.psid_plus.caliper,</span>
<span id="cb120-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-25" tabindex="-1"></a>  <span class="at">cs =</span> m.out.psid_plus.cs,</span>
<span id="cb120-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-26" tabindex="-1"></a>  <span class="at">mahvars =</span> m.out.psid_plus.mahvars,</span>
<span id="cb120-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-27" tabindex="-1"></a>  <span class="at">optimal_pair =</span> m.out.psid_plus.optimal_pair,</span>
<span id="cb120-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-28" tabindex="-1"></a>  <span class="at">optimal_full =</span> m.out.psid_plus.optimal_full,</span>
<span id="cb120-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-29" tabindex="-1"></a>  <span class="at">gen_full =</span> m.out.psid_plus.general_full,</span>
<span id="cb120-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-30" tabindex="-1"></a>  <span class="at">genetic =</span> m.out.psid_plus.genetic,</span>
<span id="cb120-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-31" tabindex="-1"></a>  <span class="at">exact =</span> m.out.psid_plus.exact,</span>
<span id="cb120-32"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-32" tabindex="-1"></a>  <span class="at">cem =</span> m.out.psid_plus.cem,</span>
<span id="cb120-33"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-33" tabindex="-1"></a>  <span class="at">card =</span> m.out.psid_plus.card,</span>
<span id="cb120-34"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-34" tabindex="-1"></a>  <span class="at">profile =</span> m.out.psid_plus.profile,</span>
<span id="cb120-35"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-35" tabindex="-1"></a>  <span class="at">subcl =</span> m.out.psid_plus.subcl</span>
<span id="cb120-36"><a href="lalonde-dehejia-wahba-ldw-data.html#cb120-36" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-1" tabindex="-1"></a><span class="co"># calculate balance statistics </span></span>
<span id="cb121-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-2" tabindex="-1"></a>bal.cps_plus <span class="ot">&lt;-</span> cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">weights =</span> methods.cps_plus, <span class="at">s.d.denom =</span> <span class="st">&quot;treated&quot;</span>)</span>
<span id="cb121-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb121-3" tabindex="-1"></a>bal.psid_plus <span class="ot">&lt;-</span> cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">weights =</span> methods.psid_plus, <span class="at">s.d.denom =</span> <span class="st">&quot;treated&quot;</span>)</span></code></pre></div>
<div id="smd" class="section level4 hasAnchor" number="2.6.1.1">
<h4><span class="header-section-number">2.6.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb122-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-2" tabindex="-1"></a>smd_matchit.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(methods.cps_plus)</span>
<span id="cb122-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb122-3" tabindex="-1"></a>smd_matchit.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(methods.psid_plus)</span></code></pre></div>
</div>
<div id="ess" class="section level4 hasAnchor" number="2.6.1.2">
<h4><span class="header-section-number">2.6.1.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data.html#ess" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb123-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-2" tabindex="-1"></a>ess_matchit.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_matchit</span>(bal.cps_plus)</span>
<span id="cb123-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb123-3" tabindex="-1"></a>ess_matchit.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_matchit</span>(bal.psid_plus)</span></code></pre></div>
</div>
<div id="visuals" class="section level4 hasAnchor" number="2.6.1.3">
<h4><span class="header-section-number">2.6.1.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data.html#visuals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-1" tabindex="-1"></a><span class="co"># visualize covariate balance </span></span>
<span id="cb124-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb124-2" tabindex="-1"></a><span class="fu">plot_matchit</span>(methods.cps_plus, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-1.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.10: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-2.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.11: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-3.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.12: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-4.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.13: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-5.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.14: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-6.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.15: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-7.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.16: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-8.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.17: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-9.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.18: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-10.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.19: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-11.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.20: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-12.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.21: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-13.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.22: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-14.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.23: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-15.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.24: FIGURE A3.
</p>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb125-1" tabindex="-1"></a><span class="fu">plot_matchit</span>(methods.psid_plus, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-16.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.25: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-17.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.26: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-18.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.27: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-19.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.28: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-20.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.29: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-21.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.30: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-22.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.31: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-23.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.32: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-24.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.33: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-25.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.34: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-26.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.35: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-27.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.36: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-28.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.37: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-29.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.38: FIGURE A3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-113-30.png" alt="FIGURE A3." width="672" />
<p class="caption">
Figure 2.39: FIGURE A3.
</p>
</div>
</div>
</div>
<div id="weighting-3" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Weighting<a href="lalonde-dehejia-wahba-ldw-data.html#weighting-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-1" tabindex="-1"></a><span class="co"># list all weights</span></span>
<span id="cb126-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-2" tabindex="-1"></a>weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb126-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-3" tabindex="-1"></a>  <span class="at">ipw =</span> ldw_cps_plus<span class="sc">$</span>ipw_weight,</span>
<span id="cb126-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-4" tabindex="-1"></a>  <span class="at">smr_tr =</span> ldw_cps_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb126-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-5" tabindex="-1"></a>  <span class="at">mw =</span> ldw_cps_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb126-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-6" tabindex="-1"></a>  <span class="at">ow =</span> ldw_cps_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb126-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-7" tabindex="-1"></a>  <span class="at">ew =</span> ldw_cps_plus<span class="sc">$</span>ebal_weight</span>
<span id="cb126-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-8" tabindex="-1"></a>)</span>
<span id="cb126-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-9" tabindex="-1"></a></span>
<span id="cb126-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-10" tabindex="-1"></a>weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb126-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-11" tabindex="-1"></a>  <span class="at">ipw =</span> ldw_psid_plus<span class="sc">$</span>ipw_weight,</span>
<span id="cb126-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-12" tabindex="-1"></a>  <span class="at">smr_tr =</span> ldw_psid_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb126-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-13" tabindex="-1"></a>  <span class="at">mw =</span> ldw_psid_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb126-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-14" tabindex="-1"></a>  <span class="at">ow =</span> ldw_psid_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb126-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-15" tabindex="-1"></a>  <span class="at">ew =</span> ldw_psid_plus<span class="sc">$</span>ebal_weight</span>
<span id="cb126-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb126-16" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-1" class="section level4 hasAnchor" number="2.6.2.1">
<h4><span class="header-section-number">2.6.2.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb127-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb127-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb127-2" tabindex="-1"></a>smd_weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_weight</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb127-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb127-3" tabindex="-1"></a>smd_weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_weight</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="ess-1" class="section level4 hasAnchor" number="2.6.2.2">
<h4><span class="header-section-number">2.6.2.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data.html#ess-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb128-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-2" tabindex="-1"></a>ess_weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_weight</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb128-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb128-3" tabindex="-1"></a>ess_weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_weight</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="visuals-1" class="section level4 hasAnchor" number="2.6.2.3">
<h4><span class="header-section-number">2.6.2.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data.html#visuals-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb129-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb129-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb129-2" tabindex="-1"></a><span class="fu">plot_weighting_methods</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight.cps_plus, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-1.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.40: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-2.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.41: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-3.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.42: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-4.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.43: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-5.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.44: FIGURE A4.
</p>
</div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb130-1" tabindex="-1"></a><span class="fu">plot_weighting_methods</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight.psid_plus, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-6.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.45: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-7.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.46: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-8.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.47: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-9.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.48: FIGURE A4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-117-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-117-10.png" alt="FIGURE A4." width="672" />
<p class="caption">
Figure 2.49: FIGURE A4.
</p>
</div>
</div>
</div>
<div id="truncation-3" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Truncation<a href="lalonde-dehejia-wahba-ldw-data.html#truncation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-1" tabindex="-1"></a><span class="co"># list truncation methods</span></span>
<span id="cb131-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-2" tabindex="-1"></a>trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-3" tabindex="-1"></a>  <span class="at">fix_max_value_trunc.cps_plus =</span> ldw_cps_plus.fixed,</span>
<span id="cb131-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-4" tabindex="-1"></a>  <span class="at">at_perc_trunc.cps_plus =</span> ldw_cps_plus.percent,</span>
<span id="cb131-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-5" tabindex="-1"></a>  <span class="at">adap_weight_trunc.cps_plus =</span> ldw_cps_plus.adapt</span>
<span id="cb131-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-6" tabindex="-1"></a>)</span>
<span id="cb131-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-7" tabindex="-1"></a></span>
<span id="cb131-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-8" tabindex="-1"></a>trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-9" tabindex="-1"></a>  <span class="at">fix_max_value_trunc.psid_plus =</span> ldw_psid_plus.fixed,</span>
<span id="cb131-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-10" tabindex="-1"></a>  <span class="at">at_perc_trunc.psid_plus =</span> ldw_psid_plus.percent,</span>
<span id="cb131-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-11" tabindex="-1"></a>  <span class="at">adap_weight_trunc.psid_plus =</span> ldw_psid_plus.adapt</span>
<span id="cb131-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb131-12" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-2" class="section level4 hasAnchor" number="2.6.3.1">
<h4><span class="header-section-number">2.6.3.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb132-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb132-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb132-2" tabindex="-1"></a>smd_trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trunc</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb132-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb132-3" tabindex="-1"></a>smd_trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trunc</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="ess-2" class="section level4 hasAnchor" number="2.6.3.2">
<h4><span class="header-section-number">2.6.3.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data.html#ess-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb133-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb133-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb133-2" tabindex="-1"></a>ess_trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trunc</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb133-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb133-3" tabindex="-1"></a>ess_trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trunc</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="visuals-2" class="section level4 hasAnchor" number="2.6.3.3">
<h4><span class="header-section-number">2.6.3.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data.html#visuals-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb134-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb134-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb134-2" tabindex="-1"></a><span class="fu">plot_trunc_methods</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-1.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.50: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-2.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.51: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-3.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.52: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-4.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.53: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-5.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.54: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-6.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.55: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-7.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.56: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-8.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.57: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-9.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.58: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-10.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.59: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-11.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.60: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-12.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.61: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-13.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.62: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-14.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.63: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-15.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.64: FIGURE A5.
</p>
</div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb135-1" tabindex="-1"></a><span class="fu">plot_trunc_methods</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-16.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.65: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-17.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.66: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-18.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.67: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-19.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.68: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-20.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.69: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-21.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.70: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-22.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.71: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-23.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.72: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-24.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.73: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-25.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.74: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-26.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.75: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-27.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.76: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-28.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.77: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-29.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.78: FIGURE A5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-121-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-121-30.png" alt="FIGURE A5." width="672" />
<p class="caption">
Figure 2.79: FIGURE A5.
</p>
</div>
</div>
</div>
<div id="trimming-3" class="section level3 hasAnchor" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data.html#trimming-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-1" tabindex="-1"></a><span class="co"># list trimming objects</span></span>
<span id="cb136-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-2" tabindex="-1"></a>trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb136-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-3" tabindex="-1"></a>  <span class="at">original =</span> ldw_cps_plus,  </span>
<span id="cb136-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-4" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_cps.trim_match,  </span>
<span id="cb136-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-5" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_cps_plus.common,      </span>
<span id="cb136-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-6" tabindex="-1"></a>  <span class="at">crump =</span> ldw_cps_plus.crump,      </span>
<span id="cb136-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-7" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_cps_plus.stuermer,     </span>
<span id="cb136-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-8" tabindex="-1"></a>  <span class="at">walker =</span> ldw_cps_plus.walker    </span>
<span id="cb136-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-9" tabindex="-1"></a>)</span>
<span id="cb136-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-10" tabindex="-1"></a></span>
<span id="cb136-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-11" tabindex="-1"></a>trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb136-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-12" tabindex="-1"></a>  <span class="at">original =</span> ldw_psid_plus,</span>
<span id="cb136-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-13" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_psid.trim_match,</span>
<span id="cb136-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-14" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_psid_plus.common,</span>
<span id="cb136-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-15" tabindex="-1"></a>  <span class="at">crump =</span> ldw_psid_plus.crump,</span>
<span id="cb136-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-16" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_psid_plus.stuermer,</span>
<span id="cb136-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-17" tabindex="-1"></a>  <span class="at">walker =</span> ldw_psid_plus.walker</span>
<span id="cb136-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb136-18" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-3" class="section level4 hasAnchor" number="2.6.4.1">
<h4><span class="header-section-number">2.6.4.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb137-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-2" tabindex="-1"></a>smd_trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb137-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb137-3" tabindex="-1"></a>smd_trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ess-3" class="section level4 hasAnchor" number="2.6.4.2">
<h4><span class="header-section-number">2.6.4.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data.html#ess-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb138-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-2" tabindex="-1"></a>ess_trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trim</span>(trim.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb138-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb138-3" tabindex="-1"></a>ess_trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trim</span>(trim.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="visuals-3" class="section level4 hasAnchor" number="2.6.4.3">
<h4><span class="header-section-number">2.6.4.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data.html#visuals-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-1" tabindex="-1"></a><span class="co"># visualize overlap</span></span>
<span id="cb139-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb139-2" tabindex="-1"></a><span class="fu">plot_trim</span>(trim.cps_plus, treat, covar)</span></code></pre></div>
<pre><code>## -16.1181 3.63151</code></pre>
<pre><code>## -1.249971 1.185584</code></pre>
<pre><code>## -10.8512 3.856394</code></pre>
<pre><code>## -2.516886 2.358809</code></pre>
<pre><code>## -6.937733 -2.088278</code></pre>
<pre><code>## -8.995388 -2.067383</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-125-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-125-1.png" alt="FIGURE A6." width="672" />
<p class="caption">
Figure 2.80: FIGURE A6.
</p>
</div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb146-1" tabindex="-1"></a><span class="fu">plot_trim</span>(trim.psid_plus, treat, covar)</span></code></pre></div>
<pre><code>## -16.1181 7.271394</code></pre>
<pre><code>## -0.8915464 0.439935</code></pre>
<pre><code>## -4.792402 4.068605</code></pre>
<pre><code>## -1.685302 2.932933</code></pre>
<pre><code>## -3.370286 -1.389719</code></pre>
<pre><code>## -3.511349 -0.6656006</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-125-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-125-2.png" alt="FIGURE A6." width="672" />
<p class="caption">
Figure 2.81: FIGURE A6.
</p>
</div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb153-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb153-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb153-2" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps.trim_match, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - propensity threshold trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-1.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.82: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb154-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps_plus.common, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - common range trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-2.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.83: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb155-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps_plus.crump,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - crump trimming&quot;</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-3.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.84: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb156-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps_plus.stuermer, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - stuermer trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-4.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.85: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb157-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps_plus.walker,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - walker trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-5.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.86: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb158-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid.trim_match, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - propensity threshold trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-6.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.87: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb159-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid_plus.common, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - common range trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-7.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.88: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb160-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid_plus.crump, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - crump trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-8.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.89: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb161-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid_plus.stuermer, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - stuermer trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-9.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.90: FIGURE A7.
</p>
</div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb162-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid_plus.walker,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - walker trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-126-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-126-10.png" alt="FIGURE A7." width="672" />
<p class="caption">
Figure 2.91: FIGURE A7.
</p>
</div>
</div>
</div>
</div>
<div id="integrated-methods-1" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-1" tabindex="-1"></a><span class="co"># list all combined method results</span></span>
<span id="cb163-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-2" tabindex="-1"></a>comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb163-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-3" tabindex="-1"></a>  <span class="at">ipw =</span> ipw_comb.cps_plus,</span>
<span id="cb163-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-4" tabindex="-1"></a>  <span class="at">smr_treated =</span> smr_treat_comb.cps_plus,</span>
<span id="cb163-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-5" tabindex="-1"></a>  <span class="at">overlap =</span> ov_comb.cps_plus,</span>
<span id="cb163-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-6" tabindex="-1"></a>  <span class="at">entropy =</span> entropy_comb.cps_plus</span>
<span id="cb163-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-7" tabindex="-1"></a>)</span>
<span id="cb163-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-8" tabindex="-1"></a></span>
<span id="cb163-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-9" tabindex="-1"></a>comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb163-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-10" tabindex="-1"></a>  <span class="at">ipw =</span> ipw_comb.psid_plus,</span>
<span id="cb163-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-11" tabindex="-1"></a>  <span class="at">smr_treated =</span> smr_treat_comb.psid_plus,</span>
<span id="cb163-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-12" tabindex="-1"></a>  <span class="at">overlap =</span> ov_comb.psid_plus,</span>
<span id="cb163-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-13" tabindex="-1"></a>  <span class="at">entropy =</span> entropy_comb.psid_plus</span>
<span id="cb163-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb163-14" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-4" class="section level4 hasAnchor" number="2.7.0.1">
<h4><span class="header-section-number">2.7.0.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data.html#smd-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb164-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb164-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb164-2" tabindex="-1"></a>smd_all_comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_smd_all_datasets</span>(comb_meth.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb164-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb164-3" tabindex="-1"></a>smd_all_comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_smd_all_datasets</span>(comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ess-4" class="section level4 hasAnchor" number="2.7.0.2">
<h4><span class="header-section-number">2.7.0.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data.html#ess-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb165-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb165-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb165-2" tabindex="-1"></a>ess_all_comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_all_datasets</span>(comb_meth.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb165-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb165-3" tabindex="-1"></a>ess_all_comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_all_datasets</span>(comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="visuals-4" class="section level4 hasAnchor" number="2.7.0.3">
<h4><span class="header-section-number">2.7.0.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data.html#visuals-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb166-1" tabindex="-1"></a><span class="co"># visualize overlap</span></span>
<span id="cb166-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb166-2" tabindex="-1"></a><span class="fu">plot_comb_overlap</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix_cps =</span> <span class="st">&quot;LDW-CPS1&quot;</span>, <span class="at">prefix_psid =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<pre><code>## -16.1181 2.629308</code></pre>
<pre><code>## -11.64605 3.692112</code></pre>
<pre><code>## -8.042516 -2.117255</code></pre>
<pre><code>## -16.1181 -2.24017</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-1.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.92: FIGURE A8.
</p>
</div>
<pre><code>## -2.44024 2.290448</code></pre>
<pre><code>## -16.1181 2.629308</code></pre>
<pre><code>## -11.64605 3.692112</code></pre>
<pre><code>## -8.042516 -2.117255</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-2.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.93: FIGURE A8.
</p>
</div>
<pre><code>## -16.1181 -2.24017</code></pre>
<pre><code>## -2.44024 2.290448</code></pre>
<pre><code>## -16.1181 2.629308</code></pre>
<pre><code>## -11.64605 3.692112</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-3.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.94: FIGURE A8.
</p>
</div>
<pre><code>## -8.042516 -2.117255</code></pre>
<pre><code>## -16.1181 -2.24017</code></pre>
<pre><code>## -2.44024 2.290448</code></pre>
<pre><code>## -16.1181 2.629308</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-4.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.95: FIGURE A8.
</p>
</div>
<pre><code>## -11.64605 3.692112</code></pre>
<pre><code>## -8.042516 -2.117255</code></pre>
<pre><code>## -16.1181 -2.24017</code></pre>
<pre><code>## -2.44024 2.290448</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-5.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.96: FIGURE A8.
</p>
</div>
<pre><code>## -16.1181 1.120412</code></pre>
<pre><code>## -4.466055 4.051763</code></pre>
<pre><code>## -3.41373 -1.35641</code></pre>
<pre><code>## -3.581103 -0.7108581</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-6.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.97: FIGURE A8.
</p>
</div>
<pre><code>## -1.693687 2.928433</code></pre>
<pre><code>## -16.1181 1.120412</code></pre>
<pre><code>## -4.466055 4.051763</code></pre>
<pre><code>## -3.41373 -1.35641</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-7.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.98: FIGURE A8.
</p>
</div>
<pre><code>## -3.581103 -0.7108581</code></pre>
<pre><code>## -1.693687 2.928433</code></pre>
<pre><code>## -16.1181 1.120412</code></pre>
<pre><code>## -4.466055 4.051763</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-8.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.99: FIGURE A8.
</p>
</div>
<pre><code>## -3.41373 -1.35641</code></pre>
<pre><code>## -3.581103 -0.7108581</code></pre>
<pre><code>## -1.693687 2.928433</code></pre>
<pre><code>## -16.1181 1.120412</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-9.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.100: FIGURE A8.
</p>
</div>
<pre><code>## -4.466055 4.051763</code></pre>
<pre><code>## -3.41373 -1.35641</code></pre>
<pre><code>## -3.581103 -0.7108581</code></pre>
<pre><code>## -1.693687 2.928433</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-130-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-130-10.png" alt="FIGURE A8." width="672" />
<p class="caption">
Figure 2.101: FIGURE A8.
</p>
</div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb207-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb207-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb207-2" tabindex="-1"></a><span class="fu">plot_comb_love_plots</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix_cps =</span> <span class="st">&quot;LDW-CPS1&quot;</span>, <span class="at">prefix_psid =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-1.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.102: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-2.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.103: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-3.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.104: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-4.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.105: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-5.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.106: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-6.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.107: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-7.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.108: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-8.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.109: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-9.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.110: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-10.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.111: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-11.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.112: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-12.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.113: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-13.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.114: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-14.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.115: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-15.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.116: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-16.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.117: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-17.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.118: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-18.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.119: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-19.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.120: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-20.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.121: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-21.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.122: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-22.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.123: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-23.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.124: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-24.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.125: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-25.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.126: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-26.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.127: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-27.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.128: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-28.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.129: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-29.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.130: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-30.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.131: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-31"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-31.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.132: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-32"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-32.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.133: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-33"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-33.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.134: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-34"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-34.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.135: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-35"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-35.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.136: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-36"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-36.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.137: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-37"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-37.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.138: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-38"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-38.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.139: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-39"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-39.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.140: FIGURE A9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131-40"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-131-40.png" alt="FIGURE A9." width="672" />
<p class="caption">
Figure 2.141: FIGURE A9.
</p>
</div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb208-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb208-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb208-2" tabindex="-1"></a><span class="fu">save_comb_hist</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix =</span> <span class="st">&quot;model_a&quot;</span>)</span>
<span id="cb208-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb208-3" tabindex="-1"></a><span class="fu">save_comb_loveplots</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix =</span> <span class="st">&quot;model_a&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="top-methods-and-datasets" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Top methods and datasets<a href="lalonde-dehejia-wahba-ldw-data.html#top-methods-and-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To identify the top five methods for each observational dataset, we first combine all results for SMDs and ESS into a single data frame for each dataset. This allows for a comprehensive comparison across all methods.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb209-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb209-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb209-2" tabindex="-1"></a>all_cps_plus <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;cps_plus&quot;</span>)</span>
<span id="cb209-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb209-3" tabindex="-1"></a>all_psid_plus <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;psid_plus&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb210-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb210-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb210-2" tabindex="-1"></a><span class="fu">save_csv</span>(all_cps_plus, <span class="st">&quot;CPS1_PLUS_all_results_model_a&quot;</span>)</span>
<span id="cb210-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb210-3" tabindex="-1"></a><span class="fu">save_csv</span>(all_psid_plus, <span class="st">&quot;PSID1_PLUS_all_results_model_a&quot;</span>)</span></code></pre></div>
<p>Next, we evaluate each method by constructing a final score that is build on two separate scores equally weighted:
- <code>smd_score</code> rescales the mean absolute SMD to a 0-1 range, where a lower value leads to a higher score
- <code>ess_score</code> measures sample size effectiveness by combining ESS of treated and control groups and normalizing between 0 and 1.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb211-1" tabindex="-1"></a>ranked_cps_plus  <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_cps_plus)</span>
<span id="cb211-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb211-2" tabindex="-1"></a>ranked_psid_plus <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_psid_plus)</span></code></pre></div>
<p>Based on the final scores, we rank all methods and select the top five for each dataset.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-1" tabindex="-1"></a><span class="co"># get top 5 methods </span></span>
<span id="cb212-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-2" tabindex="-1"></a>top5_methods.cps_plus <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_cps_plus, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb212-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-3" tabindex="-1"></a>top5_methods.psid_plus <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_psid_plus, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb212-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-4" tabindex="-1"></a></span>
<span id="cb212-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-5" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb212-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-6" tabindex="-1"></a>top5_methods_df.cps_plus <span class="ot">&lt;-</span> ranked_cps_plus <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb212-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-7" tabindex="-1"></a>top5_methods_df.psid_plus <span class="ot">&lt;-</span> ranked_psid_plus <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb212-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb212-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top5_methods_df.cps_plus, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for CPS1-PLUS&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-136">Table 2.4: </span>Top 5 Methods for CPS1-PLUS</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">card</td>
<td align="right">0.7380670</td>
</tr>
<tr class="even">
<td align="left">mahvars</td>
<td align="right">0.7372034</td>
</tr>
<tr class="odd">
<td align="left">ps_threshold</td>
<td align="right">0.7039160</td>
</tr>
<tr class="even">
<td align="left">adap_weight_trunc_smr_weight</td>
<td align="right">0.6951847</td>
</tr>
<tr class="odd">
<td align="left">optimal_pair</td>
<td align="right">0.6892030</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb213-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top5_methods_df.psid_plus, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for PSID1-PLUS&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-136">Table 2.4: </span>Top 5 Methods for PSID1-PLUS</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">card</td>
<td align="right">0.7584618</td>
</tr>
<tr class="even">
<td align="left">mahvars</td>
<td align="right">0.7508530</td>
</tr>
<tr class="odd">
<td align="left">ps_threshold</td>
<td align="right">0.7299305</td>
</tr>
<tr class="even">
<td align="left">smr_treated_ps_threshold</td>
<td align="right">0.7184633</td>
</tr>
<tr class="odd">
<td align="left">overlap_crump</td>
<td align="right">0.7102917</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb214-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb214-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb214-2" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.cps_plus, <span class="st">&quot;CPS1_PLUS_top5_methods_model_a&quot;</span>)</span>
<span id="cb214-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb214-3" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.psid_plus, <span class="st">&quot;PSID1_PLUS_top5_methods_model_a&quot;</span>)</span></code></pre></div>
<p>For estimation, we match the selected top method names back to their corresponding datasets, objects or vectors and construct final datasets.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-1" tabindex="-1"></a>dataset_list_cps <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb215-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-2" tabindex="-1"></a>  <span class="st">&quot;All&quot;</span> <span class="ot">=</span> ldw_cps_plus,</span>
<span id="cb215-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-3" tabindex="-1"></a>  <span class="st">&quot;original&quot;</span> <span class="ot">=</span> ldw_cps_plus,</span>
<span id="cb215-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-4" tabindex="-1"></a>  <span class="st">&quot;nn&quot;</span> <span class="ot">=</span> m.out.cps_plus.nearest, </span>
<span id="cb215-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-5" tabindex="-1"></a>  <span class="st">&quot;caliper&quot;</span> <span class="ot">=</span> m.out.cps_plus.caliper,</span>
<span id="cb215-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-6" tabindex="-1"></a>  <span class="st">&quot;card&quot;</span> <span class="ot">=</span> m.out.cps_plus.card,</span>
<span id="cb215-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-7" tabindex="-1"></a>  <span class="st">&quot;cem&quot;</span> <span class="ot">=</span> m.out.cps_plus.cem,</span>
<span id="cb215-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-8" tabindex="-1"></a>  <span class="st">&quot;cS&quot;</span> <span class="ot">=</span> m.out.cps_plus.cs,</span>
<span id="cb215-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-9" tabindex="-1"></a>  <span class="st">&quot;k2&quot;</span>  <span class="ot">=</span> m.out.cps_plus.k2,</span>
<span id="cb215-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-10" tabindex="-1"></a>  <span class="st">&quot;k3&quot;</span> <span class="ot">=</span> m.out.cps_plus.k3,</span>
<span id="cb215-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-11" tabindex="-1"></a>  <span class="st">&quot;mahvars&quot;</span> <span class="ot">=</span> m.out.cps_plus.mahvars,</span>
<span id="cb215-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-12" tabindex="-1"></a>  <span class="st">&quot;optimal_full&quot;</span> <span class="ot">=</span> m.out.cps_plus.optimal_full,</span>
<span id="cb215-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-13" tabindex="-1"></a>  <span class="st">&quot;optimal_pair&quot;</span> <span class="ot">=</span> m.out.cps_plus.optimal_pair,</span>
<span id="cb215-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-14" tabindex="-1"></a>  <span class="st">&quot;gen_full&quot;</span> <span class="ot">=</span> m.out.cps_plus.general_full,</span>
<span id="cb215-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-15" tabindex="-1"></a>  <span class="st">&quot;genetic&quot;</span> <span class="ot">=</span> m.out.cps_plus.genetic,</span>
<span id="cb215-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-16" tabindex="-1"></a>  <span class="st">&quot;exact&quot;</span> <span class="ot">=</span> m.out.cps_plus.exact,</span>
<span id="cb215-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-17" tabindex="-1"></a>  <span class="st">&quot;subcl&quot;</span> <span class="ot">=</span> m.out.cps_plus.subcl,</span>
<span id="cb215-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-18" tabindex="-1"></a>  <span class="st">&quot;profile&quot;</span>  <span class="ot">=</span> m.out.cps_plus.profile,</span>
<span id="cb215-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-19" tabindex="-1"></a>  <span class="st">&quot;ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>ipw_weight, </span>
<span id="cb215-20"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-20" tabindex="-1"></a>  <span class="st">&quot;smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb215-21"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-21" tabindex="-1"></a>  <span class="st">&quot;opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb215-22"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-22" tabindex="-1"></a>  <span class="st">&quot;overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb215-23"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-23" tabindex="-1"></a>  <span class="st">&quot;ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>ebal_weight,</span>
<span id="cb215-24"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-24" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb215-25"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-25" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb215-26"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-26" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb215-27"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-27" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb215-28"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-28" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb215-29"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-29" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb215-30"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-30" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ipw_weight&quot;</span>  <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb215-31"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-31" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_opt_weight&quot;</span>  <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb215-32"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-32" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb215-33"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-33" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb215-34"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-34" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb215-35"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-35" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb215-36"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-36" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb215-37"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-37" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb215-38"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-38" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb215-39"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-39" tabindex="-1"></a>  <span class="st">&quot;ps_threshold&quot;</span> <span class="ot">=</span> ldw_cps.trim_match,</span>
<span id="cb215-40"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-40" tabindex="-1"></a>  <span class="st">&quot;common_range&quot;</span> <span class="ot">=</span> ldw_cps_plus.common,</span>
<span id="cb215-41"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-41" tabindex="-1"></a>  <span class="st">&quot;stuermer&quot;</span> <span class="ot">=</span> ldw_cps_plus.stuermer,</span>
<span id="cb215-42"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-42" tabindex="-1"></a>  <span class="st">&quot;walker&quot;</span> <span class="ot">=</span> ldw_cps_plus.walker,</span>
<span id="cb215-43"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-43" tabindex="-1"></a>  <span class="st">&quot;crump&quot;</span> <span class="ot">=</span> ldw_cps_plus.crump,</span>
<span id="cb215-44"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-44" tabindex="-1"></a>  <span class="st">&quot;ipw_common_range&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-45"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-45" tabindex="-1"></a>  <span class="st">&quot;ipw_crump&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-46"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-46" tabindex="-1"></a>  <span class="st">&quot;ipw_ps_threshold&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-47"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-47" tabindex="-1"></a>  <span class="st">&quot;ipw_stuermer&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-48"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-48" tabindex="-1"></a>  <span class="st">&quot;ipw_walker&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-49"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-49" tabindex="-1"></a>  <span class="st">&quot;smr_treated_common_range&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-50"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-50" tabindex="-1"></a>  <span class="st">&quot;smr_treated_crump&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-51"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-51" tabindex="-1"></a>  <span class="st">&quot;smr_treated_ps_threshold&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-52"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-52" tabindex="-1"></a>  <span class="st">&quot;smr_treated_stuermer&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-53"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-53" tabindex="-1"></a>  <span class="st">&quot;smr_treated_walker&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-54"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-54" tabindex="-1"></a>  <span class="st">&quot;overlap_common_range&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-55"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-55" tabindex="-1"></a>  <span class="st">&quot;overlap_crump&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-56"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-56" tabindex="-1"></a>  <span class="st">&quot;overlap_ps_threshold&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-57"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-57" tabindex="-1"></a>  <span class="st">&quot;overlap_stuermer&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-58"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-58" tabindex="-1"></a>  <span class="st">&quot;overlap_walker&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-59"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-59" tabindex="-1"></a>  <span class="st">&quot;entropy_common_range&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-60"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-60" tabindex="-1"></a>  <span class="st">&quot;entropy_crump&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-61"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-61" tabindex="-1"></a>  <span class="st">&quot;entropy_ps_threshold&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-62"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-62" tabindex="-1"></a>  <span class="st">&quot;entropy_stuermer&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-63"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-63" tabindex="-1"></a>  <span class="st">&quot;entropy_walker&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">5</span>]])</span>
<span id="cb215-64"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-64" tabindex="-1"></a></span>
<span id="cb215-65"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-65" tabindex="-1"></a>dataset_list_psid <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb215-66"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-66" tabindex="-1"></a>  <span class="st">&quot;All&quot;</span> <span class="ot">=</span> ldw_psid_plus, </span>
<span id="cb215-67"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-67" tabindex="-1"></a>  <span class="st">&quot;original&quot;</span> <span class="ot">=</span> ldw_psid_plus, </span>
<span id="cb215-68"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-68" tabindex="-1"></a>  <span class="st">&quot;nn&quot;</span> <span class="ot">=</span> m.out.psid_plus.nearest, </span>
<span id="cb215-69"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-69" tabindex="-1"></a>  <span class="st">&quot;caliper&quot;</span><span class="ot">=</span> m.out.psid_plus.caliper,</span>
<span id="cb215-70"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-70" tabindex="-1"></a>  <span class="st">&quot;card&quot;</span> <span class="ot">=</span> m.out.psid_plus.card,</span>
<span id="cb215-71"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-71" tabindex="-1"></a>  <span class="st">&quot;cem&quot;</span> <span class="ot">=</span> m.out.psid_plus.cem,</span>
<span id="cb215-72"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-72" tabindex="-1"></a>  <span class="st">&quot;cS&quot;</span> <span class="ot">=</span> m.out.psid_plus.cs,</span>
<span id="cb215-73"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-73" tabindex="-1"></a>  <span class="st">&quot;k2&quot;</span> <span class="ot">=</span> m.out.psid_plus.k2,</span>
<span id="cb215-74"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-74" tabindex="-1"></a>  <span class="st">&quot;k3&quot;</span> <span class="ot">=</span> m.out.psid_plus.k3,</span>
<span id="cb215-75"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-75" tabindex="-1"></a>  <span class="st">&quot;mahvars&quot;</span> <span class="ot">=</span> m.out.psid_plus.mahvars,</span>
<span id="cb215-76"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-76" tabindex="-1"></a>  <span class="st">&quot;optimal_full&quot;</span> <span class="ot">=</span> m.out.psid_plus.optimal_full,</span>
<span id="cb215-77"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-77" tabindex="-1"></a>  <span class="st">&quot;optimal_pair&quot;</span> <span class="ot">=</span> m.out.psid_plus.optimal_pair,</span>
<span id="cb215-78"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-78" tabindex="-1"></a>  <span class="st">&quot;gen_full&quot;</span> <span class="ot">=</span> m.out.psid_plus.general_full,</span>
<span id="cb215-79"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-79" tabindex="-1"></a>  <span class="st">&quot;genetic&quot;</span> <span class="ot">=</span> m.out.psid_plus.genetic,</span>
<span id="cb215-80"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-80" tabindex="-1"></a>  <span class="st">&quot;exact&quot;</span> <span class="ot">=</span> m.out.psid_plus.exact,</span>
<span id="cb215-81"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-81" tabindex="-1"></a>  <span class="st">&quot;subcl&quot;</span> <span class="ot">=</span> m.out.psid_plus.subcl,</span>
<span id="cb215-82"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-82" tabindex="-1"></a>  <span class="st">&quot;profile&quot;</span> <span class="ot">=</span> m.out.psid_plus.profile,</span>
<span id="cb215-83"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-83" tabindex="-1"></a>  <span class="st">&quot;ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>ipw_weight, </span>
<span id="cb215-84"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-84" tabindex="-1"></a>  <span class="st">&quot;smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb215-85"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-85" tabindex="-1"></a>  <span class="st">&quot;opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb215-86"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-86" tabindex="-1"></a>  <span class="st">&quot;overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb215-87"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-87" tabindex="-1"></a>  <span class="st">&quot;ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>ebal_weight,</span>
<span id="cb215-88"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-88" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb215-89"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-89" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb215-90"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-90" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb215-91"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-91" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb215-92"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-92" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb215-93"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-93" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb215-94"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-94" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb215-95"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-95" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb215-96"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-96" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb215-97"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-97" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb215-98"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-98" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb215-99"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-99" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb215-100"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-100" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb215-101"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-101" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb215-102"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-102" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb215-103"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-103" tabindex="-1"></a>  <span class="st">&quot;ps_threshold&quot;</span> <span class="ot">=</span> ldw_psid.trim_match,</span>
<span id="cb215-104"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-104" tabindex="-1"></a>  <span class="st">&quot;common_range&quot;</span> <span class="ot">=</span> ldw_psid_plus.common,</span>
<span id="cb215-105"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-105" tabindex="-1"></a>  <span class="st">&quot;stuermer&quot;</span> <span class="ot">=</span> ldw_psid_plus.stuermer,</span>
<span id="cb215-106"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-106" tabindex="-1"></a>  <span class="st">&quot;walker&quot;</span> <span class="ot">=</span> ldw_psid_plus.walker,</span>
<span id="cb215-107"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-107" tabindex="-1"></a>  <span class="st">&quot;crump&quot;</span> <span class="ot">=</span> ldw_psid_plus.crump,</span>
<span id="cb215-108"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-108" tabindex="-1"></a>  <span class="st">&quot;ipw_common_range&quot;</span> <span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-109"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-109" tabindex="-1"></a>  <span class="st">&quot;ipw_crump&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-110"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-110" tabindex="-1"></a>  <span class="st">&quot;ipw_ps_threshold&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-111"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-111" tabindex="-1"></a>  <span class="st">&quot;ipw_stuermer&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-112"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-112" tabindex="-1"></a>  <span class="st">&quot;ipw_walker&quot;</span> <span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-113"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-113" tabindex="-1"></a>  <span class="st">&quot;smr_treated_common_range&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-114"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-114" tabindex="-1"></a>  <span class="st">&quot;smr_treated_crump&quot;</span><span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-115"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-115" tabindex="-1"></a>  <span class="st">&quot;smr_treated_ps_threshold&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-116"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-116" tabindex="-1"></a>  <span class="st">&quot;smr_treated_stuermer&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-117"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-117" tabindex="-1"></a>  <span class="st">&quot;smr_treated_walker&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-118"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-118" tabindex="-1"></a>  <span class="st">&quot;overlap_common_range&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-119"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-119" tabindex="-1"></a>  <span class="st">&quot;overlap_crump&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-120"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-120" tabindex="-1"></a>  <span class="st">&quot;overlap_ps_threshold&quot;</span>  <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-121"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-121" tabindex="-1"></a>  <span class="st">&quot;overlap_stuermer&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-122"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-122" tabindex="-1"></a>  <span class="st">&quot;overlap_walker&quot;</span><span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb215-123"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-123" tabindex="-1"></a>  <span class="st">&quot;entropy_common_range&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb215-124"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-124" tabindex="-1"></a>  <span class="st">&quot;entropy_crump&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb215-125"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-125" tabindex="-1"></a>  <span class="st">&quot;entropy_ps_threshold&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb215-126"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-126" tabindex="-1"></a>  <span class="st">&quot;entropy_stuermer&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb215-127"><a href="lalonde-dehejia-wahba-ldw-data.html#cb215-127" tabindex="-1"></a>  <span class="st">&quot;entropy_walker&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">5</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb216-1" tabindex="-1"></a><span class="co"># create datasets corresponding to the top 5 methods for each dataset</span></span>
<span id="cb216-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb216-2" tabindex="-1"></a>top5_datasets.cps_plus <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(dataset_list_cps, top5_methods.cps_plus)</span>
<span id="cb216-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb216-3" tabindex="-1"></a>top5_datasets.psid_plus <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(dataset_list_psid, top5_methods.psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb217-1" tabindex="-1"></a><span class="co"># save datasets into .RData files</span></span>
<span id="cb217-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb217-2" tabindex="-1"></a><span class="fu">save_top5_individual_files</span>(dataset_list_cps, top5_methods.cps_plus, <span class="at">prefix =</span> <span class="st">&quot;model_a_cps&quot;</span>)</span>
<span id="cb217-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb217-3" tabindex="-1"></a><span class="fu">save_top5_individual_files</span>(dataset_list_psid, top5_methods.psid_plus, <span class="at">prefix =</span> <span class="st">&quot;model_a_psid&quot;</span>)</span></code></pre></div>
</div>
<div id="estimating-1" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Estimating<a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-treatment-effect-on-the-treated-att" class="section level3 hasAnchor" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Average treatment effect on the treated (ATT)<a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we estimate the average treatment effect on the treated (ATT) using both the LDW-Experimental sample, the non-plus observational datasets and the newly constructed top five ranked samples for each observational dataset, LDW-CPS1 and LDW-PSID1, that achieved highest score results.</p>
<p>We employ a broad set of estimators, including difference-in-means, regression, the Oaxaca-Blinder estimator, generalized random forests (GRF) as an outcome model, 1:5 nearest neighbor matching with bias correction, inverse probability weighting (IPW) with GRF-based propensity scores, covariate balancing propensity score (CBPS), entropy balancing, double/debiased machine learning using elastic net, and augmented inverse probability weighting (AIPW) via GRF. We also incorporate the recently introduced estimand-specific AIPW estimator implemented through an expansion of the <code>OutcomeWeights</code> R package by Knaus and Pfleiderer (2024).</p>
<p>We utilize the <code>estimate_all()</code> and <code>plot_coef()</code> functions as defined by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb218-1" tabindex="-1"></a><span class="co"># estimate ATT</span></span>
<span id="cb218-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb218-2" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb218-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb218-3" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb218-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb218-4" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb219-1" tabindex="-1"></a>out4 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps.trim_match, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar) </span>
<span id="cb219-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb219-2" tabindex="-1"></a>out5 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid.trim_match, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-1" tabindex="-1"></a>out.cps_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb220-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-2" tabindex="-1"></a>out.psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb220-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-3" tabindex="-1"></a></span>
<span id="cb220-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-4" tabindex="-1"></a>out6 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">1</span>]]</span>
<span id="cb220-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-5" tabindex="-1"></a>out7 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">2</span>]]</span>
<span id="cb220-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-6" tabindex="-1"></a>out8 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">3</span>]]</span>
<span id="cb220-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-7" tabindex="-1"></a>out9 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">4</span>]]</span>
<span id="cb220-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-8" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">5</span>]]</span>
<span id="cb220-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-9" tabindex="-1"></a></span>
<span id="cb220-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-10" tabindex="-1"></a>out11 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">1</span>]]</span>
<span id="cb220-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-11" tabindex="-1"></a>out12 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">2</span>]]</span>
<span id="cb220-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-12" tabindex="-1"></a>out13 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">3</span>]]</span>
<span id="cb220-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-13" tabindex="-1"></a>out14 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">4</span>]]</span>
<span id="cb220-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb220-14" tabindex="-1"></a>out15 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">5</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-1" tabindex="-1"></a><span class="co"># build plot titles </span></span>
<span id="cb221-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-2" tabindex="-1"></a>base_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>, <span class="st">&quot;(B) LDW-CPS1&quot;</span> , <span class="st">&quot;(C) LDW-PSID1&quot;</span>, <span class="st">&quot;(D) Trimmed LDW-CPS1 &quot;</span>, <span class="st">&quot;(E) Trimmed LDW-PSID1&quot;</span>)</span>
<span id="cb221-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-3" tabindex="-1"></a>top_start <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># F is 6th letter</span></span>
<span id="cb221-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-4" tabindex="-1"></a>num_cps <span class="ot">&lt;-</span> <span class="fu">length</span>(top5_methods.cps_plus)</span>
<span id="cb221-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-5" tabindex="-1"></a>num_psid <span class="ot">&lt;-</span> <span class="fu">length</span>(top5_methods.psid_plus)</span>
<span id="cb221-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-6" tabindex="-1"></a>top_letters_cps <span class="ot">&lt;-</span> LETTERS[top_start<span class="sc">:</span>(top_start <span class="sc">+</span> num_cps <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb221-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-7" tabindex="-1"></a>top_letters_psid <span class="ot">&lt;-</span> LETTERS[(top_start <span class="sc">+</span> num_cps)<span class="sc">:</span>(top_start <span class="sc">+</span> num_cps <span class="sc">+</span> num_psid <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb221-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-8" tabindex="-1"></a>top5_titles.cps_plus <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, top_letters_cps, <span class="st">&quot;) Top CPS1: &quot;</span>, top5_methods.cps_plus)</span>
<span id="cb221-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-9" tabindex="-1"></a>top5_titles.psid_plus <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, top_letters_psid, <span class="st">&quot;) Top PSID1: &quot;</span>, top5_methods.psid_plus)</span>
<span id="cb221-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb221-10" tabindex="-1"></a>plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(base_titles, top5_titles.cps_plus, top5_titles.psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb222-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb222-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb222-2" tabindex="-1"></a>all_outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1, out2, out3, out4, out5), out.cps_plus, out.psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb223-1" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb223-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb223-2" tabindex="-1"></a>band <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb223-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb223-3" tabindex="-1"></a>est  <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb223-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb223-4" tabindex="-1"></a><span class="fu">plot_att_panels</span>(all_outs, plot_titles, band, est, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">textsize =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-146-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-146-1.png" alt="FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.142: FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-146-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-146-2.png" alt="FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.143: FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-146-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-146-3.png" alt="FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.144: FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-146-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-146-4.png" alt="FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 2.145: FIGURE A10. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb224-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb224-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb224-2" tabindex="-1"></a><span class="fu">save_att_panels</span>(all_outs, plot_titles, band, est, <span class="st">&quot;model_a&quot;</span>)</span></code></pre></div>
<p>The above figures show the ATT estimates and their 95% confidence intervals for fifteen samples: LDW-Experimental, LDW-CPS1, LDW-PSID1, trimmed versions of the LDW-CPS1 and LDW-PSID1 samples (analogous to Imbens &amp; Xu (2024)) and a series of top-ranked subsamples of both LDW-CPS1 and LDW-PSID1 based on various matching, weighting, truncation and trimming criteria.</p>
<p>Figure (A) presents the benchmark from the experimental sample (LDW-Experimental), serving as a reference for bias and variance assessment of observational samples. Figures (B) and (C) show results for the observational samples, LDW-CPS1 and LDW-PSID1, while figures (D) and (E) present those for the trimmed versions, replicating the tutorial results of Imbens &amp; Xu (2024). Figures (F) through (J) display results for CPS1-based subsamples constructed with the top-ranked methods. Analogously, figures (K) through (O) summarize results for the corresponding PSID1-based subsamples under parallel rules.</p>
<p>Across the LDW-CPS1 dataset and its top-ranked subsamples, all estimators generally produce ATT estimates that closely cluster around the experimental benchmark. However, the <code>overlap_crump</code> and <code>overlap_pair</code> samples exhibit somewhat larger deviations. While most estimates are positive, the <code>overlap_crump</code> and <code>optimal_pair</code> subsample results include a few negative ATT estimates, and all ATT estimates for the <code>mahvars</code> subsample are consistently negative.</p>
<p>In contrast, PSID1-based subsamples frequently exhibit greater dispersion and substantially higher standard errors compared to LDW-CPS1 samples. Most ATT estimates are negatively aligned, indicating increased methodological uncertainty in these samples. Positive ATT estimates emerge only for the subsample based on <code>overlap_crump</code>.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb225-1" tabindex="-1"></a><span class="co"># prepare all results in the order shown in the plots</span></span>
<span id="cb225-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb225-2" tabindex="-1"></a>all_summaries <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_outs, eval_att)</span>
<span id="cb225-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb225-3" tabindex="-1"></a>att_summary <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, all_summaries)</span>
<span id="cb225-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb225-4" tabindex="-1"></a><span class="fu">rownames</span>(att_summary) <span class="ot">&lt;-</span> plot_titles</span>
<span id="cb225-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb225-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(att_summary, <span class="at">caption =</span> <span class="st">&quot;ATT Summary Statistics&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-148">Table 2.5: </span>ATT Summary Statistics</caption>
<colgroup>
<col width="46%" />
<col width="10%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean_SE</th>
<th align="right">Min_Estimate</th>
<th align="right">Max_Estimate</th>
<th align="right">Diff_Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">676.7242</td>
<td align="right">1568.8851</td>
<td align="right">1960.9893</td>
<td align="right">392.1041</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">672.2335</td>
<td align="right">-8497.5161</td>
<td align="right">1729.1183</td>
<td align="right">10226.6344</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">831.8630</td>
<td align="right">-15204.7774</td>
<td align="right">2437.7016</td>
<td align="right">17642.4790</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">823.2756</td>
<td align="right">717.9131</td>
<td align="right">1352.1369</td>
<td align="right">634.2238</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">1126.5747</td>
<td align="right">-1656.2410</td>
<td align="right">-265.8659</td>
<td align="right">1390.3751</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: card</td>
<td align="right">487.2001</td>
<td align="right">214.1581</td>
<td align="right">1023.7365</td>
<td align="right">809.5784</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: mahvars</td>
<td align="right">519.5097</td>
<td align="right">-317.8912</td>
<td align="right">-161.1994</td>
<td align="right">156.6918</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: ps_threshold</td>
<td align="right">823.3684</td>
<td align="right">717.9131</td>
<td align="right">1381.3977</td>
<td align="right">663.4846</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: adap_weight_trunc_smr_weight</td>
<td align="right">468.8832</td>
<td align="right">-9545.8960</td>
<td align="right">646.5836</td>
<td align="right">10192.4795</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">479.8926</td>
<td align="right">-267.2669</td>
<td align="right">751.3411</td>
<td align="right">1018.6079</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">978.9970</td>
<td align="right">-2402.7783</td>
<td align="right">-393.9507</td>
<td align="right">2008.8276</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">892.0455</td>
<td align="right">-2566.0998</td>
<td align="right">-1436.7082</td>
<td align="right">1129.3916</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">1126.4365</td>
<td align="right">-1656.2410</td>
<td align="right">-265.8659</td>
<td align="right">1390.3751</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: smr_treated_ps_threshold</td>
<td align="right">2734.4823</td>
<td align="right">-6320.6376</td>
<td align="right">-697.7717</td>
<td align="right">5622.8659</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_crump</td>
<td align="right">686.9889</td>
<td align="right">-6527.5722</td>
<td align="right">1531.2657</td>
<td align="right">8058.8379</td>
</tr>
</tbody>
</table>
<p>The ATT results are presented in the table below:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb226-1" tabindex="-1"></a><span class="co"># get result matrix</span></span>
<span id="cb226-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb226-2" tabindex="-1"></a>result_mat <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs, plot_titles)</span>
<span id="cb226-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb226-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result_mat, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">&quot;ATT Estimates and SEs&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-149">Table 2.6: </span>ATT Estimates and SEs</caption>
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="8%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="7%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">(A) LDW-Experimental</th>
<th align="left"></th>
<th align="left">(B) LDW-CPS1</th>
<th align="left"></th>
<th align="left">(C) LDW-PSID1</th>
<th align="left"></th>
<th align="left">(D) Trimmed LDW-CPS1</th>
<th align="left"></th>
<th align="left">(E) Trimmed LDW-PSID1</th>
<th align="left"></th>
<th align="left">(F) Top CPS1: card</th>
<th align="left"></th>
<th align="left">(G) Top CPS1: mahvars</th>
<th align="left"></th>
<th align="left">(H) Top CPS1: ps_threshold</th>
<th align="left"></th>
<th align="left">(I) Top CPS1: adap_weight_trunc_smr_weight</th>
<th align="left"></th>
<th align="left">(J) Top CPS1: optimal_pair</th>
<th align="left"></th>
<th align="left">(K) Top PSID1: card</th>
<th align="left"></th>
<th align="left">(L) Top PSID1: mahvars</th>
<th align="left"></th>
<th align="left">(M) Top PSID1: ps_threshold</th>
<th align="left"></th>
<th align="left">(N) Top PSID1: smr_treated_ps_threshold</th>
<th align="left"></th>
<th align="left">(O) Top PSID1: overlap_crump</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Experimental Benchmark</td>
<td align="left">1794.34</td>
<td align="left">(670.82)</td>
<td align="left">-8497.52</td>
<td align="left">(581.92)</td>
<td align="left">-15204.78</td>
<td align="left">(655.91)</td>
<td align="left">766.99</td>
<td align="left">(848.00)</td>
<td align="left">-349.21</td>
<td align="left">(1101.43)</td>
<td align="left">214.16</td>
<td align="left">(475.53)</td>
<td align="left">-265.18</td>
<td align="left">(535.18)</td>
<td align="left">766.99</td>
<td align="left">(848.00)</td>
<td align="left">-9545.90</td>
<td align="left">(323.16)</td>
<td align="left">-267.27</td>
<td align="left">(448.21)</td>
<td align="left">-586.61</td>
<td align="left">(967.69)</td>
<td align="left">-1636.51</td>
<td align="left">(928.51)</td>
<td align="left">-349.21</td>
<td align="left">(1101.43)</td>
<td align="left">-3657.32</td>
<td align="left">(2565.47)</td>
<td align="left">-6527.57</td>
<td align="left">(558.29)</td>
</tr>
<tr class="even">
<td align="left">diff</td>
<td align="left">1794.34</td>
<td align="left">(670.82)</td>
<td align="left">-8497.52</td>
<td align="left">(581.92)</td>
<td align="left">-15204.78</td>
<td align="left">(655.91)</td>
<td align="left">766.99</td>
<td align="left">(848.00)</td>
<td align="left">-349.21</td>
<td align="left">(1101.43)</td>
<td align="left">214.16</td>
<td align="left">(475.53)</td>
<td align="left">-265.18</td>
<td align="left">(535.18)</td>
<td align="left">766.99</td>
<td align="left">(848.00)</td>
<td align="left">-9545.90</td>
<td align="left">(323.16)</td>
<td align="left">-267.27</td>
<td align="left">(448.21)</td>
<td align="left">-586.61</td>
<td align="left">(967.69)</td>
<td align="left">-1636.51</td>
<td align="left">(928.51)</td>
<td align="left">-349.21</td>
<td align="left">(1101.43)</td>
<td align="left">-3657.32</td>
<td align="left">(2565.47)</td>
<td align="left">-6527.57</td>
<td align="left">(558.29)</td>
</tr>
<tr class="odd">
<td align="left">reg</td>
<td align="left">1670.71</td>
<td align="left">(680.20)</td>
<td align="left">1066.38</td>
<td align="left">(626.85)</td>
<td align="left">4.16</td>
<td align="left">(854.15)</td>
<td align="left">985.38</td>
<td align="left">(836.01)</td>
<td align="left">-951.25</td>
<td align="left">(1127.92)</td>
<td align="left">369.99</td>
<td align="left">(449.49)</td>
<td align="left">-252.44</td>
<td align="left">(507.35)</td>
<td align="left">985.38</td>
<td align="left">(836.01)</td>
<td align="left">90.18</td>
<td align="left">(385.75)</td>
<td align="left">295.33</td>
<td align="left">(451.21)</td>
<td align="left">-623.64</td>
<td align="left">(949.49)</td>
<td align="left">-1523.73</td>
<td align="left">(878.90)</td>
<td align="left">-951.25</td>
<td align="left">(1127.92)</td>
<td align="left">-1763.11</td>
<td align="left">(2385.61)</td>
<td align="left">-125.00</td>
<td align="left">(825.19)</td>
</tr>
<tr class="even">
<td align="left">om.reg</td>
<td align="left">1706.20</td>
<td align="left">(587.94)</td>
<td align="left">1133.28</td>
<td align="left">(624.26)</td>
<td align="left">687.82</td>
<td align="left">(635.26)</td>
<td align="left">757.66</td>
<td align="left">(695.08)</td>
<td align="left">-1446.73</td>
<td align="left">(835.35)</td>
<td align="left">410.61</td>
<td align="left">(385.09)</td>
<td align="left">-166.50</td>
<td align="left">(419.49)</td>
<td align="left">757.66</td>
<td align="left">(695.08)</td>
<td align="left">186.84</td>
<td align="left">(350.59)</td>
<td align="left">599.45</td>
<td align="left">(347.62)</td>
<td align="left">-887.73</td>
<td align="left">(719.14)</td>
<td align="left">-1570.74</td>
<td align="left">(726.93)</td>
<td align="left">-1446.73</td>
<td align="left">(835.35)</td>
<td align="left">-2256.88</td>
<td align="left">(2990.69)</td>
<td align="left">1531.27</td>
<td align="left">(411.05)</td>
</tr>
<tr class="odd">
<td align="left">om.grf</td>
<td align="left">1760.54</td>
<td align="left">(582.13)</td>
<td align="left">1098.04</td>
<td align="left">(629.63)</td>
<td align="left">744.36</td>
<td align="left">(634.10)</td>
<td align="left">1090.29</td>
<td align="left">(661.52)</td>
<td align="left">-467.98</td>
<td align="left">(723.15)</td>
<td align="left">576.00</td>
<td align="left">(372.85)</td>
<td align="left">-254.70</td>
<td align="left">(395.51)</td>
<td align="left">987.45</td>
<td align="left">(662.36)</td>
<td align="left">143.29</td>
<td align="left">(352.88)</td>
<td align="left">465.08</td>
<td align="left">(335.71)</td>
<td align="left">-510.31</td>
<td align="left">(552.84)</td>
<td align="left">-1474.19</td>
<td align="left">(646.96)</td>
<td align="left">-450.46</td>
<td align="left">(721.49)</td>
<td align="left">-3205.02</td>
<td align="left">(1979.84)</td>
<td align="left">-267.71</td>
<td align="left">(402.82)</td>
</tr>
<tr class="even">
<td align="left">matching</td>
<td align="left">1757.17</td>
<td align="left">(764.06)</td>
<td align="left">1729.12</td>
<td align="left">(815.38)</td>
<td align="left">2255.47</td>
<td align="left">(1403.83)</td>
<td align="left">722.23</td>
<td align="left">(966.32)</td>
<td align="left">-658.55</td>
<td align="left">(1208.09)</td>
<td align="left">426.74</td>
<td align="left">(641.43)</td>
<td align="left">-202.91</td>
<td align="left">(592.72)</td>
<td align="left">722.23</td>
<td align="left">(966.32)</td>
<td align="left">627.36</td>
<td align="left">(628.20)</td>
<td align="left">487.34</td>
<td align="left">(649.91)</td>
<td align="left">-452.10</td>
<td align="left">(911.75)</td>
<td align="left">-1436.71</td>
<td align="left">(987.36)</td>
<td align="left">-658.55</td>
<td align="left">(1208.09)</td>
<td align="left">-697.77</td>
<td align="left">(1741.16)</td>
<td align="left">1291.44</td>
<td align="left">(1114.74)</td>
</tr>
<tr class="odd">
<td align="left">psm</td>
<td align="left">1568.89</td>
<td align="left">(707.14)</td>
<td align="left">1271.98</td>
<td align="left">(739.46)</td>
<td align="left">2432.11</td>
<td align="left">(740.90)</td>
<td align="left">1352.14</td>
<td align="left">(826.98)</td>
<td align="left">-265.87</td>
<td align="left">(1074.72)</td>
<td align="left">1023.74</td>
<td align="left">(463.22)</td>
<td align="left">-161.20</td>
<td align="left">(542.52)</td>
<td align="left">1381.40</td>
<td align="left">(827.26)</td>
<td align="left">2.75</td>
<td align="left">(429.09)</td>
<td align="left">751.34</td>
<td align="left">(416.89)</td>
<td align="left">-2402.78</td>
<td align="left">(1376.05)</td>
<td align="left">-2566.10</td>
<td align="left">(962.12)</td>
<td align="left">-265.87</td>
<td align="left">(1074.72)</td>
<td align="left">-6320.64</td>
<td align="left">(6247.60)</td>
<td align="left">1299.41</td>
<td align="left">(486.82)</td>
</tr>
<tr class="even">
<td align="left">ipw</td>
<td align="left">1774.71</td>
<td align="left">(680.01)</td>
<td align="left">1223.77</td>
<td align="left">(689.43)</td>
<td align="left">722.78</td>
<td align="left">(891.40)</td>
<td align="left">943.92</td>
<td align="left">(833.16)</td>
<td align="left">-568.83</td>
<td align="left">(1140.41)</td>
<td align="left">214.16</td>
<td align="left">(475.53)</td>
<td align="left">-265.18</td>
<td align="left">(535.18)</td>
<td align="left">943.92</td>
<td align="left">(833.16)</td>
<td align="left">646.58</td>
<td align="left">(656.00)</td>
<td align="left">-267.27</td>
<td align="left">(448.21)</td>
<td align="left">-586.61</td>
<td align="left">(967.69)</td>
<td align="left">-1636.51</td>
<td align="left">(928.51)</td>
<td align="left">-568.83</td>
<td align="left">(1140.41)</td>
<td align="left">-3610.68</td>
<td align="left">(2376.07)</td>
<td align="left">131.27</td>
<td align="left">(808.96)</td>
</tr>
<tr class="odd">
<td align="left">cbps</td>
<td align="left">1709.55</td>
<td align="left">(699.04)</td>
<td align="left">1408.01</td>
<td align="left">(654.96)</td>
<td align="left">2437.70</td>
<td align="left">(877.80)</td>
<td align="left">739.52</td>
<td align="left">(869.71)</td>
<td align="left">-1283.13</td>
<td align="left">(1340.97)</td>
<td align="left">214.16</td>
<td align="left">(475.53)</td>
<td align="left">-265.18</td>
<td align="left">(535.18)</td>
<td align="left">739.52</td>
<td align="left">(869.71)</td>
<td align="left">373.88</td>
<td align="left">(467.55)</td>
<td align="left">-267.27</td>
<td align="left">(448.21)</td>
<td align="left">-586.61</td>
<td align="left">(967.69)</td>
<td align="left">-1636.51</td>
<td align="left">(928.51)</td>
<td align="left">-1283.13</td>
<td align="left">(1340.97)</td>
<td align="left">-1560.64</td>
<td align="left">(2060.12)</td>
<td align="left">1147.48</td>
<td align="left">(799.39)</td>
</tr>
<tr class="even">
<td align="left">ebal</td>
<td align="left">1712.12</td>
<td align="left">(699.26)</td>
<td align="left">1406.27</td>
<td align="left">(654.93)</td>
<td align="left">2420.49</td>
<td align="left">(876.85)</td>
<td align="left">717.91</td>
<td align="left">(884.14)</td>
<td align="left">-1606.41</td>
<td align="left">(1512.52)</td>
<td align="left">381.53</td>
<td align="left">(489.72)</td>
<td align="left">-178.85</td>
<td align="left">(550.29)</td>
<td align="left">717.91</td>
<td align="left">(884.14)</td>
<td align="left">371.70</td>
<td align="left">(467.68)</td>
<td align="left">463.11</td>
<td align="left">(482.64)</td>
<td align="left">-784.35</td>
<td align="left">(1095.83)</td>
<td align="left">-1597.46</td>
<td align="left">(947.90)</td>
<td align="left">-1606.41</td>
<td align="left">(1512.52)</td>
<td align="left">-1721.85</td>
<td align="left">(2139.84)</td>
<td align="left">1387.00</td>
<td align="left">(790.71)</td>
</tr>
<tr class="odd">
<td align="left">dml</td>
<td align="left">1960.99</td>
<td align="left">(682.98)</td>
<td align="left">1068.62</td>
<td align="left">(627.81)</td>
<td align="left">91.01</td>
<td align="left">(861.30)</td>
<td align="left">854.02</td>
<td align="left">(810.50)</td>
<td align="left">-1656.24</td>
<td align="left">(1163.41)</td>
<td align="left">455.42</td>
<td align="left">(449.47)</td>
<td align="left">-317.89</td>
<td align="left">(510.14)</td>
<td align="left">854.02</td>
<td align="left">(810.50)</td>
<td align="left">89.15</td>
<td align="left">(385.05)</td>
<td align="left">362.38</td>
<td align="left">(447.22)</td>
<td align="left">-1184.06</td>
<td align="left">(998.15)</td>
<td align="left">-1496.09</td>
<td align="left">(871.83)</td>
<td align="left">-1656.24</td>
<td align="left">(1163.41)</td>
<td align="left">-3310.44</td>
<td align="left">(2844.31)</td>
<td align="left">-21.50</td>
<td align="left">(837.05)</td>
</tr>
<tr class="even">
<td align="left">aipw_grf</td>
<td align="left">1766.72</td>
<td align="left">(685.93)</td>
<td align="left">1451.06</td>
<td align="left">(731.95)</td>
<td align="left">1401.56</td>
<td align="left">(790.67)</td>
<td align="left">1092.32</td>
<td align="left">(825.76)</td>
<td align="left">-482.67</td>
<td align="left">(1133.77)</td>
<td align="left">610.30</td>
<td align="left">(635.53)</td>
<td align="left">-229.88</td>
<td align="left">(556.38)</td>
<td align="left">1092.32</td>
<td align="left">(825.76)</td>
<td align="left">623.02</td>
<td align="left">(625.08)</td>
<td align="left">663.80</td>
<td align="left">(628.05)</td>
<td align="left">-883.21</td>
<td align="left">(1140.69)</td>
<td align="left">-1695.77</td>
<td align="left">(952.86)</td>
<td align="left">-482.67</td>
<td align="left">(1133.77)</td>
<td align="left">-3885.35</td>
<td align="left">(2856.48)</td>
<td align="left">439.92</td>
<td align="left">(663.93)</td>
</tr>
<tr class="odd">
<td align="left">aipw_ow</td>
<td align="left">1831.33</td>
<td align="left">(681.18)</td>
<td align="left">1412.96</td>
<td align="left">(690.23)</td>
<td align="left">1324.99</td>
<td align="left">(760.19)</td>
<td align="left">883.36</td>
<td align="left">(822.13)</td>
<td align="left">-642.37</td>
<td align="left">(1157.17)</td>
<td align="left">746.10</td>
<td align="left">(533.03)</td>
<td align="left">-170.77</td>
<td align="left">(554.19)</td>
<td align="left">883.36</td>
<td align="left">(822.13)</td>
<td align="left">506.82</td>
<td align="left">(555.55)</td>
<td align="left">470.33</td>
<td align="left">(654.85)</td>
<td align="left">-393.95</td>
<td align="left">(1100.95)</td>
<td align="left">-1517.32</td>
<td align="left">(944.15)</td>
<td align="left">-642.37</td>
<td align="left">(1157.17)</td>
<td align="left">-3351.52</td>
<td align="left">(2626.59)</td>
<td align="left">368.00</td>
<td align="left">(544.90)</td>
</tr>
</tbody>
</table>
<div class="callout-note">
<p>The first value in each cell represents the point estimate from the respective estimator and sample. The number in brackets directly following it is the robust standard error (SE) associated with that estimate, indicating the uncertainty or variability around the point estimate.</p>
</div>
<p>The tabulated results confirm visual patterns: Column (A) reports the estimates for the LDW-Experimental sample, column (B) for the LDW-CPS1 sample, and column (C) for the LDW-PSID1 sample. Columns (D)-(O) summarize the trimmed and top-ranked sample results for both LDW-CPS1 and LDW-PSID1.</p>
<p>For most LDW-CPS1-based samples, estimates remain not only positive but also comparatively close to the experimental benchmark, with modest variance inflation. In contrast, the LDW-PSID1-based estimates exhibit greater variability, more frequently negative values, and larger standard errors, reflecting an increased challenge of achieving balance and overlap in this observational dataset.</p>
<p>Overall, figures and table jointly demonstrate that ATT estimates from observational samples tend to have larger standard errors compared to the experimental sample, reflecting greater statistical uncertainty in non-experimental causal effect estimation, and that certain criteria can bring observational estimates closer to the experimental benchmark. Nevertheless, significant estimator-dependent variability and sensitivity to sample construction persist.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb227-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb227-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb227-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat, <span class="st">&quot;LDW_att_estimates_model_a&quot;</span>)</span></code></pre></div>
<div class="callout-tip">
<p>Improved overlap and covariate balance generally leads to estimates closer to the experimental benchmark, but often at the cost of increased standard errors. This trade-off highlights the need to carefully balance bias reduction against precision when selecting methods for robust causal inference.</p>
</div>
<p>Next, we explore alternative estimands such as heterogeneous treatment effects and quantile treatment effects, which may provide deeper insights into the validity of the unconfoundedness assumption.</p>
</div>
<div id="conditional-average-treatment-effect-on-the-treated-catt-1" class="section level3 hasAnchor" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> Conditional average treatment effect on the treated (CATT)<a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>CATT enables analysis of treatment effect heterogeneity across covariate-defined subpopulations. We estimate the CATT for the same samples previously considered in the ATT estimation by applying the Augmented Inverse Probability Weighting Generalized Random Forest (AIPW-GRF) method via the <code>catt()</code> function from Imbens and Xu (2024).</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-1" tabindex="-1"></a><span class="co"># estimate CATT</span></span>
<span id="cb228-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-2" tabindex="-1"></a>catt.ldw <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw, Y, treat, covar)</span>
<span id="cb228-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-3" tabindex="-1"></a>catt.cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps, Y, treat, covar)</span>
<span id="cb228-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-4" tabindex="-1"></a>catt.psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid, Y, treat, covar)</span>
<span id="cb228-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-5" tabindex="-1"></a>catt.cps.trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps.trim_match, Y, treat, covar)</span>
<span id="cb228-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb228-6" tabindex="-1"></a>catt.psid.trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid.trim_match, Y, treat, covar)</span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb229-1" tabindex="-1"></a><span class="co"># estimate CATT</span></span>
<span id="cb229-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb229-2" tabindex="-1"></a>catt.top5_cps_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb229-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb229-3" tabindex="-1"></a>catt.top5_psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span></code></pre></div>
<p>Then, we employ a modified version of the function <code>plot_catt()</code> from <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span> to visualize the results by plotting the estimated CATTs for all samples at the covariate values of each treated unit against their corresponding experimental benchmarks.</p>
<div class="callout-note">
<p>Gray dots represent pairs of CATT estimates at covariate values of treated units, while the red crosses indicate pairs of estimated ATTs.</p>
</div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-1" tabindex="-1"></a><span class="co"># combine all catt objects </span></span>
<span id="cb230-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-2" tabindex="-1"></a>all_catt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(catt.ldw, catt.cps, catt.psid, catt.cps.trim, catt.psid.trim), catt.top5_cps_plus, catt.top5_psid_plus)</span>
<span id="cb230-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-3" tabindex="-1"></a></span>
<span id="cb230-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-4" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb230-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb230-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb230-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb230-7" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(all_catt, plot_titles)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-153-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-153-1.png" alt="FIGURE A11. CATT Estimates Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.146: FIGURE A11. CATT Estimates Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-153-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-153-2.png" alt="FIGURE A11. CATT Estimates Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.147: FIGURE A11. CATT Estimates Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-153-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-153-3.png" alt="FIGURE A11. CATT Estimates Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.148: FIGURE A11. CATT Estimates Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-153-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-153-4.png" alt="FIGURE A11. CATT Estimates Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.149: FIGURE A11. CATT Estimates Model A using LDW Data
</p>
</div>
<p>Although the AIPW estimator can produce ATT estimates closely aligned with the experimental benchmark using LDW data, its performance for revealing the true CATT is considerably worse.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb231-1" tabindex="-1"></a>all_catt_eval <span class="ot">&lt;-</span> <span class="fu">eval_catt</span>(all_catt, plot_titles)</span>
<span id="cb231-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb231-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(all_catt_eval, <span class="at">caption =</span> <span class="st">&quot;CATT Summary Statistics&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-154">Table 2.7: </span>CATT Summary Statistics</caption>
<colgroup>
<col width="50%" />
<col width="13%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Min_Catt</th>
<th align="right">Max_Catt</th>
<th align="right">Mean_Catt</th>
<th align="right">Diff_Catt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">-194.7392</td>
<td align="right">4007.396</td>
<td align="right">1752.2184</td>
<td align="right">4202.136</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">-5722.7501</td>
<td align="right">7098.153</td>
<td align="right">2073.4674</td>
<td align="right">12820.903</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">-8364.4489</td>
<td align="right">4788.664</td>
<td align="right">711.6113</td>
<td align="right">13153.113</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">-4236.6217</td>
<td align="right">5359.548</td>
<td align="right">1069.6365</td>
<td align="right">9596.170</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">-3012.4222</td>
<td align="right">2092.368</td>
<td align="right">-304.5311</td>
<td align="right">5104.790</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: card</td>
<td align="right">-6081.8802</td>
<td align="right">4709.235</td>
<td align="right">502.3159</td>
<td align="right">10791.115</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: mahvars</td>
<td align="right">-4272.5932</td>
<td align="right">3271.017</td>
<td align="right">-256.4164</td>
<td align="right">7543.611</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: ps_threshold</td>
<td align="right">-4329.8360</td>
<td align="right">5188.044</td>
<td align="right">1038.4424</td>
<td align="right">9517.880</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: adap_weight_trunc_smr_weight</td>
<td align="right">-7076.3506</td>
<td align="right">5656.170</td>
<td align="right">953.0638</td>
<td align="right">12732.520</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">-5793.5866</td>
<td align="right">4860.446</td>
<td align="right">588.6169</td>
<td align="right">10654.033</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">-6350.4848</td>
<td align="right">3254.735</td>
<td align="right">-810.1029</td>
<td align="right">9605.220</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">-6492.4589</td>
<td align="right">2233.257</td>
<td align="right">-1629.5949</td>
<td align="right">8725.716</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">-3187.8504</td>
<td align="right">2013.696</td>
<td align="right">-383.4496</td>
<td align="right">5201.546</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: smr_treated_ps_threshold</td>
<td align="right">-4723.4550</td>
<td align="right">-2797.466</td>
<td align="right">-3784.7337</td>
<td align="right">1925.989</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_crump</td>
<td align="right">-10714.8778</td>
<td align="right">4117.079</td>
<td align="right">-309.5310</td>
<td align="right">14831.957</td>
</tr>
</tbody>
</table>
<p>Specifically, with LDW-CPS1, CATT estimates span from $-4,979.99 to $7,201.81, contrasting with the CATT estimated from experimental data which ranges from $-189.40 to $3,835.95, with a mean CATT estimate of $1,713.26. The LDW-PSID1 data shows an even broader CATT estimate range, spanning from $-8,643.02 to $4,903.22, and a notably lower mean of approximately $820.77.</p>
<p>Among the trimmed and top-ranked LDW-CPS1 subsamples, CATT ranges vary substantially. Specific samples such as <code>card</code> or <code>overlap_crump</code> subsamples produce minimum CATTs that are considerably negative, but produce positive mean estimates. Subsamples like <code>ps_threshold</code>, and <code>optimal_pair</code> also deliver positive mean CATT estimates, though with smaller negative minimums, while <code>mahvars</code> is the only method among these to produce a negative mean CATT. Importantly, across all methods, the mean CATT estimates are far away from experimental mean estimate.</p>
<p>The CATT estimates for the LDW-PSID1 trimmed and top-ranked subsamples reveal substantially decreased mean values and wider extremes compared to their CPS1 counterparts, reflecting greater difficulties in producing reliable treatment effect estimates.</p>
<p>This variation in range and means across methods and samples reflects substantial heterogeneity in treatment effect estimation, indicating that while some criteria improve alignment with experimental benchmarks, others introduce considerable discrepancies and variability in estimated heterogeneous effects.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb232-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb232-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb232-2" tabindex="-1"></a><span class="fu">save_catt_panels</span>(all_catt, plot_titles, <span class="at">prefix =</span> <span class="st">&quot;model_a&quot;</span>)</span></code></pre></div>
</div>
<div id="quantile-treatment-effect-on-the-treated-qtet" class="section level3 hasAnchor" number="2.9.3">
<h3><span class="header-section-number">2.9.3</span> Quantile treatment effect on the treated (QTET)<a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>QTET provides a robust way to analyze treatment effect heterogeneity while being less impacted by outliers compared to average treatment effect measures. The QTET estimates are obtained using the propensity score re-weighting method introduced by Firpo (2007). Implementation leverages the <code>qte()</code> function from Imbens and Xu (2024), while visualization employs a modified version of their <code>plot_qte()</code> function.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-1" tabindex="-1"></a><span class="co"># estimate QTET</span></span>
<span id="cb233-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-2" tabindex="-1"></a>qte.ldw <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb233-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-3" tabindex="-1"></a>qte.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps)</span>
<span id="cb233-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-4" tabindex="-1"></a>qte.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid)</span>
<span id="cb233-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-5" tabindex="-1"></a>qte.ldw_cps.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps.trim_match)</span>
<span id="cb233-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb233-6" tabindex="-1"></a>qte.ldw_psid.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid.trim_match) </span></code></pre></div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb234-1" tabindex="-1"></a><span class="co"># estimate QTET</span></span>
<span id="cb234-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb234-2" tabindex="-1"></a>qte.top5_cps_plus  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb234-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb234-3" tabindex="-1"></a>qte.top5_psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-1" tabindex="-1"></a><span class="co"># estimate QTET</span></span>
<span id="cb235-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-2" tabindex="-1"></a>qte.ldw0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw)</span>
<span id="cb235-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-3" tabindex="-1"></a>qte.ldw.cps0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps)</span>
<span id="cb235-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-4" tabindex="-1"></a>qte.ldw.psid0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid)</span>
<span id="cb235-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-5" tabindex="-1"></a>qte.ldw_cps.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps.trim_match)</span>
<span id="cb235-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-6" tabindex="-1"></a>qte.ldw_psid.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid.trim_match)</span>
<span id="cb235-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-7" tabindex="-1"></a>qte.top5_cps_plus0  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span>
<span id="cb235-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb235-8" tabindex="-1"></a>qte.top5_psid_plus0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span></code></pre></div>
<p>Each plot displays three distinct series for every dataset analyzed: (1) The blue line with diamond-shaped points represents QTET estimates derived from the experimental sample, serving as the benchmark. (2) The red line with triangles shows QTET estimates from the observational data before any adjustment. (3) The black line with circles presents QTET estimates for the observational data after applying covariate adjustment.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb236-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb236-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-3" tabindex="-1"></a></span>
<span id="cb236-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-4" tabindex="-1"></a><span class="co"># CPS</span></span>
<span id="cb236-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-5" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps, qte.ldw.cps0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb236-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb236-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-7" tabindex="-1"></a></span>
<span id="cb236-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-8" tabindex="-1"></a><span class="co"># PSID</span></span>
<span id="cb236-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-9" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid, qte.ldw.psid0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb236-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb236-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-11" tabindex="-1"></a></span>
<span id="cb236-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-12" tabindex="-1"></a><span class="do">## CPS trimmed</span></span>
<span id="cb236-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-13" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps.trim, qte.ldw_cps.trim0, qte.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(D) LDW-CPS (Trimmed)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb236-14"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb236-15"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-15" tabindex="-1"></a></span>
<span id="cb236-16"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-16" tabindex="-1"></a><span class="co"># PSID trimmed</span></span>
<span id="cb236-17"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-17" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid.trim, qte.ldw_psid.trim0, qte.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(E) LDW-PSID (Trimmed)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb236-18"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-18" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb236-19"><a href="lalonde-dehejia-wahba-ldw-data.html#cb236-19" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-159-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-159-1.png" alt="FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.150: FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb237-1" tabindex="-1"></a><span class="co"># CPS top methods</span></span>
<span id="cb237-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb237-2" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_cps_plus, qte.top5_cps_plus0, qte.ldw_cps, plot_titles, <span class="at">main_start =</span> <span class="dv">6</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-159-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-159-2.png" alt="FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.151: FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb238-1" tabindex="-1"></a><span class="co"># PSID top methods</span></span>
<span id="cb238-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb238-2" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_psid_plus, qte.top5_psid_plus0, qte.ldw_psid, plot_titles, <span class="at">main_start =</span> <span class="dv">11</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-159-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-159-3.png" alt="FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.152: FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-159-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-159-4.png" alt="FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 2.153: FIGURE A12. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<p>These figures display QTET estimates derived from both the experimental and various observational samples. The QTETs estimated from the original and trimmed LDW-CPS1 sample (B and D) corresponds well with the true QTET, although the estimates are often underpowered. The QTET estimates from the original and trimmed LDW-PSID1 subsample (C and E) show clear biases when compared to the experimental benchmark, which clusters near zero. Among the top-ranked LDW-CPS1-based subsamples, QTETs (F - J) continue to track the true experimental effect well, whereas LDW-PSID1-based subsamples produce QTETs (K - O) that exhibit increased bias and noticeably wider confidence bands, indicating greater estimation uncertainty.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-1" tabindex="-1"></a><span class="co"># list results</span></span>
<span id="cb239-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-2" tabindex="-1"></a>plots_ldw <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb239-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps, <span class="at">mod0 =</span> qte.ldw.cps0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(A) LDW CPS1&quot;</span>),</span>
<span id="cb239-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid, <span class="at">mod0 =</span> qte.ldw.psid0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW PSID1&quot;</span>),</span>
<span id="cb239-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps.trim, <span class="at">mod0 =</span> qte.ldw_cps.trim0, <span class="at">bm =</span> qte.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(C) LDW CPS1 (Trimmed)&quot;</span>),</span>
<span id="cb239-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-6" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid.trim, <span class="at">mod0 =</span> qte.ldw_psid.trim0, <span class="at">bm =</span> qte.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(D) LDW PSID1 (Trimmed)&quot;</span>)</span>
<span id="cb239-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-7" tabindex="-1"></a>)</span>
<span id="cb239-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-8" tabindex="-1"></a></span>
<span id="cb239-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-9" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb239-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-10" tabindex="-1"></a><span class="fu">save_qtet</span>(plots_ldw, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb239-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-11" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_cps_plus, qte.top5_cps_plus0, qte.ldw_cps, plot_titles, <span class="at">main_start =</span> <span class="dv">6</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>), <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_top&quot;</span>)</span>
<span id="cb239-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb239-12" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_psid_plus, qte.top5_psid_plus0, qte.ldw_psid, plot_titles, <span class="at">main_start =</span> <span class="dv">11</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>), <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_top&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-outcome-weights-ow" class="section level3 hasAnchor" number="2.9.4">
<h3><span class="header-section-number">2.9.4</span> Assessing outcome weights (OW)<a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-1" tabindex="-1"></a><span class="co"># list all datasets</span></span>
<span id="cb240-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-2" tabindex="-1"></a>all_datasets <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb240-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-3" tabindex="-1"></a>  <span class="fu">list</span>(ldw, ldw_cps, ldw_psid, ldw_cps.trim_match, ldw_psid.trim_match),</span>
<span id="cb240-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-4" tabindex="-1"></a>  top5_datasets.cps_plus,</span>
<span id="cb240-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-5" tabindex="-1"></a>  top5_datasets.psid_plus</span>
<span id="cb240-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb240-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb241-1" tabindex="-1"></a><span class="co"># estimate ATT </span></span>
<span id="cb241-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb241-2" tabindex="-1"></a>res_att <span class="ot">&lt;-</span> <span class="fu">get_res_att</span>(all_datasets, Y, treat, covar)</span>
<span id="cb241-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb241-3" tabindex="-1"></a><span class="co"># extract outcome weights</span></span>
<span id="cb241-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb241-4" tabindex="-1"></a>ow_att <span class="ot">&lt;-</span> <span class="fu">derive_ow</span>(res_att)</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb242-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb242-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb242-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb242-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb242-3" tabindex="-1"></a><span class="co"># plot outcome weights distribution</span></span>
<span id="cb242-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb242-4" tabindex="-1"></a><span class="fu">plot_ow</span>(ow_att, plot_titles) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-163-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-163-1.png" alt="FIGURE A13. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.154: FIGURE A13. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-163-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-163-2.png" alt="FIGURE A13. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.155: FIGURE A13. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-163-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-163-3.png" alt="FIGURE A13. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.156: FIGURE A13. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-163-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-163-4.png" alt="FIGURE A13. Outcome Weights Model A using LDW Data" width="100%" />
<p class="caption">
Figure 2.157: FIGURE A13. Outcome Weights Model A using LDW Data
</p>
</div>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb243-1" tabindex="-1"></a><span class="co">#evaluate results</span></span>
<span id="cb243-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb243-2" tabindex="-1"></a>res_ow <span class="ot">&lt;-</span> <span class="fu">eval_ow</span>(ow_att, all_datasets, plot_titles, <span class="at">treat_var =</span> treat, <span class="at">estimator =</span> <span class="st">&quot;AIPW-ATT&quot;</span>)</span>
<span id="cb243-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb243-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res_ow, <span class="at">caption =</span> <span class="st">&quot;Outcome Weights for Treated and Untreated&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-164">Table 2.8: </span>Outcome Weights for Treated and Untreated</caption>
<colgroup>
<col width="62%" />
<col width="17%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Sum_Treated</th>
<th align="right">Sum_Untreated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: card</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: mahvars</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: ps_threshold</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: adap_weight_trunc_smr_weight</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: smr_treated_ps_threshold</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_crump</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
</tbody>
</table>
<div class="callout-caution">
<p>The outcome weights are not obtained directly from the ATT point estimates due to computational design of other methods. Instead, the ATT is separately estimated for each dataset following the approach developed by <span class="citation">Knaus and Pfleiderer (<a href="#ref-OW_Package">2024</a>)</span>.</p>
</div>
<p>The evaluation reveals that across each sample the estimated outcome weights sum to one within the treated group and minus one within the untreated group, resulting in an overall sum of zero.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb244-1" tabindex="-1"></a><span class="co">#save results</span></span>
<span id="cb244-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb244-2" tabindex="-1"></a><span class="fu">save_ow</span>(ow_att, plot_titles, <span class="at">prefix =</span> <span class="st">&quot;model_a&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="validation-through-placebo-analyses" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Validation through placebo analyses<a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To further evaluate the credibility of the unconfoundedness assumption, a placebo analysis is performed by designating 1975 earnings (re75) as the outcome variable and omitting both re75 and u75 from the list of covariates. The analysis utilizes all previously considered samples and recomputes the ATT via the function <code>estimate_all</code>, conditioning only on the remaining set of covariates.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb245-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb245-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb245-2" tabindex="-1"></a>Y_pl <span class="ot">&lt;-</span> <span class="st">&quot;re75&quot;</span></span>
<span id="cb245-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb245-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb245-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb245-4" tabindex="-1"></a>covar_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;u74&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb246-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on experimental and observational datasets</span></span>
<span id="cb246-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb246-2" tabindex="-1"></a>out1_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb246-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb246-3" tabindex="-1"></a>out2_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb246-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb246-4" tabindex="-1"></a>out3_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span></code></pre></div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb247-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on trimmed datasets</span></span>
<span id="cb247-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb247-2" tabindex="-1"></a>out4_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps.trim_match, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb247-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb247-3" tabindex="-1"></a>out5_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid.trim_match, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span></code></pre></div>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on top ranked datasets</span></span>
<span id="cb248-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-2" tabindex="-1"></a>out.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl))</span>
<span id="cb248-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-3" tabindex="-1"></a>out.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl))</span>
<span id="cb248-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-4" tabindex="-1"></a>out6_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">1</span>]]</span>
<span id="cb248-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-5" tabindex="-1"></a>out7_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">2</span>]]</span>
<span id="cb248-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-6" tabindex="-1"></a>out8_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">3</span>]]</span>
<span id="cb248-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-7" tabindex="-1"></a>out9_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">4</span>]]</span>
<span id="cb248-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-8" tabindex="-1"></a>out10_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">5</span>]]</span>
<span id="cb248-9"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-9" tabindex="-1"></a>out11_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">1</span>]]</span>
<span id="cb248-10"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-10" tabindex="-1"></a>out12_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">2</span>]]</span>
<span id="cb248-11"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-11" tabindex="-1"></a>out13_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">3</span>]]</span>
<span id="cb248-12"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-12" tabindex="-1"></a>out14_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">4</span>]]</span>
<span id="cb248-13"><a href="lalonde-dehejia-wahba-ldw-data.html#cb248-13" tabindex="-1"></a>out15_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">5</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb249-1" tabindex="-1"></a><span class="co"># collect all placebo results </span></span>
<span id="cb249-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb249-2" tabindex="-1"></a>all_outs.pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl, out4_pl, out5_pl), out.cps_pl, out.psid_pl)</span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb250-1" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb250-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb250-2" tabindex="-1"></a>band_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb250-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb250-3" tabindex="-1"></a>est_pl  <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb250-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb250-4" tabindex="-1"></a>ylim_pl <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>)</span>
<span id="cb250-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb250-5" tabindex="-1"></a><span class="fu">plot_att_panels</span>(all_outs.pl, plot_titles, band_pl, est_pl, ylim_pl, <span class="at">textsize =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-171-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-171-1.png" alt="FIGURE A14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.158: FIGURE A14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-171-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-171-2.png" alt="FIGURE A14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.159: FIGURE A14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-171-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-171-3.png" alt="FIGURE A14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.160: FIGURE A14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-171-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-171-4.png" alt="FIGURE A14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 2.161: FIGURE A14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb251-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb251-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb251-2" tabindex="-1"></a><span class="fu">save_att_panels</span>(all_outs.pl, plot_titles, band_pl, est_pl, <span class="st">&quot;model_a_placebo&quot;</span>)</span></code></pre></div>
<p>The placebo ATT results are presented in the table below:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb252-1" tabindex="-1"></a><span class="co"># print placebo results</span></span>
<span id="cb252-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb252-2" tabindex="-1"></a>result_mat_pl <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs.pl, plot_titles)</span>
<span id="cb252-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb252-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result_mat_pl, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">&quot;Placebo ATT Estimates and SEs&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-173">Table 2.9: </span>Placebo ATT Estimates and SEs</caption>
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="8%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="7%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">(A) LDW-Experimental</th>
<th align="left"></th>
<th align="left">(B) LDW-CPS1</th>
<th align="left"></th>
<th align="left">(C) LDW-PSID1</th>
<th align="left"></th>
<th align="left">(D) Trimmed LDW-CPS1</th>
<th align="left"></th>
<th align="left">(E) Trimmed LDW-PSID1</th>
<th align="left"></th>
<th align="left">(F) Top CPS1: card</th>
<th align="left"></th>
<th align="left">(G) Top CPS1: mahvars</th>
<th align="left"></th>
<th align="left">(H) Top CPS1: ps_threshold</th>
<th align="left"></th>
<th align="left">(I) Top CPS1: adap_weight_trunc_smr_weight</th>
<th align="left"></th>
<th align="left">(J) Top CPS1: optimal_pair</th>
<th align="left"></th>
<th align="left">(K) Top PSID1: card</th>
<th align="left"></th>
<th align="left">(L) Top PSID1: mahvars</th>
<th align="left"></th>
<th align="left">(M) Top PSID1: ps_threshold</th>
<th align="left"></th>
<th align="left">(N) Top PSID1: smr_treated_ps_threshold</th>
<th align="left"></th>
<th align="left">(O) Top PSID1: overlap_crump</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Experimental Benchmark</td>
<td align="left">265.15</td>
<td align="left">(305.00)</td>
<td align="left">-12118.75</td>
<td align="left">(247.18)</td>
<td align="left">-17531.28</td>
<td align="left">(360.60)</td>
<td align="left">-654.26</td>
<td align="left">(419.29)</td>
<td align="left">-74.95</td>
<td align="left">(660.61)</td>
<td align="left">-300.03</td>
<td align="left">(257.91)</td>
<td align="left">126.08</td>
<td align="left">(309.13)</td>
<td align="left">-654.26</td>
<td align="left">(419.29)</td>
<td align="left">-12273.67</td>
<td align="left">(166.25)</td>
<td align="left">-748.14</td>
<td align="left">(238.52)</td>
<td align="left">-314.46</td>
<td align="left">(453.40)</td>
<td align="left">-416.97</td>
<td align="left">(671.84)</td>
<td align="left">-74.95</td>
<td align="left">(660.61)</td>
<td align="left">-536.15</td>
<td align="left">(1431.37)</td>
<td align="left">-6812.45</td>
<td align="left">(322.20)</td>
</tr>
<tr class="even">
<td align="left">diff</td>
<td align="left">265.15</td>
<td align="left">(305.00)</td>
<td align="left">-12118.75</td>
<td align="left">(247.18)</td>
<td align="left">-17531.28</td>
<td align="left">(360.60)</td>
<td align="left">-654.26</td>
<td align="left">(419.29)</td>
<td align="left">-74.95</td>
<td align="left">(660.61)</td>
<td align="left">-300.03</td>
<td align="left">(257.91)</td>
<td align="left">126.08</td>
<td align="left">(309.13)</td>
<td align="left">-654.26</td>
<td align="left">(419.29)</td>
<td align="left">-12273.67</td>
<td align="left">(166.25)</td>
<td align="left">-748.14</td>
<td align="left">(238.52)</td>
<td align="left">-314.46</td>
<td align="left">(453.40)</td>
<td align="left">-416.97</td>
<td align="left">(671.84)</td>
<td align="left">-74.95</td>
<td align="left">(660.61)</td>
<td align="left">-536.15</td>
<td align="left">(1431.37)</td>
<td align="left">-6812.45</td>
<td align="left">(322.20)</td>
</tr>
<tr class="odd">
<td align="left">reg</td>
<td align="left">224.34</td>
<td align="left">(218.33)</td>
<td align="left">-1134.82</td>
<td align="left">(272.44)</td>
<td align="left">-2757.40</td>
<td align="left">(589.02)</td>
<td align="left">-516.55</td>
<td align="left">(330.19)</td>
<td align="left">-100.13</td>
<td align="left">(683.14)</td>
<td align="left">-366.41</td>
<td align="left">(206.44)</td>
<td align="left">110.98</td>
<td align="left">(217.76)</td>
<td align="left">-516.55</td>
<td align="left">(330.19)</td>
<td align="left">-1291.77</td>
<td align="left">(200.97)</td>
<td align="left">-178.54</td>
<td align="left">(186.94)</td>
<td align="left">-439.52</td>
<td align="left">(382.05)</td>
<td align="left">-184.84</td>
<td align="left">(498.66)</td>
<td align="left">-100.13</td>
<td align="left">(683.14)</td>
<td align="left">238.72</td>
<td align="left">(1464.13)</td>
<td align="left">-4076.11</td>
<td align="left">(505.87)</td>
</tr>
<tr class="even">
<td align="left">om.reg</td>
<td align="left">165.70</td>
<td align="left">(284.98)</td>
<td align="left">-1096.70</td>
<td align="left">(395.18)</td>
<td align="left">-2640.76</td>
<td align="left">(367.46)</td>
<td align="left">-450.69</td>
<td align="left">(320.92)</td>
<td align="left">-205.47</td>
<td align="left">(498.80)</td>
<td align="left">-515.22</td>
<td align="left">(225.11)</td>
<td align="left">145.67</td>
<td align="left">(278.37)</td>
<td align="left">-450.69</td>
<td align="left">(320.92)</td>
<td align="left">-1207.48</td>
<td align="left">(265.59)</td>
<td align="left">-385.86</td>
<td align="left">(192.96)</td>
<td align="left">-521.12</td>
<td align="left">(393.05)</td>
<td align="left">-242.11</td>
<td align="left">(581.06)</td>
<td align="left">-205.47</td>
<td align="left">(498.80)</td>
<td align="left">774.73</td>
<td align="left">(2024.32)</td>
<td align="left">-4794.24</td>
<td align="left">(230.26)</td>
</tr>
<tr class="odd">
<td align="left">om.grf</td>
<td align="left">107.08</td>
<td align="left">(283.71)</td>
<td align="left">-1590.61</td>
<td align="left">(373.01)</td>
<td align="left">-4290.47</td>
<td align="left">(343.87)</td>
<td align="left">-586.38</td>
<td align="left">(304.18)</td>
<td align="left">-20.75</td>
<td align="left">(483.64)</td>
<td align="left">-364.13</td>
<td align="left">(201.15)</td>
<td align="left">104.88</td>
<td align="left">(260.17)</td>
<td align="left">-583.50</td>
<td align="left">(303.95)</td>
<td align="left">-1681.70</td>
<td align="left">(246.46)</td>
<td align="left">-261.57</td>
<td align="left">(180.20)</td>
<td align="left">5.42</td>
<td align="left">(383.41)</td>
<td align="left">-182.80</td>
<td align="left">(524.07)</td>
<td align="left">-76.67</td>
<td align="left">(483.59)</td>
<td align="left">-548.47</td>
<td align="left">(1087.95)</td>
<td align="left">-3616.38</td>
<td align="left">(224.10)</td>
</tr>
<tr class="even">
<td align="left">matching</td>
<td align="left">148.67</td>
<td align="left">(227.58)</td>
<td align="left">-1465.93</td>
<td align="left">(351.78)</td>
<td align="left">-1913.65</td>
<td align="left">(805.37)</td>
<td align="left">-761.19</td>
<td align="left">(322.26)</td>
<td align="left">-315.32</td>
<td align="left">(672.37)</td>
<td align="left">-708.53</td>
<td align="left">(275.03)</td>
<td align="left">-23.90</td>
<td align="left">(222.75)</td>
<td align="left">-761.19</td>
<td align="left">(322.26)</td>
<td align="left">-1550.10</td>
<td align="left">(309.19)</td>
<td align="left">-609.49</td>
<td align="left">(251.48)</td>
<td align="left">-182.96</td>
<td align="left">(488.69)</td>
<td align="left">-469.12</td>
<td align="left">(484.86)</td>
<td align="left">-315.32</td>
<td align="left">(672.37)</td>
<td align="left">682.41</td>
<td align="left">(794.17)</td>
<td align="left">-1951.37</td>
<td align="left">(803.45)</td>
</tr>
<tr class="odd">
<td align="left">psm</td>
<td align="left">95.59</td>
<td align="left">(316.23)</td>
<td align="left">-1335.04</td>
<td align="left">(425.34)</td>
<td align="left">-2792.68</td>
<td align="left">(496.82)</td>
<td align="left">-732.18</td>
<td align="left">(416.01)</td>
<td align="left">-658.19</td>
<td align="left">(652.82)</td>
<td align="left">-353.07</td>
<td align="left">(248.00)</td>
<td align="left">-88.56</td>
<td align="left">(322.39)</td>
<td align="left">-732.18</td>
<td align="left">(416.01)</td>
<td align="left">-1332.28</td>
<td align="left">(256.18)</td>
<td align="left">-429.68</td>
<td align="left">(207.48)</td>
<td align="left">-243.04</td>
<td align="left">(425.74)</td>
<td align="left">-236.12</td>
<td align="left">(631.41)</td>
<td align="left">-658.19</td>
<td align="left">(652.82)</td>
<td align="left">-948.80</td>
<td align="left">(2840.39)</td>
<td align="left">-2237.36</td>
<td align="left">(311.21)</td>
</tr>
<tr class="even">
<td align="left">ipw</td>
<td align="left">160.63</td>
<td align="left">(311.24)</td>
<td align="left">-1515.20</td>
<td align="left">(334.86)</td>
<td align="left">-3151.45</td>
<td align="left">(739.64)</td>
<td align="left">-688.73</td>
<td align="left">(427.16)</td>
<td align="left">-163.34</td>
<td align="left">(666.18)</td>
<td align="left">-300.03</td>
<td align="left">(257.91)</td>
<td align="left">126.08</td>
<td align="left">(309.13)</td>
<td align="left">-688.73</td>
<td align="left">(427.16)</td>
<td align="left">-1424.29</td>
<td align="left">(321.12)</td>
<td align="left">-748.14</td>
<td align="left">(238.52)</td>
<td align="left">-314.46</td>
<td align="left">(453.40)</td>
<td align="left">-416.97</td>
<td align="left">(671.84)</td>
<td align="left">-163.34</td>
<td align="left">(666.18)</td>
<td align="left">-452.88</td>
<td align="left">(1355.84)</td>
<td align="left">-2191.35</td>
<td align="left">(822.44)</td>
</tr>
<tr class="odd">
<td align="left">cbps</td>
<td align="left">188.34</td>
<td align="left">(304.79)</td>
<td align="left">-1227.83</td>
<td align="left">(297.89)</td>
<td align="left">-2282.31</td>
<td align="left">(834.92)</td>
<td align="left">-446.97</td>
<td align="left">(404.83)</td>
<td align="left">-361.39</td>
<td align="left">(826.77)</td>
<td align="left">-300.03</td>
<td align="left">(257.91)</td>
<td align="left">126.08</td>
<td align="left">(309.13)</td>
<td align="left">-446.97</td>
<td align="left">(404.83)</td>
<td align="left">-1374.33</td>
<td align="left">(244.90)</td>
<td align="left">-748.14</td>
<td align="left">(238.52)</td>
<td align="left">-314.46</td>
<td align="left">(453.40)</td>
<td align="left">-416.97</td>
<td align="left">(671.84)</td>
<td align="left">-361.39</td>
<td align="left">(826.77)</td>
<td align="left">473.19</td>
<td align="left">(1270.59)</td>
<td align="left">-2244.70</td>
<td align="left">(827.79)</td>
</tr>
<tr class="even">
<td align="left">ebal</td>
<td align="left">189.20</td>
<td align="left">(304.71)</td>
<td align="left">-1228.49</td>
<td align="left">(297.88)</td>
<td align="left">-2250.80</td>
<td align="left">(842.15)</td>
<td align="left">-415.77</td>
<td align="left">(400.12)</td>
<td align="left">-361.41</td>
<td align="left">(826.77)</td>
<td align="left">-518.64</td>
<td align="left">(324.44)</td>
<td align="left">164.57</td>
<td align="left">(317.64)</td>
<td align="left">-415.77</td>
<td align="left">(400.12)</td>
<td align="left">-1360.93</td>
<td align="left">(244.68)</td>
<td align="left">-306.53</td>
<td align="left">(227.36)</td>
<td align="left">-456.28</td>
<td align="left">(492.94)</td>
<td align="left">-222.37</td>
<td align="left">(653.59)</td>
<td align="left">-361.41</td>
<td align="left">(826.77)</td>
<td align="left">513.96</td>
<td align="left">(1293.21)</td>
<td align="left">-2127.56</td>
<td align="left">(798.86)</td>
</tr>
<tr class="odd">
<td align="left">dml</td>
<td align="left">275.69</td>
<td align="left">(231.57)</td>
<td align="left">-1152.96</td>
<td align="left">(271.75)</td>
<td align="left">-2725.28</td>
<td align="left">(591.57)</td>
<td align="left">-404.20</td>
<td align="left">(345.98)</td>
<td align="left">-204.84</td>
<td align="left">(682.64)</td>
<td align="left">-375.70</td>
<td align="left">(205.10)</td>
<td align="left">113.17</td>
<td align="left">(221.60)</td>
<td align="left">-404.20</td>
<td align="left">(345.98)</td>
<td align="left">-1289.20</td>
<td align="left">(200.80)</td>
<td align="left">-184.41</td>
<td align="left">(186.39)</td>
<td align="left">-509.80</td>
<td align="left">(381.79)</td>
<td align="left">-72.30</td>
<td align="left">(484.27)</td>
<td align="left">-204.84</td>
<td align="left">(682.64)</td>
<td align="left">35.92</td>
<td align="left">(1500.90)</td>
<td align="left">-4016.45</td>
<td align="left">(505.87)</td>
</tr>
<tr class="even">
<td align="left">aipw_grf</td>
<td align="left">83.05</td>
<td align="left">(228.21)</td>
<td align="left">-1249.88</td>
<td align="left">(264.79)</td>
<td align="left">-2419.46</td>
<td align="left">(623.46)</td>
<td align="left">-586.40</td>
<td align="left">(365.00)</td>
<td align="left">-141.38</td>
<td align="left">(577.59)</td>
<td align="left">-274.18</td>
<td align="left">(259.11)</td>
<td align="left">88.88</td>
<td align="left">(235.81)</td>
<td align="left">-586.40</td>
<td align="left">(365.00)</td>
<td align="left">-1299.48</td>
<td align="left">(237.97)</td>
<td align="left">-287.21</td>
<td align="left">(212.05)</td>
<td align="left">-34.90</td>
<td align="left">(374.85)</td>
<td align="left">-214.28</td>
<td align="left">(508.94)</td>
<td align="left">-141.38</td>
<td align="left">(577.59)</td>
<td align="left">-760.93</td>
<td align="left">(1523.38)</td>
<td align="left">-2124.31</td>
<td align="left">(698.56)</td>
</tr>
<tr class="odd">
<td align="left">aipw_ow</td>
<td align="left">108.01</td>
<td align="left">(233.22)</td>
<td align="left">-1318.36</td>
<td align="left">(276.40)</td>
<td align="left">-2904.04</td>
<td align="left">(648.78)</td>
<td align="left">-618.87</td>
<td align="left">(365.07)</td>
<td align="left">47.81</td>
<td align="left">(619.87)</td>
<td align="left">-336.51</td>
<td align="left">(239.41)</td>
<td align="left">91.41</td>
<td align="left">(259.16)</td>
<td align="left">-618.87</td>
<td align="left">(365.07)</td>
<td align="left">-1377.59</td>
<td align="left">(216.49)</td>
<td align="left">-346.13</td>
<td align="left">(230.48)</td>
<td align="left">-12.66</td>
<td align="left">(369.88)</td>
<td align="left">-407.28</td>
<td align="left">(566.49)</td>
<td align="left">47.81</td>
<td align="left">(619.87)</td>
<td align="left">-835.50</td>
<td align="left">(1497.03)</td>
<td align="left">-2678.40</td>
<td align="left">(625.67)</td>
</tr>
</tbody>
</table>
<p>The placebo analysis reveals that the experimental benchmarks are positive, near zero and statistically insignificant, while all estimators applied to the observational datasets, LDW-CPS1 and LDW-PSID1, yield by majority large, negative ATT estimates.</p>
<p>For LDW-CPS1, most ATT estimates are negative. The <code>overlap_crump</code> subsample shows a modest improvement toward the experimental benchmark compared to LDW-CPS1 (B) results, but also produces notably poorer estimates for certain estimators. The trimmed subsamples (D) and (I), which use similar approaches, further improve upon the LDW-CPS1 (B) results. The <code>optimal_pair</code> and <code>card</code> subsamples provide even greater improvement. The <code>mahvars</code> (G) subsample delivers ATT estimates closest to the experimental benchmark and is the only case to yield positive ATT estimates across the LDW-CPS1 samples.</p>
<p>For LDW-PSID1, the subsample (O) applying the <code>overlap_common_range</code> method shows no improvement compared to the LDW-PSID1 sample (C) except for the <code>Diff-in-Means</code> estimator. The <code>overlap_crump</code> subsample generally delivers ATT estimates closer to the experimental benchmark, while the <code>card</code> and <code>mahvars</code> subsamples producing estimates even closer to the experimental benchmark. The trimmed subsamples (E) and (N), which use similar approaches, achieve the closest alignment with the benchmark.</p>
<p>Across most estimators and observational top-ranked subsamples (F–O) the placebo analysis reveals substantial bias and deviation from the true effect, highlighting the persistent challenges in adjusting for confounding using observational data. This underlines the limitations of these methods in recovering unbiased ATT estimates outside of randomized experimental settings.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb253-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb253-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb253-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat_pl, <span class="st">&quot;LDW_att_estimates_pl_model_a&quot;</span>)</span></code></pre></div>
</div>
<div id="validation-through-sensitivity-analyses" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Validation through sensitivity analyses<a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, a sensitivity analyses using the LDW data is conducted and results are depicted in contour plots using the function <code>sens_ana</code> of Imbens &amp; Xu (2024).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb254-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb254-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb254-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span></span>
<span id="cb254-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb254-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb254-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb254-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>)</span>
<span id="cb254-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb254-5" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;re75&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb255-1" tabindex="-1"></a><span class="co"># check for valid datasets </span></span>
<span id="cb255-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb255-2" tabindex="-1"></a>datasets_sens <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(ldw, ldw_cps, ldw_psid), top5_datasets.cps_plus, top5_datasets.psid_plus)</span>
<span id="cb255-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb255-3" tabindex="-1"></a>filtered_datasets_sens <span class="ot">&lt;-</span> <span class="fu">check_filter_datasets</span>(datasets_sens, Y, treat, covar, bm)</span></code></pre></div>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb256-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb256-3"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-3" tabindex="-1"></a><span class="co"># loop over valid datasets and assign index</span></span>
<span id="cb256-4"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(filtered_datasets_sens)) {</span>
<span id="cb256-5"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-5" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(datasets_sens, identical, filtered_datasets_sens[[i]]))</span>
<span id="cb256-6"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-6" tabindex="-1"></a>    <span class="fu">sens_ana</span>(filtered_datasets_sens[[i]], Y, treat, covar, bm, <span class="at">kd =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb256-7"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-7" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> plot_titles[idx])</span>
<span id="cb256-8"><a href="lalonde-dehejia-wahba-ldw-data.html#cb256-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-177-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-177-1.png" alt="FIGURE A15. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.162: FIGURE A15. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-177-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-177-2.png" alt="FIGURE A15. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.163: FIGURE A15. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-177-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-177-3.png" alt="FIGURE A15. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.164: FIGURE A15. Sensitivity Analyses Model A
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-177-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-177-4.png" alt="FIGURE A15. Sensitivity Analyses Model A" width="100%" />
<p class="caption">
Figure 2.165: FIGURE A15. Sensitivity Analyses Model A
</p>
</div>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="lalonde-dehejia-wahba-ldw-data.html#cb257-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb257-2"><a href="lalonde-dehejia-wahba-ldw-data.html#cb257-2" tabindex="-1"></a><span class="fu">save_sensitivity_plots</span>(filtered_datasets_sens, Y, treat, covar, bm, plot_titles, <span class="st">&quot;model_a&quot;</span>)</span></code></pre></div>
<p>The sensitivity analysis shows that for most samples, the estimated treatment effects are fairly robust to increasing confounder strength, as indicated by relatively stable values despite up to triple the correlation levels of <code>re75</code>. Notably, some samples such as LDW-PSID1 exhibit a greater sensitivity with more pronounced swings including negative estimates at higher confounder strengths, contrasting with consistent positive effects in LDW-CPS1 variants. This highlights sample-specific differences in robustness against potential unobserved confounding.</p>
<div class="callout-tip">
<p>The analyses suggest that some samples maintain stable treatment effect estimates despite increasing confounder strength, while others show greater sensitivity. This highlights the importance of assessing robustness across different samples (respectively methods used to derive specific samples) to account for potential unobserved bias.</p>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="2.12">
<h2><span class="header-section-number">2.12</span> Summary<a href="lalonde-dehejia-wahba-ldw-data.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After reexamining model A, that is based on the LaLonde-Dehejia-Wahba (LDW) data and its augmented versions with control groups from CPS-1 and PSID-1, several insights into causal inference challenges emerge. First, we confirm that ensuring overlap between treated and control groups remains crucial for credible causal estimation. The LDW-Experimental data exhibit excellent overlap, while the observational datasets (LDW-CPS1 and LDW-PSID1) show weaker overlap, with many treated units outside the control range. Augmenting these datasets with experimental controls improves overlap but does not consistently improve covariate balance.</p>
<p>Second, controlling for covariates such as age, education, race, and prior earnings, and using various methods including matching, weighting, truncation, trimming, and combined approaches, largely yields consistent effects. The propensity score plays an important role in assessing overlap and balancing covariates across groups.</p>
<p>Third, the LDW dataset is somewhat unique in that most methods approximate the experimental benchmark well for average treatment effects on the treated (ATT), an achievement not fully replicated in the original LaLonde samples. However, placebo tests using pre-treatment earnings and sensitivity analyses reveal lingering concerns about the unconfoundedness assumption and robustness of some estimators.</p>
<p>Overall, this chapter highlights the importance of overlap and covariate balance, the utility of propensity scores, and the need for rigorous validation of treatment assignment assumptions to produce credible causal estimates. Despite improvements in data and methods, tests of unconfoundedness via placebo outcomes suggest caution in interpreting causal effects.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-imbens2024" class="csl-entry">
Imbens, Guido W., and Yiqing Xu. 2024. <span>“LaLonde (1986) After Nearly Four Decades: Lessons Learned.”</span>
</div>
<div id="ref-OW_Package" class="csl-entry">
Knaus, Michael C., and Henri Pfleiderer. 2024. <span>“Outcome Weights.”</span>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lalonde-dehejia-wahba-ldw-data-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study/edit/main/tutorial/02-LDW-Model-A.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Outcome-Weights.pdf", "Outcome-Weights.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
