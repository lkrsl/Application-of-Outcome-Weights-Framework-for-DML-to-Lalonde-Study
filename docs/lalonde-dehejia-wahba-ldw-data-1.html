<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</title>
  <meta name="description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  <meta name="github-repo" content="lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  
  <meta name="twitter:description" content="<p>This book replicates the LaLonde study by Imbens &amp; Xu (2024) and extends it by comparing a
full with a reduced covariate model to mitigate potential confounding.
It evaluates various methods to improve overlap and covariate balance for robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to assess another estimator and analyse the distributional properties of outcome weights.
The analysis draws on the original LaLonde dataset as well as the LaLonde–Dehejia–Wahba (LDW) and LaLonde–Calónico–Smith (LCS) datasets.</p>" />
  

<meta name="author" content="Laura Kreisel" />


<meta name="date" content="2025-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lalonde-dehejia-wahba-ldw-data.html"/>
<link rel="next" href="lalonde-nsw-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.34.0/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tutorial/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Application of Outcome Weights Framework for DML to Lalonde Study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#wrapper-functions"><i class="fa fa-check"></i><b>1.2</b> Wrapper functions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started.html"><a href="getting-started.html#overview"><i class="fa fa-check"></i><b>1.2.1</b> Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started.html"><a href="getting-started.html#inspection"><i class="fa fa-check"></i><b>1.2.2</b> Inspection</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started.html"><a href="getting-started.html#improving-covariate-balance-and-overlap"><i class="fa fa-check"></i><b>1.2.3</b> Improving covariate balance and overlap</a></li>
<li class="chapter" data-level="1.2.4" data-path="getting-started.html"><a href="getting-started.html#assessing-methods"><i class="fa fa-check"></i><b>1.2.4</b> Assessing methods</a></li>
<li class="chapter" data-level="1.2.5" data-path="getting-started.html"><a href="getting-started.html#identifying-best-methods"><i class="fa fa-check"></i><b>1.2.5</b> Identifying best methods</a></li>
<li class="chapter" data-level="1.2.6" data-path="getting-started.html"><a href="getting-started.html#estimating"><i class="fa fa-check"></i><b>1.2.6</b> Estimating</a></li>
<li class="chapter" data-level="1.2.7" data-path="getting-started.html"><a href="getting-started.html#outcome-weights-analysis"><i class="fa fa-check"></i><b>1.2.7</b> Outcome weights analysis</a></li>
<li class="chapter" data-level="1.2.8" data-path="getting-started.html"><a href="getting-started.html#sensitivity-analysis"><i class="fa fa-check"></i><b>1.2.8</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="1.2.9" data-path="getting-started.html"><a href="getting-started.html#balance-analysis"><i class="fa fa-check"></i><b>1.2.9</b> Balance analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html"><i class="fa fa-check"></i><b>2</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#set-up"><i class="fa fa-check"></i><b>2.1</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data"><i class="fa fa-check"></i><b>2.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="2.1.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data"><i class="fa fa-check"></i><b>2.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="2.1.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data"><i class="fa fa-check"></i><b>2.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#model-a"><i class="fa fa-check"></i><b>2.2</b> Model A</a></li>
<li class="chapter" data-level="2.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#pre-assessing-methods"><i class="fa fa-check"></i><b>2.3</b> Pre-assessing methods</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#overlap"><i class="fa fa-check"></i><b>2.3.1</b> Overlap</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-overlap"><i class="fa fa-check"></i><b>2.4</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#single-methods"><i class="fa fa-check"></i><b>2.4.1</b> Single methods</a></li>
<li class="chapter" data-level="2.4.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-2"><i class="fa fa-check"></i><b>2.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#post-assessing-methods"><i class="fa fa-check"></i><b>2.5</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#single-methods-1"><i class="fa fa-check"></i><b>2.5.1</b> Single methods</a></li>
<li class="chapter" data-level="2.5.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-3"><i class="fa fa-check"></i><b>2.5.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#identifying-most-efficient-methods"><i class="fa fa-check"></i><b>2.6</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#ranking"><i class="fa fa-check"></i><b>2.6.1</b> Ranking</a></li>
<li class="chapter" data-level="2.6.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#sample-construction"><i class="fa fa-check"></i><b>2.6.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1"><i class="fa fa-check"></i><b>2.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att"><i class="fa fa-check"></i><b>2.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="2.7.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1"><i class="fa fa-check"></i><b>2.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="2.7.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet"><i class="fa fa-check"></i><b>2.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="2.7.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow"><i class="fa fa-check"></i><b>2.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses"><i class="fa fa-check"></i><b>2.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="2.9" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses"><i class="fa fa-check"></i><b>2.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="2.10" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspection-of-re74-and-re75"><i class="fa fa-check"></i><b>2.10</b> Inspection of re74 and re75</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#correlation"><i class="fa fa-check"></i><b>2.10.1</b> Correlation</a></li>
<li class="chapter" data-level="2.10.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#distributional-balance"><i class="fa fa-check"></i><b>2.10.2</b> Distributional balance</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#summary"><i class="fa fa-check"></i><b>2.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html"><i class="fa fa-check"></i><b>3</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1"><i class="fa fa-check"></i><b>3.1</b> Set up</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1"><i class="fa fa-check"></i><b>3.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="3.1.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1"><i class="fa fa-check"></i><b>3.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="3.1.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#model-b"><i class="fa fa-check"></i><b>3.2</b> Model B</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#pre-assessing-methods-1"><i class="fa fa-check"></i><b>3.2.1</b> Pre-assessing methods</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-overlap-1"><i class="fa fa-check"></i><b>3.3</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-2"><i class="fa fa-check"></i><b>3.3.1</b> Single methods</a></li>
<li class="chapter" data-level="3.3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-4"><i class="fa fa-check"></i><b>3.3.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#post-assessing-methods-1"><i class="fa fa-check"></i><b>3.4</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-3"><i class="fa fa-check"></i><b>3.4.1</b> Single methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-5"><i class="fa fa-check"></i><b>3.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#identifying-most-efficient-methods-1"><i class="fa fa-check"></i><b>3.5</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#ranking-1"><i class="fa fa-check"></i><b>3.5.1</b> Ranking</a></li>
<li class="chapter" data-level="3.5.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#sample-construction-1"><i class="fa fa-check"></i><b>3.5.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2"><i class="fa fa-check"></i><b>3.6</b> Estimating</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1"><i class="fa fa-check"></i><b>3.6.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="3.6.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2"><i class="fa fa-check"></i><b>3.6.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="3.6.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1"><i class="fa fa-check"></i><b>3.6.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="3.6.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1"><i class="fa fa-check"></i><b>3.6.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1"><i class="fa fa-check"></i><b>3.7</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="3.8" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1"><i class="fa fa-check"></i><b>3.8</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="3.9" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspection-of-re74-and-re75-1"><i class="fa fa-check"></i><b>3.9</b> Inspection of re74 and re75</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#correlation-1"><i class="fa fa-check"></i><b>3.9.1</b> Correlation</a></li>
<li class="chapter" data-level="3.9.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#distributional-balance-1"><i class="fa fa-check"></i><b>3.9.2</b> Distributional balance</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1"><i class="fa fa-check"></i><b>3.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html"><i class="fa fa-check"></i><b>4</b> LaLonde (NSW) Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#set-up-2"><i class="fa fa-check"></i><b>4.1</b> Set up</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#source-functions-and-load-data-2"><i class="fa fa-check"></i><b>4.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="4.1.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#load-and-preprocess-data-2"><i class="fa fa-check"></i><b>4.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="4.1.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#inspect-data-2"><i class="fa fa-check"></i><b>4.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#nsw"><i class="fa fa-check"></i><b>4.2</b> NSW</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#pre-assessing-methods-2"><i class="fa fa-check"></i><b>4.2.1</b> Pre-assessing methods</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-overlap-2"><i class="fa fa-check"></i><b>4.3</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#single-methods-4"><i class="fa fa-check"></i><b>4.3.1</b> Single methods</a></li>
<li class="chapter" data-level="4.3.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-6"><i class="fa fa-check"></i><b>4.3.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#post-assessing-methods-2"><i class="fa fa-check"></i><b>4.4</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#single-methods-5"><i class="fa fa-check"></i><b>4.4.1</b> Single methods</a></li>
<li class="chapter" data-level="4.4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-7"><i class="fa fa-check"></i><b>4.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#identifying-most-efficient-methods-2"><i class="fa fa-check"></i><b>4.5</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#ranking-2"><i class="fa fa-check"></i><b>4.5.1</b> Ranking</a></li>
<li class="chapter" data-level="4.5.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#sample-construction-2"><i class="fa fa-check"></i><b>4.5.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#estimating-3"><i class="fa fa-check"></i><b>4.6</b> Estimating</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#average-treatment-effect-on-the-treated-att-2"><i class="fa fa-check"></i><b>4.6.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="4.6.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#conditional-average-treatment-effect-on-the-treated-catt-3"><i class="fa fa-check"></i><b>4.6.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="4.6.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#quantile-treatment-effect-on-the-treated-qtet-2"><i class="fa fa-check"></i><b>4.6.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="4.6.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-outcome-weights-ow-2"><i class="fa fa-check"></i><b>4.6.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#validation-through-sensitivity-analyses-2"><i class="fa fa-check"></i><b>4.7</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="4.8" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#summary-2"><i class="fa fa-check"></i><b>4.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html"><i class="fa fa-check"></i><b>5</b> LaLonde-Calónico-Smith (LCS) Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#set-up-3"><i class="fa fa-check"></i><b>5.1</b> Set up</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#source-functions-and-load-data-3"><i class="fa fa-check"></i><b>5.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="5.1.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#load-and-preprocess-data-3"><i class="fa fa-check"></i><b>5.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="5.1.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#inspect-data-3"><i class="fa fa-check"></i><b>5.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#model"><i class="fa fa-check"></i><b>5.2</b> Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#pre-assessing-methods-3"><i class="fa fa-check"></i><b>5.2.1</b> Pre-assessing methods</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-overlap-3"><i class="fa fa-check"></i><b>5.3</b> Improving overlap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#single-methods-6"><i class="fa fa-check"></i><b>5.3.1</b> Single methods</a></li>
<li class="chapter" data-level="5.3.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-8"><i class="fa fa-check"></i><b>5.3.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#post-assessing-methods-3"><i class="fa fa-check"></i><b>5.4</b> Post-assessing methods</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#single-methods-7"><i class="fa fa-check"></i><b>5.4.1</b> Single methods</a></li>
<li class="chapter" data-level="5.4.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-9"><i class="fa fa-check"></i><b>5.4.2</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#identifying-most-efficient-methods-3"><i class="fa fa-check"></i><b>5.5</b> Identifying most efficient methods</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#ranking-3"><i class="fa fa-check"></i><b>5.5.1</b> Ranking</a></li>
<li class="chapter" data-level="5.5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#sample-construction-3"><i class="fa fa-check"></i><b>5.5.2</b> Sample construction</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#estimating-4"><i class="fa fa-check"></i><b>5.6</b> Estimating</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#average-treatment-effect-on-the-treated-att-3"><i class="fa fa-check"></i><b>5.6.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="5.6.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#conditional-average-treatment-effect-on-the-treated-catt-4"><i class="fa fa-check"></i><b>5.6.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="5.6.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#quantile-treatment-effect-on-the-treated-qtet-3"><i class="fa fa-check"></i><b>5.6.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="5.6.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-outcome-weights-ow-3"><i class="fa fa-check"></i><b>5.6.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-placebo-analyses-2"><i class="fa fa-check"></i><b>5.7</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="5.8" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-sensitivity-analyses-3"><i class="fa fa-check"></i><b>5.8</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="5.9" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#summary-3"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lalonde-dehejia-wahba-ldw-data-1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> LaLonde-Dehejia-Wahba (LDW) Data<a href="lalonde-dehejia-wahba-ldw-data-1.html#lalonde-dehejia-wahba-ldw-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section (3) covers model B, which, similar to model A, uses 1978 earnings (<code>re78</code>) as the outcome variable but adjusts for a slightly different set of covariates: age, education, race indicators (<code>black</code>, <code>hispanic</code>), marital status (<code>married</code>), high school dropouts (<code>nodegree</code>), 1975 earnings (<code>re75</code>), and unemployment status in 1974 and 1975 (<code>u74</code>, <code>u75</code>), explicitly excluding 1974 earnings (<code>re74</code>) to identify potential multicollinearity or confounding. The model is specified via a regression formula based on these covariates. To enhance covariate balance between treated and untreated groups, the same comprehensive suite of methods is employed as in model A, organized into two categories. From these approaches, the top five methods are selected based on a the overlapping coefficient (OVL) and reranked by the mean absolute standardized mean difference (ASMD), and their resulting samples are used to inform subsequent analysis. Notably, the estimation of the average treatment effect on the treated (ATT) incorporates also incorporates the augmented inverse probability weighting (AIPW) estimator from the <code>OutcomeWeights</code> R package. Subsequently, alternative estimands are considered, including the conditional average treatment effect for the treated (CATT) and the quantile treatment effect on the treated (QTET). After estimating these effects, outcome weights are analyzed to identify patterns in the contribution of individual observations to the ATT. Placebo tests are then conducted using 1975 earnings (<code>re75</code>) as the outcome variable to assess potential biases and the validity of the unconfoundedness assumption. Finally, sensitivity analyses are performed to evaluate the robustness of the treatment effect estimates to violations of these assumptions.</p>
<p>For detailed explanations of the analysis steps and tips, please refer to section 2. Here, we only explain the model B–specific results.</p>
<div id="set-up-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Set up<a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="source-functions-and-load-data-1" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Source functions and load data<a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb164-1" tabindex="-1"></a><span class="co"># source functions</span></span>
<span id="cb164-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb164-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://github.com/xuyiqing/lalonde/blob/main/tutorial/functions.R?raw=TRUE&quot;</span>)</span>
<span id="cb164-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb164-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;tutorial/functions.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb165-1" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb165-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb165-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/lalonde.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb166-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb166-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb166-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="inspect-data-1" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Inspect data<a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-1" tabindex="-1"></a><span class="co"># collect samples in a list</span></span>
<span id="cb167-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw =</span> ldw, <span class="at">ldw_tr =</span> ldw_tr, <span class="at">ldw_co =</span> ldw_co, <span class="at">ldw_cps =</span> ldw_cps, <span class="at">ldw_psid =</span> ldw_psid)</span>
<span id="cb167-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-3" tabindex="-1"></a></span>
<span id="cb167-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-4" tabindex="-1"></a><span class="co"># print and inspect key metrics of each sample</span></span>
<span id="cb167-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-5" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(data)</span>
<span id="cb167-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-6" tabindex="-1"></a><span class="fu">datatable</span>(summary_stats, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>,</span>
<span id="cb167-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb167-7" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-51977091446d67b62794" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-51977091446d67b62794">{"x":{"filter":"none","vertical":false,"caption":"<caption>Summary Statistics<\/caption>","data":[["1","2","3","4","5"],["ldw","ldw_tr","ldw_co","ldw_cps","ldw_psid"],[445,185,260,16177,2675],[185,185,0,185,185],[260,0,260,15992,2490],[14,14,14,14,14],["data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>num_obs<\/th>\n      <th>num_treated<\/th>\n      <th>num_controls<\/th>\n      <th>num_vars<\/th>\n      <th>name_vars<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sample","targets":1},{"name":"num_obs","targets":2},{"name":"num_treated","targets":3},{"name":"num_controls","targets":4},{"name":"num_vars","targets":5},{"name":"name_vars","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="load-and-preprocess-data-1" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Load and preprocess data<a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-1" tabindex="-1"></a><span class="co"># assigns 1 to the experimental controls</span></span>
<span id="cb168-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-2" tabindex="-1"></a>ldw_co<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb168-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-3" tabindex="-1"></a></span>
<span id="cb168-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-4" tabindex="-1"></a><span class="co"># merge experimental data with CPS-1 data</span></span>
<span id="cb168-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-5" tabindex="-1"></a>ldw_cps_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb168-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-6" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb168-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-7" tabindex="-1"></a>  ldw_cps    <span class="co"># CPS-1 data (16177 observations)</span></span>
<span id="cb168-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-8" tabindex="-1"></a>)</span>
<span id="cb168-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-9" tabindex="-1"></a></span>
<span id="cb168-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-10" tabindex="-1"></a><span class="co"># merge experimental data with PSID-1 data</span></span>
<span id="cb168-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-11" tabindex="-1"></a>ldw_psid_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb168-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-12" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb168-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-13" tabindex="-1"></a>  ldw_psid   <span class="co"># PSID-1 data (2675 observations)</span></span>
<span id="cb168-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-14" tabindex="-1"></a>)</span>
<span id="cb168-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-15" tabindex="-1"></a></span>
<span id="cb168-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-16" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw_cps_plus  =</span> ldw_cps_plus, <span class="at">ldw_psid_plus =</span> ldw_psid_plus)</span>
<span id="cb168-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-17" tabindex="-1"></a></span>
<span id="cb168-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-18" tabindex="-1"></a><span class="co"># inspect each sample</span></span>
<span id="cb168-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-19" tabindex="-1"></a>summary_stats_plus <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(datasets)</span>
<span id="cb168-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-20" tabindex="-1"></a><span class="fu">datatable</span>(summary_stats_plus, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>,</span>
<span id="cb168-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb168-21" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e33863e629915a0cb435" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e33863e629915a0cb435">{"x":{"filter":"none","vertical":false,"caption":"<caption>Summary Statistics<\/caption>","data":[["1","2"],["ldw_cps_plus","ldw_psid_plus"],[16437,2935],[445,445],[15992,2490],[14,14],["data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample","data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>num_obs<\/th>\n      <th>num_treated<\/th>\n      <th>num_controls<\/th>\n      <th>num_vars<\/th>\n      <th>name_vars<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sample","targets":1},{"name":"num_obs","targets":2},{"name":"num_treated","targets":3},{"name":"num_controls","targets":4},{"name":"num_vars","targets":5},{"name":"name_vars","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="model-b" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Model B<a href="lalonde-dehejia-wahba-ldw-data-1.html#model-b" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb169-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb169-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb169-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span> </span>
<span id="cb169-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb169-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span> </span>
<span id="cb169-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb169-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, </span>
<span id="cb169-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb169-5" tabindex="-1"></a>           <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>) <span class="co">#re74 excluded</span></span></code></pre></div>
<div id="pre-assessing-methods-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Pre-assessing methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#pre-assessing-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="overlap-1" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Overlap<a href="lalonde-dehejia-wahba-ldw-data-1.html#overlap-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb170-1" tabindex="-1"></a>ldw.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -1.26191 0.7410732</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-143-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-143-1.png" alt="FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 3.1: FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb172-1" tabindex="-1"></a>ldw_cps.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 1.813362</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-143-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-143-2.png" alt="FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 3.2: FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb174-1" tabindex="-1"></a>ldw_psid.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -11.47475 3.722802</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-143-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-143-3.png" alt="FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1." width="100%" />
<p class="caption">
Figure 3.3: FIGUREB1. SubfigureA:LDW. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.
</p>
</div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb176-1" tabindex="-1"></a>ldw_cps_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.425533</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-144-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-144-1.png" alt="FIGUREB1. SubfigureD:LDW-CPS-1-PLUS. SubfigureE:LDW-PSID-1-PLUS." width="80%" />
<p class="caption">
Figure 3.4: FIGUREB1. SubfigureD:LDW-CPS-1-PLUS. SubfigureE:LDW-PSID-1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb178-1" tabindex="-1"></a>ldw_psid_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -11.65343 7.149751</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-144-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-144-2.png" alt="FIGUREB1. SubfigureD:LDW-CPS-1-PLUS. SubfigureE:LDW-PSID-1-PLUS." width="80%" />
<p class="caption">
Figure 3.5: FIGUREB1. SubfigureD:LDW-CPS-1-PLUS. SubfigureE:LDW-PSID-1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-1" tabindex="-1"></a><span class="co"># combine results</span></span>
<span id="cb180-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-2" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(ldw, ldw_cps, ldw_psid, ldw_cps_plus, ldw_psid_plus)</span>
<span id="cb180-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-3" tabindex="-1"></a>plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>,<span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>, <span class="st">&quot;(D) LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(E) LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb180-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-4" tabindex="-1"></a></span>
<span id="cb180-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-5" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb180-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-6" tabindex="-1"></a><span class="fu">save_overlap_panels</span>(</span>
<span id="cb180-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-7" tabindex="-1"></a>  <span class="at">data_list =</span> data_list,</span>
<span id="cb180-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-8" tabindex="-1"></a>  <span class="at">treat     =</span> treat,</span>
<span id="cb180-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-9" tabindex="-1"></a>  <span class="at">covar     =</span> covar,</span>
<span id="cb180-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-10" tabindex="-1"></a>  <span class="at">plot_titles =</span> plot_titles,</span>
<span id="cb180-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-11" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_overlap_model_b_panels&quot;</span></span>
<span id="cb180-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb180-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## -1.26191 0.7410732</code></pre>
<pre><code>## -16.1181 1.813362</code></pre>
<pre><code>## -11.47475 3.722802</code></pre>
<pre><code>## -16.1181 3.425533</code></pre>
<pre><code>## -11.65343 7.149751</code></pre>
<p>Since we use the same experimental and observational samples as within model A, overlap patterns are essentially unchanged.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb186-1" tabindex="-1"></a><span class="co"># set model formula</span></span>
<span id="cb186-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb186-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(treat, <span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(covar, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)))</span></code></pre></div>
</div>
</div>
</div>
<div id="improving-overlap-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Improving overlap<a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-overlap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-methods-2" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Single methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-4" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Propensity score threshold trimming</li>
</ol>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-1" tabindex="-1"></a><span class="co"># apply trimming with a threshold </span></span>
<span id="cb187-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-2" tabindex="-1"></a>ldw_cps.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb187-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-3" tabindex="-1"></a>ldw_psid.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb187-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-4" tabindex="-1"></a></span>
<span id="cb187-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb187-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-6" tabindex="-1"></a>ldw_cps.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_trim, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb187-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb187-7" tabindex="-1"></a>ldw_psid.ps_trim <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_trim, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Common range trimming</li>
</ol>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-1" tabindex="-1"></a><span class="co"># trim observations outside the common support region of propensity scores</span></span>
<span id="cb188-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-2" tabindex="-1"></a>ldw_cps.ps_common   <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_cps.ps)</span>
<span id="cb188-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-3" tabindex="-1"></a>ldw_psid.ps_common  <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_psid.ps)</span>
<span id="cb188-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-4" tabindex="-1"></a></span>
<span id="cb188-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb188-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-6" tabindex="-1"></a>ldw_cps.ps_common <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_common, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb188-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb188-7" tabindex="-1"></a>ldw_psid.ps_common <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_common, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Crump trimming</li>
</ol>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-1" tabindex="-1"></a><span class="co"># trim observations with propensity scores outside an interval</span></span>
<span id="cb189-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-2" tabindex="-1"></a>ldw_cps.ps_crump  <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_cps.ps, <span class="at">lower =</span> <span class="fl">0.05</span>, <span class="at">upper =</span> <span class="fl">0.95</span>)</span>
<span id="cb189-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-3" tabindex="-1"></a>ldw_psid.ps_crump <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_psid.ps, <span class="at">lower =</span> <span class="fl">0.05</span>, <span class="at">upper =</span> <span class="fl">0.95</span>)</span>
<span id="cb189-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-4" tabindex="-1"></a></span>
<span id="cb189-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb189-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-6" tabindex="-1"></a>ldw_cps.ps_crump <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_crump, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb189-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb189-7" tabindex="-1"></a>ldw_psid.ps_crump <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_crump, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Stuermer trimming</li>
</ol>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-1" tabindex="-1"></a><span class="co"># trim observations based on propensity score quantiles separately for treated and control</span></span>
<span id="cb190-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-2" tabindex="-1"></a>ldw_cps.ps_stuermer  <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_cps.ps)</span>
<span id="cb190-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-3" tabindex="-1"></a>ldw_psid.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_psid.ps)</span>
<span id="cb190-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-4" tabindex="-1"></a></span>
<span id="cb190-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb190-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-6" tabindex="-1"></a>ldw_cps.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_stuermer, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb190-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb190-7" tabindex="-1"></a>ldw_psid.ps_stuermer <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_stuermer, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Walker trimming</li>
</ol>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-1" tabindex="-1"></a><span class="co"># trim observations based on preference scores that adjust for treatment prevalence using logit transformations</span></span>
<span id="cb191-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-2" tabindex="-1"></a>ldw_cps.ps_walker  <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_cps.ps)</span>
<span id="cb191-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-3" tabindex="-1"></a>ldw_psid.ps_walker <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_psid.ps)</span>
<span id="cb191-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-4" tabindex="-1"></a></span>
<span id="cb191-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-5" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data </span></span>
<span id="cb191-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-6" tabindex="-1"></a>ldw_cps.ps_walker <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_cps.ps_walker, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span>
<span id="cb191-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb191-7" tabindex="-1"></a>ldw_psid.ps_walker <span class="ot">&lt;-</span> <span class="fu">ps_estimate</span>(<span class="at">data =</span> ldw_psid.ps_walker, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
</div>
</div>
<div id="integrated-methods-4" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-and-matching-2" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Trimming and matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-and-matching-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="extended-datasets-1" class="section level5 hasAnchor" number="3.3.2.1.1">
<h5><span class="header-section-number">3.3.2.1.1</span> Extended datasets<a href="lalonde-dehejia-wahba-ldw-data-1.html#extended-datasets-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>(Similar to tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-1" tabindex="-1"></a>ldw_cps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps_plus.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb192-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-2" tabindex="-1"></a>ldw_psid_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid_plus.ps, <span class="at">threshold =</span> <span class="fl">0.8</span>)</span>
<span id="cb192-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-3" tabindex="-1"></a></span>
<span id="cb192-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-4" tabindex="-1"></a><span class="co"># excluding the experimental controls</span></span>
<span id="cb192-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-5" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb192-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-6" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb192-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-7" tabindex="-1"></a></span>
<span id="cb192-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-8" tabindex="-1"></a><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span id="cb192-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-9" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_cps.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb192-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-10" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_psid.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb192-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-11" tabindex="-1"></a></span>
<span id="cb192-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-12" tabindex="-1"></a><span class="co"># further subset data and re-assign treat variable </span></span>
<span id="cb192-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-13" tabindex="-1"></a>ldw_trim_cps <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> ps_assoverlap <span class="sc">&lt;=</span> <span class="fl">0.9</span>)</span>
<span id="cb192-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-14" tabindex="-1"></a>ldw_trim_cps<span class="sc">$</span>treat[<span class="fu">which</span>(ldw_trim_cps<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb192-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-15" tabindex="-1"></a></span>
<span id="cb192-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-16" tabindex="-1"></a>ldw_trim_psid <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> ps_assoverlap <span class="sc">&lt;=</span> <span class="fl">0.8</span>)</span>
<span id="cb192-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb192-17" tabindex="-1"></a>ldw_trim_psid<span class="sc">$</span>treat[<span class="fu">which</span>(ldw_trim_psid<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div id="initial-datasets-1" class="section level5 hasAnchor" number="3.3.2.1.2">
<h5><span class="header-section-number">3.3.2.1.2</span> Initial datasets<a href="lalonde-dehejia-wahba-ldw-data-1.html#initial-datasets-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-1" tabindex="-1"></a><span class="co"># combine trimmed samples</span></span>
<span id="cb193-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-2" tabindex="-1"></a>all_trim.cps  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb193-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-3" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_cps.ps_trim, </span>
<span id="cb193-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-4" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_cps.ps_common, </span>
<span id="cb193-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-5" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_cps.ps_stuermer, </span>
<span id="cb193-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-6" tabindex="-1"></a>  <span class="at">walker =</span> ldw_cps.ps_walker, </span>
<span id="cb193-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-7" tabindex="-1"></a>  <span class="at">crump =</span> ldw_cps.ps_crump)</span>
<span id="cb193-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-8" tabindex="-1"></a></span>
<span id="cb193-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-9" tabindex="-1"></a>all_trim.psid  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb193-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-10" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_psid.ps_trim, </span>
<span id="cb193-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-11" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_psid.ps_common, </span>
<span id="cb193-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-12" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_psid.ps_stuermer, </span>
<span id="cb193-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-13" tabindex="-1"></a>  <span class="at">walker =</span> ldw_psid.ps_walker, </span>
<span id="cb193-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb193-14" tabindex="-1"></a>  <span class="at">crump =</span> ldw_psid.ps_crump)</span></code></pre></div>
<div id="distance-matching-1" class="section level6 hasAnchor" number="3.3.2.1.2.1">
<h6><span class="header-section-number">3.3.2.1.2.1</span> Distance matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#distance-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol style="list-style-type: decimal">
<li>1:1 Nearest neighbor matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb194-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=1, logistic propensity score and replacement</span></span>
<span id="cb194-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb194-2" tabindex="-1"></a>nn_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb194-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb194-3" tabindex="-1"></a>nn_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>k:1 matching (k=2) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb195-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=2, logistic propensity score and replacement</span></span>
<span id="cb195-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb195-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb195-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb195-3" tabindex="-1"></a>k2_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb195-4" tabindex="-1"></a>k2_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>k:1 matching (k=3) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb196-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=3, logistic propensity score and replacement</span></span>
<span id="cb196-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb196-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb196-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb196-3" tabindex="-1"></a>k3_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb196-4" tabindex="-1"></a>k3_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Caliper matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb197-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with a caliper of 0.1 on the logistic propensity score </span></span>
<span id="cb197-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb197-2" tabindex="-1"></a>caliper_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb197-3" tabindex="-1"></a>caliper_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Common support restriction matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb198-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with exclusion of units outside common support</span></span>
<span id="cb198-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb198-2" tabindex="-1"></a>cs_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">reestimate =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb198-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb198-3" tabindex="-1"></a>cs_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">reestimate =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Mahalanobis distance matching (mahvars) with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb199-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching using mahalanobis distance</span></span>
<span id="cb199-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb199-2" tabindex="-1"></a>mahvars_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb199-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb199-3" tabindex="-1"></a>mahvars_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Optimal pair matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb200-1" tabindex="-1"></a><span class="co"># perform optimal pair matching that minimizes total within-pair distance on propensity scores</span></span>
<span id="cb200-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb200-2" tabindex="-1"></a>optimal_pair_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb200-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb200-3" tabindex="-1"></a>optimal_pair_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Optimal full matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb201-1" tabindex="-1"></a><span class="co"># perform optimal full matching allowing sets with varying ratios of treated to controls and minimizing a global distance criterion</span></span>
<span id="cb201-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb201-2" tabindex="-1"></a>optimal_full_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb201-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb201-3" tabindex="-1"></a>optimal_full_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Generalized full matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb202-1" tabindex="-1"></a><span class="co"># perform generalized full matching using fast approximation and producing matched sets with flexible treated/control ratios </span></span>
<span id="cb202-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb202-2" tabindex="-1"></a>general_full_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb202-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb202-3" tabindex="-1"></a>general_full_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>Genetic matching with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump trimming</li>
</ol>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb203-1" tabindex="-1"></a><span class="co"># perform genetic matching </span></span>
<span id="cb203-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb203-2" tabindex="-1"></a>genetic_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span>
<span id="cb203-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb203-3" tabindex="-1"></a>genetic_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">link =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span></code></pre></div>
</div>
<div id="stratum-matching-1" class="section level6 hasAnchor" number="3.3.2.1.2.2">
<h6><span class="header-section-number">3.3.2.1.2.2</span> Stratum matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#stratum-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol start="11" style="list-style-type: decimal">
<li>Exact matching (exact)</li>
</ol>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb204-1" tabindex="-1"></a><span class="co"># match units exactly by raw covariate profiles </span></span>
<span id="cb204-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb204-2" tabindex="-1"></a>exact_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span>
<span id="cb204-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb204-3" tabindex="-1"></a>exact_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Coarsened matching (cem)</li>
</ol>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb205-1" tabindex="-1"></a><span class="co"># match units exactly within coarse strata </span></span>
<span id="cb205-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb205-2" tabindex="-1"></a>cem_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span>
<span id="cb205-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb205-3" tabindex="-1"></a>cem_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span></code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li>Subclassification</li>
</ol>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb206-1" tabindex="-1"></a><span class="co"># partition sample into fixed number of bins based on propensity score </span></span>
<span id="cb206-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb206-2" tabindex="-1"></a>subcl_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">3</span>)</span>
<span id="cb206-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb206-3" tabindex="-1"></a>subcl_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="pure-subset-selection-1" class="section level6 hasAnchor" number="3.3.2.1.2.3">
<h6><span class="header-section-number">3.3.2.1.2.3</span> Pure subset selection<a href="lalonde-dehejia-wahba-ldw-data-1.html#pure-subset-selection-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<ol start="14" style="list-style-type: decimal">
<li>Cardinality profile matching</li>
</ol>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb207-1" tabindex="-1"></a><span class="co"># select largest balanced subsample meeting covariate balance tolerances and a fixed ratio of controls to treated units</span></span>
<span id="cb207-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb207-2" tabindex="-1"></a>card_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span>
<span id="cb207-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb207-3" tabindex="-1"></a>card_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span></code></pre></div>
<ol start="15" style="list-style-type: decimal">
<li>Profile matching</li>
</ol>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb208-1" tabindex="-1"></a><span class="co"># select the largest control group subset balanced to the treated group (for ATT), leaving the treated group intact</span></span>
<span id="cb208-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb208-2" tabindex="-1"></a>profile_trim_comb.cps <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model, <span class="at">data_list =</span> all_trim.cps, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span>
<span id="cb208-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb208-3" tabindex="-1"></a>profile_trim_comb.psid <span class="ot">&lt;-</span> <span class="fu">attach_matchit</span>(model,<span class="at">data_list =</span> all_trim.psid, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="cn">NA</span>, <span class="at">time =</span> <span class="dv">1200</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="post-assessing-methods-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Post-assessing methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#post-assessing-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-methods-3" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Single methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#single-methods-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-5" class="section level4 hasAnchor" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="smd-3" class="section level5 hasAnchor" number="3.4.1.1.1">
<h5><span class="header-section-number">3.4.1.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb209-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb209-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb209-2" tabindex="-1"></a>smd_trim.cps <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(all_trim.cps, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb209-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb209-3" tabindex="-1"></a>smd_trim.psid <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(all_trim.psid, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ovl-3" class="section level5 hasAnchor" number="3.4.1.1.2">
<h5><span class="header-section-number">3.4.1.1.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data-1.html#ovl-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb210-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb210-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb210-2" tabindex="-1"></a>ovl_trim.cps <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(all_trim.cps, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span>
<span id="cb210-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb210-3" tabindex="-1"></a>ovl_trim.psid <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(all_trim.psid, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="integrated-methods-5" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="trimming-and-matching-3" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Trimming and matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-and-matching-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="extended-samples-1" class="section level5 hasAnchor" number="3.4.2.1.1">
<h5><span class="header-section-number">3.4.2.1.1</span> Extended samples<a href="lalonde-dehejia-wahba-ldw-data-1.html#extended-samples-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>(Similar to tutorial by <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb211-1" tabindex="-1"></a><span class="co"># list all trimmed and matched samples</span></span>
<span id="cb211-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb211-2" tabindex="-1"></a>trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold_match =</span> ldw_cps.trim_match)</span>
<span id="cb211-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb211-3" tabindex="-1"></a>trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold_match =</span> ldw_psid.trim_match)</span></code></pre></div>
<div id="smd-4" class="section level6 hasAnchor" number="3.4.2.1.1.1">
<h6><span class="header-section-number">3.4.2.1.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb212-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb212-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb212-2" tabindex="-1"></a>smd_trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim_match_comb.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb212-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb212-3" tabindex="-1"></a>smd_trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim_match_comb.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ovl-4" class="section level6 hasAnchor" number="3.4.2.1.1.2">
<h6><span class="header-section-number">3.4.2.1.1.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data-1.html#ovl-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb213-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb213-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb213-2" tabindex="-1"></a>ovl_trim_match_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(trim_match_comb.cps_plus, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span>
<span id="cb213-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb213-3" tabindex="-1"></a>ovl_trim_match_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ovl_trim</span>(trim_match_comb.psid_plus, <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="st">&quot;treat&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="initial-samples-1" class="section level5 hasAnchor" number="3.4.2.1.2">
<h5><span class="header-section-number">3.4.2.1.2</span> Initial samples<a href="lalonde-dehejia-wahba-ldw-data-1.html#initial-samples-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-1" tabindex="-1"></a><span class="co"># list all trimmed and matched samples</span></span>
<span id="cb214-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-2" tabindex="-1"></a>trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb214-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-3" tabindex="-1"></a>  <span class="at">nn =</span> nn_trim_comb.cps, </span>
<span id="cb214-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-4" tabindex="-1"></a>  <span class="at">k2 =</span> k2_trim_comb.cps,</span>
<span id="cb214-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-5" tabindex="-1"></a>  <span class="at">k3 =</span> k3_trim_comb.cps, </span>
<span id="cb214-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-6" tabindex="-1"></a>  <span class="at">caliper =</span> caliper_trim_comb.cps,</span>
<span id="cb214-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-7" tabindex="-1"></a>  <span class="at">cs =</span> cs_trim_comb.cps, </span>
<span id="cb214-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-8" tabindex="-1"></a>  <span class="at">mahvars =</span> mahvars_trim_comb.cps,</span>
<span id="cb214-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-9" tabindex="-1"></a>  <span class="at">optimal_pair =</span> optimal_pair_trim_comb.cps,</span>
<span id="cb214-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-10" tabindex="-1"></a>  <span class="at">optimal_full =</span> optimal_full_trim_comb.cps, </span>
<span id="cb214-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-11" tabindex="-1"></a>  <span class="at">genetic =</span> genetic_trim_comb.cps, </span>
<span id="cb214-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-12" tabindex="-1"></a>  <span class="at">exact =</span> exact_trim_comb.cps,</span>
<span id="cb214-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-13" tabindex="-1"></a>  <span class="at">cem =</span> cem_trim_comb.cps,</span>
<span id="cb214-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-14" tabindex="-1"></a>  <span class="at">subcl =</span> subcl_trim_comb.cps </span>
<span id="cb214-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-15" tabindex="-1"></a>)</span>
<span id="cb214-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-16" tabindex="-1"></a></span>
<span id="cb214-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-17" tabindex="-1"></a>trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb214-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-18" tabindex="-1"></a>  <span class="at">nn =</span> nn_trim_comb.psid,</span>
<span id="cb214-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-19" tabindex="-1"></a>  <span class="at">k2 =</span> k2_trim_comb.psid, </span>
<span id="cb214-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-20" tabindex="-1"></a>  <span class="at">k3 =</span> k3_trim_comb.psid, </span>
<span id="cb214-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-21" tabindex="-1"></a>  <span class="at">caliper =</span> caliper_trim_comb.psid, </span>
<span id="cb214-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-22" tabindex="-1"></a>  <span class="at">cs =</span> cs_trim_comb.psid,</span>
<span id="cb214-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-23" tabindex="-1"></a>  <span class="at">mahvars =</span> mahvars_trim_comb.psid,</span>
<span id="cb214-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-24" tabindex="-1"></a>  <span class="at">optimal_pair =</span> optimal_pair_trim_comb.psid, </span>
<span id="cb214-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-25" tabindex="-1"></a>  <span class="at">optimal_full =</span> optimal_full_trim_comb.psid, </span>
<span id="cb214-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-26" tabindex="-1"></a>  <span class="at">genetic =</span> genetic_trim_comb.psid,</span>
<span id="cb214-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-27" tabindex="-1"></a>  <span class="at">exact =</span> exact_trim_comb.psid,</span>
<span id="cb214-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-28" tabindex="-1"></a>  <span class="at">cem =</span> cem_trim_comb.psid,</span>
<span id="cb214-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-29" tabindex="-1"></a>  <span class="at">subcl =</span> subcl_trim_comb.psid </span>
<span id="cb214-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb214-30" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-5" class="section level6 hasAnchor" number="3.4.2.1.2.1">
<h6><span class="header-section-number">3.4.2.1.2.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-5" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb215-1" tabindex="-1"></a><span class="co"># compute absolute standardized mean differences</span></span>
<span id="cb215-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb215-2" tabindex="-1"></a>smd_trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(trim_match_comb.cps, all_trim.cps) </span>
<span id="cb215-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb215-3" tabindex="-1"></a>smd_trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(trim_match_comb.psid, all_trim.psid)</span></code></pre></div>
</div>
<div id="ovl-5" class="section level6 hasAnchor" number="3.4.2.1.2.2">
<h6><span class="header-section-number">3.4.2.1.2.2</span> OVL<a href="lalonde-dehejia-wahba-ldw-data-1.html#ovl-5" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb216-1" tabindex="-1"></a><span class="co"># compute overlap coefficients</span></span>
<span id="cb216-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb216-2" tabindex="-1"></a>ovl_trim_match_comb.cps <span class="ot">&lt;-</span> <span class="fu">compute_ovl_matchit</span>(trim_match_comb.cps, all_trim.cps, <span class="at">ps =</span> <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">covar =</span> covar)</span>
<span id="cb216-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb216-3" tabindex="-1"></a>ovl_trim_match_comb.psid <span class="ot">&lt;-</span> <span class="fu">compute_ovl_matchit</span>(trim_match_comb.psid, all_trim.psid, <span class="at">ps =</span> <span class="st">&quot;ps_assoverlap&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">covar =</span> covar)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="identifying-most-efficient-methods-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Identifying most efficient methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#identifying-most-efficient-methods-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ranking-1" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Ranking<a href="lalonde-dehejia-wahba-ldw-data-1.html#ranking-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb217-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb217-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb217-2" tabindex="-1"></a>all_cps <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;cps&quot;</span>)</span>
<span id="cb217-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb217-3" tabindex="-1"></a>all_psid <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;psid&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb218-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb218-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb218-2" tabindex="-1"></a><span class="fu">save_csv</span>(all_cps, <span class="st">&quot;ldw_model_a_cps1_all_results&quot;</span>)</span>
<span id="cb218-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb218-3" tabindex="-1"></a><span class="fu">save_csv</span>(all_psid, <span class="st">&quot;ldw_model_a_psid1_all_results&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-1" tabindex="-1"></a><span class="co"># rank comparatively</span></span>
<span id="cb219-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-2" tabindex="-1"></a>ranked_cps  <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_cps)</span>
<span id="cb219-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-3" tabindex="-1"></a>ranked_psid <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_psid)</span>
<span id="cb219-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-4" tabindex="-1"></a></span>
<span id="cb219-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-5" tabindex="-1"></a><span class="co"># get top 5 methods</span></span>
<span id="cb219-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-6" tabindex="-1"></a>top5_methods.cps <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_cps, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb219-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-7" tabindex="-1"></a>top5_methods.psid <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_psid, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb219-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-8" tabindex="-1"></a></span>
<span id="cb219-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-9" tabindex="-1"></a><span class="co"># rerank top 5 methods</span></span>
<span id="cb219-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-10" tabindex="-1"></a>top5_methods.cps <span class="ot">&lt;-</span> <span class="fu">rerank_methods</span>(top5_methods.cps, ranked_cps)</span>
<span id="cb219-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb219-11" tabindex="-1"></a>top5_methods.psid <span class="ot">&lt;-</span> <span class="fu">rerank_methods</span>(top5_methods.psid, ranked_psid)</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb220-1" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb220-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb220-2" tabindex="-1"></a>top5_methods_df.cps <span class="ot">&lt;-</span> ranked_cps <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(OVL)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Mean_Abs_SMD)</span>
<span id="cb220-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb220-3" tabindex="-1"></a>top5_methods_df.psid <span class="ot">&lt;-</span> ranked_psid <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(OVL)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Mean_Abs_SMD)</span>
<span id="cb220-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb220-4" tabindex="-1"></a></span>
<span id="cb220-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb220-5" tabindex="-1"></a><span class="fu">datatable</span>(top5_methods_df.cps, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for CPS-1&quot;</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-521fcff53b1c506bc878" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-521fcff53b1c506bc878">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top 5 Methods for CPS-1<\/caption>","data":[["1","2","3","4","5"],["genetic_ps_threshold","genetic_common_range","genetic_crump","nn_crump","caliper_crump"],[0.7617511524437063,0.7621906069617868,0.8202603140390295,0.781697091941851,0.781697091941851],[0.003869621506599825,0.003925938182153053,0.004091597141647259,0.03790000975742847,0.03790000975742847]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>OVL<\/th>\n      <th>Mean_Abs_SMD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"OVL","targets":2},{"name":"Mean_Abs_SMD","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb221-1" tabindex="-1"></a><span class="fu">datatable</span>(top5_methods_df.psid, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for PSID-1&quot;</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-547daaf8b96f471cb6a5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-547daaf8b96f471cb6a5">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top 5 Methods for PSID-1<\/caption>","data":[["1","2","3","4","5"],["genetic_stuermer","mahvars_stuermer","k3_walker","cs_stuermer","optimal_pair_stuermer"],[0.8772723098976364,0.8838771020782699,0.8881175237238961,0.8808990714148706,0.8801082658783964],[0.03997885306032693,0.05508855093368815,0.0571910994693624,0.07394694869075497,0.08580238424595145]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>OVL<\/th>\n      <th>Mean_Abs_SMD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"OVL","targets":2},{"name":"Mean_Abs_SMD","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb222-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb222-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb222-2" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.cps, <span class="st">&quot;ldw_model_b_cps1_top5_methods&quot;</span>)</span>
<span id="cb222-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb222-3" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.psid, <span class="st">&quot;ldw_model_b_psid1_top5_methods&quot;</span>)</span></code></pre></div>
</div>
<div id="sample-construction-1" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Sample construction<a href="lalonde-dehejia-wahba-ldw-data-1.html#sample-construction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-1" tabindex="-1"></a><span class="co"># create lookup lists</span></span>
<span id="cb223-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-2" tabindex="-1"></a>match_lookup_cps <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb223-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-3" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(nn_trim_comb.cps, all_trim.cps, <span class="st">&quot;nn&quot;</span>),</span>
<span id="cb223-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-4" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k2_trim_comb.cps, all_trim.cps, <span class="st">&quot;k2&quot;</span>),</span>
<span id="cb223-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-5" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k3_trim_comb.cps, all_trim.cps, <span class="st">&quot;k3&quot;</span>),</span>
<span id="cb223-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-6" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(caliper_trim_comb.cps, all_trim.cps, <span class="st">&quot;caliper&quot;</span>),</span>
<span id="cb223-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-7" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cs_trim_comb.cps, all_trim.cps, <span class="st">&quot;cs&quot;</span>),</span>
<span id="cb223-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-8" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(mahvars_trim_comb.cps, all_trim.cps, <span class="st">&quot;mahvars&quot;</span>),</span>
<span id="cb223-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-9" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_pair_trim_comb.cps, all_trim.cps, <span class="st">&quot;optimal_pair&quot;</span>),</span>
<span id="cb223-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-10" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_full_trim_comb.cps, all_trim.cps, <span class="st">&quot;optimal_full&quot;</span>),</span>
<span id="cb223-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-11" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(genetic_trim_comb.cps, all_trim.cps, <span class="st">&quot;genetic&quot;</span>),</span>
<span id="cb223-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-12" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(exact_trim_comb.cps, all_trim.cps, <span class="st">&quot;exact&quot;</span>),</span>
<span id="cb223-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-13" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cem_trim_comb.cps, all_trim.cps, <span class="st">&quot;cem&quot;</span>),</span>
<span id="cb223-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-14" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(subcl_trim_comb.cps, all_trim.cps, <span class="st">&quot;subcl&quot;</span>)</span>
<span id="cb223-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-15" tabindex="-1"></a>)</span>
<span id="cb223-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-16" tabindex="-1"></a></span>
<span id="cb223-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-17" tabindex="-1"></a>match_lookup_psid <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb223-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-18" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(nn_trim_comb.psid, all_trim.psid, <span class="st">&quot;nn&quot;</span>),</span>
<span id="cb223-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-19" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k2_trim_comb.psid, all_trim.psid, <span class="st">&quot;k2&quot;</span>),</span>
<span id="cb223-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-20" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(k3_trim_comb.psid, all_trim.psid, <span class="st">&quot;k3&quot;</span>),</span>
<span id="cb223-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-21" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(caliper_trim_comb.psid, all_trim.psid, <span class="st">&quot;caliper&quot;</span>),</span>
<span id="cb223-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-22" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cs_trim_comb.psid, all_trim.psid, <span class="st">&quot;cs&quot;</span>),</span>
<span id="cb223-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-23" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(mahvars_trim_comb.psid, all_trim.psid, <span class="st">&quot;mahvars&quot;</span>),</span>
<span id="cb223-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-24" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_pair_trim_comb.psid, all_trim.psid, <span class="st">&quot;optimal_pair&quot;</span>),</span>
<span id="cb223-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-25" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(optimal_full_trim_comb.psid, all_trim.psid, <span class="st">&quot;optimal_full&quot;</span>),</span>
<span id="cb223-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-26" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(genetic_trim_comb.psid, all_trim.psid, <span class="st">&quot;genetic&quot;</span>),</span>
<span id="cb223-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-27" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(exact_trim_comb.psid, all_trim.psid, <span class="st">&quot;exact&quot;</span>),</span>
<span id="cb223-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-28" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(cem_trim_comb.psid, all_trim.psid, <span class="st">&quot;cem&quot;</span>),</span>
<span id="cb223-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-29" tabindex="-1"></a>        <span class="fu">wrap_match_entries</span>(subcl_trim_comb.psid, all_trim.psid, <span class="st">&quot;subcl&quot;</span>)</span>
<span id="cb223-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-30" tabindex="-1"></a>)</span>
<span id="cb223-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-31" tabindex="-1"></a></span>
<span id="cb223-32"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-32" tabindex="-1"></a>list_cps <span class="ot">&lt;-</span> <span class="fu">c</span>(all_trim.cps, match_lookup_cps)</span>
<span id="cb223-33"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb223-33" tabindex="-1"></a>list_psid <span class="ot">&lt;-</span> <span class="fu">c</span>(all_trim.psid, match_lookup_psid)</span></code></pre></div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-1" tabindex="-1"></a><span class="co"># create samples corresponding to the top 5 methods for each sample</span></span>
<span id="cb224-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-2" tabindex="-1"></a>top5_datasets.cps <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(list_cps, top5_methods.cps)</span>
<span id="cb224-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-3" tabindex="-1"></a>top5_datasets.psid <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(list_psid, top5_methods.psid)</span>
<span id="cb224-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-4" tabindex="-1"></a></span>
<span id="cb224-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-5" tabindex="-1"></a><span class="co"># extract top 5 objects </span></span>
<span id="cb224-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-6" tabindex="-1"></a>top5_objects.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_methods.cps, <span class="cf">function</span>(m) list_cps[[m]])</span>
<span id="cb224-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb224-7" tabindex="-1"></a>top5_objects.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_methods.psid, <span class="cf">function</span>(m) list_psid[[m]])</span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb225-1" tabindex="-1"></a><span class="co"># save samples into .RData files</span></span>
<span id="cb225-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb225-2" tabindex="-1"></a><span class="fu">save_top5_datasets</span>(list_cps, top5_methods.cps, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_cps1&quot;</span>)</span>
<span id="cb225-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb225-3" tabindex="-1"></a><span class="fu">save_top5_datasets</span>(list_psid, top5_methods.psid, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_a_psid1&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="estimating-2" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Estimating<a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-treatment-effect-on-the-treated-att-1" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Average treatment effect on the treated (ATT)<a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-1" tabindex="-1"></a><span class="co"># estimate ATT</span></span>
<span id="cb226-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-2" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb226-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-3" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb226-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-4" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb226-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-5" tabindex="-1"></a></span>
<span id="cb226-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-6" tabindex="-1"></a>out.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb226-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-7" tabindex="-1"></a>out.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb226-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-8" tabindex="-1"></a>out.cps_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb226-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb226-9" tabindex="-1"></a>out.psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-1" tabindex="-1"></a><span class="co"># estimate ATT</span></span>
<span id="cb227-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/trimmed.RData&quot;</span>)</span>
<span id="cb227-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-3" tabindex="-1"></a>out4 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb227-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-4" tabindex="-1"></a>out5 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb227-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-5" tabindex="-1"></a>out6 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps_trim, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb227-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb227-6" tabindex="-1"></a>out7 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid_trim, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb228-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-2" tabindex="-1"></a></span>
<span id="cb228-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-3" tabindex="-1"></a><span class="co"># experimental benchmarks</span></span>
<span id="cb228-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-4" tabindex="-1"></a>band.exp <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb228-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-5" tabindex="-1"></a>est.exp  <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb228-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-6" tabindex="-1"></a></span>
<span id="cb228-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-7" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb228-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out1,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp, </span>
<span id="cb228-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(A) LDW-Experimental&quot;</span>)</span>
<span id="cb228-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-10" tabindex="-1"></a></span>
<span id="cb228-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out2,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp, </span>
<span id="cb228-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>)</span>
<span id="cb228-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-13" tabindex="-1"></a></span>
<span id="cb228-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-14" tabindex="-1"></a><span class="fu">plot_coef</span>(out3,  <span class="at">band =</span> band.exp, <span class="at">line =</span> est.exp,</span>
<span id="cb228-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-15" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb228-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-16" tabindex="-1"></a></span>
<span id="cb228-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-17" tabindex="-1"></a><span class="co"># get nonexperimtenal benchmarks</span></span>
<span id="cb228-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-18" tabindex="-1"></a>method_names_cps <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.cps, <span class="cf">function</span>(m) {</span>
<span id="cb228-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-19" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb228-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> })</span>
<span id="cb228-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-21" tabindex="-1"></a>method_names_psid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.psid, <span class="cf">function</span>(m) {</span>
<span id="cb228-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-22" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb228-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> })</span>
<span id="cb228-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-24" tabindex="-1"></a></span>
<span id="cb228-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-25" tabindex="-1"></a>band.cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb228-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-26" tabindex="-1"></a>est.cps  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb228-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-27" tabindex="-1"></a>band.psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb228-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-28" tabindex="-1"></a>est.psid  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb228-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-29" tabindex="-1"></a></span>
<span id="cb228-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-30" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb228-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-31" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.cps)) {</span>
<span id="cb228-32"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-32" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps[i])</span>
<span id="cb228-33"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-33" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.cps[[i]], <span class="at">band =</span> band.cps[[i]], <span class="at">line =</span> est.cps[[i]],</span>
<span id="cb228-34"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-34" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb228-35"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb228-35" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-187-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-187-1.png" alt="FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.6: FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-187-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-187-2.png" alt="FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.7: FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb229-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.psid)) {</span>
<span id="cb229-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb229-2" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid[i])</span>
<span id="cb229-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb229-3" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.psid[[i]], <span class="at">band =</span> band.psid[[i]], <span class="at">line =</span> est.psid[[i]],</span>
<span id="cb229-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb229-4" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb229-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb229-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-187-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-187-3.png" alt="FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.8: FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-1" tabindex="-1"></a><span class="co"># get nonexperimtenal benchmarks</span></span>
<span id="cb230-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-2" tabindex="-1"></a>band.cps_plus <span class="ot">&lt;-</span> out4[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb230-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-3" tabindex="-1"></a>est.cps_plus <span class="ot">&lt;-</span> out4[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb230-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-4" tabindex="-1"></a>band.psid_plus <span class="ot">&lt;-</span> out5[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb230-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-5" tabindex="-1"></a>est.psid_plus <span class="ot">&lt;-</span> out5[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb230-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-6" tabindex="-1"></a></span>
<span id="cb230-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-7" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb230-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out6, <span class="at">band =</span> band.cps_plus, <span class="at">line =</span> est.cps_plus, </span>
<span id="cb230-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>)</span>
<span id="cb230-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-10" tabindex="-1"></a></span>
<span id="cb230-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out7, <span class="at">band =</span> band.psid_plus, <span class="at">line =</span> est.psid_plus, </span>
<span id="cb230-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb230-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-187-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-187-4.png" alt="FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.9: FIGUREB2. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. ATT Estimates Model A Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-1" tabindex="-1"></a><span class="co"># get outputs</span></span>
<span id="cb231-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-2" tabindex="-1"></a>all_outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1, out2, out3), out.cps, out.psid, <span class="fu">list</span>(out6, out7))</span>
<span id="cb231-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-3" tabindex="-1"></a></span>
<span id="cb231-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-4" tabindex="-1"></a><span class="co"># get plot titles</span></span>
<span id="cb231-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-5" tabindex="-1"></a>all_plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>, <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>,</span>
<span id="cb231-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-6" tabindex="-1"></a>                      <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps),</span>
<span id="cb231-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-7" tabindex="-1"></a>                      <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid),</span>
<span id="cb231-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-8" tabindex="-1"></a>                      <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb231-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-9" tabindex="-1"></a></span>
<span id="cb231-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-10" tabindex="-1"></a><span class="co"># get confidence interval bounds</span></span>
<span id="cb231-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-11" tabindex="-1"></a>all_bands <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(band.exp, band.exp, band.exp), band.cps, band.psid, <span class="fu">list</span>(band.cps_plus, band.psid_plus))</span>
<span id="cb231-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-12" tabindex="-1"></a></span>
<span id="cb231-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-13" tabindex="-1"></a>all_ests <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(est.exp, est.exp, est.exp), est.cps, est.psid, <span class="fu">list</span>(est.cps_plus, est.psid_plus))</span>
<span id="cb231-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-14" tabindex="-1"></a></span>
<span id="cb231-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-15" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb231-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-16" tabindex="-1"></a><span class="fu">save_att_panels</span>(</span>
<span id="cb231-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-17" tabindex="-1"></a>    <span class="at">out_list    =</span> all_outs,</span>
<span id="cb231-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-18" tabindex="-1"></a>    <span class="at">plot_titles =</span> all_plot_titles,</span>
<span id="cb231-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-19" tabindex="-1"></a>    <span class="at">band_list   =</span> all_bands,</span>
<span id="cb231-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-20" tabindex="-1"></a>    <span class="at">est_list    =</span> all_ests,</span>
<span id="cb231-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-21" tabindex="-1"></a>    <span class="at">prefix      =</span> <span class="st">&quot;ldw_model_b_est_comb&quot;</span></span>
<span id="cb231-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb231-22" tabindex="-1"></a>)</span></code></pre></div>
<p>As in model A, the above figures show the ATT estimates and their 95% confidence intervals for fifteen samples: LDW-Experimental, LDW-CPS-1, LDW-PSID-1, trimmed and matched versions of the LDW-CPS-1-PLUS and LDW-PSID-1-PLUS samples (analogous to <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>) and a series of top-ranked subsamples of both LDW-CPS-1 and LDW-PSID-1 based on various trimming and integrated trimming and matching criteria.</p>
<p>Again, figure (A) presents the benchmark, serving as a reference for bias and variance assessment of observational samples. Figures (B) and (C) show results for the LDW-CPS-1 and LDW-PSID-1, respectively. Figures (D) through (H) display results for LDW-CPS-1-based subsamples constructed with the top-ranked methods. Analogously, figures (I) through (M) summarize results for the corresponding LDW-PSID-1-based subsamples under parallel rules. Figures (N) and (O) present results for the trimmed and matched versions, replicating the tutorial results of Imbens &amp; Xu (2024).</p>
<p>The LDW-CPS-1 sample produces ATT estimates that closely align with the benchmark with an exception for one estimator similar as in model A. Across its <code>nn_crump</code> and <code>caliper_crump</code> and <code>genetic_crump</code> subsamples all estimators produce ATT estimates that reasonably closely align with the benchmark. Some larger deviations from the benchmark occur for the <code>genetic_common_range</code> and <code>genetic_ps_threshold</code> subsamples.</p>
<p>As for LDW-CPS-1, the LDW-PSID-1 sample produces ATT estimates that reasonably closely align with the benchmark with an exception for only one estimator. Across its top-ranked samples, all estimators generally yield ATT estimates that exhibit greater dispersion from the benchmark and considerably larger standard errors.</p>
<p>Overall, these results show a similar pattern as observed in model A.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-1" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb232-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-2" tabindex="-1"></a>all_summaries <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_outs, eval_att)</span>
<span id="cb232-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-3" tabindex="-1"></a>att_summary <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, all_summaries)</span>
<span id="cb232-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-4" tabindex="-1"></a><span class="fu">rownames</span>(att_summary) <span class="ot">&lt;-</span> all_plot_titles</span>
<span id="cb232-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-5" tabindex="-1"></a></span>
<span id="cb232-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-6" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb232-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-7" tabindex="-1"></a><span class="fu">datatable</span>(att_summary, <span class="at">caption =</span> <span class="st">&quot;ATT Summary Statistics&quot;</span>,</span>
<span id="cb232-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb232-8" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-008ccd84c8368fd92a29" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-008ccd84c8368fd92a29">{"x":{"filter":"none","vertical":false,"caption":"<caption>ATT Summary Statistics<\/caption>","data":[["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: nn_crump","(E) Top CPS-1: caliper_crump","(F) Top CPS-1: genetic_crump","(G) Top CPS-1: genetic_common_range","(H) Top CPS-1: genetic_ps_threshold","(I) Top PSID-1: optimal_pair_stuermer","(J) Top PSID-1: cs_stuermer","(K) Top PSID-1: k3_walker","(L) Top PSID-1: mahvars_stuermer","(M) Top PSID-1: genetic_stuermer","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[675.9767141063347,670.2562110774919,883.3786725025905,881.3913446326193,881.356363503678,811.6349814847301,770.3046495843848,781.630875236422,1167.440875704155,1331.022574655404,1308.763162555997,2304.987179574334,1200.183286471578,805.3829694934813,1185.983216675225],[1583.554413555829,-8497.516148135088,-15204.77742149167,1293.624886223185,1293.624886223185,1510.94578341313,1259.074369356442,1156.919671841771,-2297.622998737841,-2036.544994426225,-2722.79590094226,-6516.649424196646,-1738.034056710437,1018.974003914674,-2510.852412719727],[2003.357402083936,1682.914702871173,2424.452718887471,2295.273057469918,2295.273057469918,2098.881008795972,2116.94112378769,2002.193290234309,-726.1013118096029,-709.8977606363641,-2175.010753714962,-2997.518078039092,-901.8154308251706,2069.686042710558,-412.7895457775492],[419.8029885281062,10180.43085100626,17629.23014037915,1001.648171246733,1001.648171246733,587.9352253828424,857.8667544312482,845.2736183925374,1571.521686928238,1326.64723378986,547.7851472272987,3519.131346157554,836.218625885266,1050.712038795884,2098.062866942178]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean_SE<\/th>\n      <th>Min_Estimate<\/th>\n      <th>Max_Estimate<\/th>\n      <th>Diff_Estimate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Mean_SE","targets":1},{"name":"Min_Estimate","targets":2},{"name":"Max_Estimate","targets":3},{"name":"Diff_Estimate","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-1" tabindex="-1"></a><span class="co"># get result matrix</span></span>
<span id="cb233-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-2" tabindex="-1"></a>out.cps_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim[[j]])</span>
<span id="cb233-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-3" tabindex="-1"></a>out.psid_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim[[j]])</span>
<span id="cb233-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-4" tabindex="-1"></a>all_out_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1), out.cps_top, out.psid_top, <span class="fu">list</span>(out4, out5))</span>
<span id="cb233-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-5" tabindex="-1"></a>result_mat <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs, all_out_mat, all_plot_titles)</span>
<span id="cb233-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-6" tabindex="-1"></a></span>
<span id="cb233-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-7" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb233-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-8" tabindex="-1"></a><span class="fu">datatable</span>(result_mat, <span class="at">caption =</span> <span class="st">&quot;ATT Estimates and SEs&quot;</span>,</span>
<span id="cb233-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb233-9" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-29f760fab89c1872be1f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-29f760fab89c1872be1f">{"x":{"filter":"none","vertical":false,"caption":"<caption>ATT Estimates and SEs<\/caption>","data":[["Experimental Benchmark","diff","reg","om.reg","om.grf","matching","psm","ipw","cbps","ebal","dml","aipw_grf","aipw_ow"],["1794.34","1794.34","1605.52","1709.79","1759.36","1583.55","2003.36","1808.52","1699.09","1701.38","1814.98","1791.51","1848.58"],["(670.82)","(670.82)","(665.93)","(587.92)","(581.97)","(785.15)","(698.21)","(681.51)","(699.19)","(699.39)","(670.37)","(689.14)","(682.11)"],["1794.34","-8497.52","1484.61","1553.68","1164.55","1591.49","1162.74","1149.70","1493.80","1492.13","270.99","1682.91","1471.91"],["(670.82)","(581.92)","(631.51)","(621.16)","(625.47)","(832.21)","(739.79)","(684.62)","(652.71)","(652.66)","(611.84)","(721.78)","(687.41)"],["1794.34","-15204.78","1227.70","2052.84","449.34","2174.97","1154.56","729.65","2359.12","2424.45","16.81","1367.67","1234.26"],["(670.82)","(655.91)","(892.77)","(644.01)","(636.41)","(1575.49)","(944.07)","(931.05)","(873.16)","(875.94)","(884.70)","(886.34)","(800.69)"],["548.57","1293.62","1632.63","1932.34","1890.55","2295.27","1588.26","1966.58","1966.58","1931.96","1317.55","2069.13","2050.59"],["(692.75)","(905.70)","(897.09)","(651.55)","(636.03)","(1117.84)","(780.74)","(1000.89)","(1000.89)","(889.09)","(907.65)","(883.40)","(905.83)"],["548.57","1293.62","1632.63","1932.34","1811.64","2295.27","1588.26","1966.58","1966.58","1931.96","1317.55","2069.13","2050.59"],["(692.75)","(905.70)","(897.09)","(651.55)","(635.61)","(1117.84)","(780.74)","(1000.89)","(1000.89)","(889.09)","(907.65)","(883.40)","(905.83)"],["548.57","1521.02","1593.08","1740.18","1840.40","1752.23","1599.13","2098.88","2098.88","1736.68","1510.95","2076.48","1975.17"],["(692.75)","(826.69)","(805.30)","(646.56)","(636.41)","(1019.57)","(729.51)","(863.55)","(863.55)","(835.11)","(812.52)","(834.79)","(866.07)"],["-3857.69","1325.23","1678.24","1800.75","1713.05","2116.94","1303.38","1880.19","1880.19","1799.07","1259.07","2015.86","1777.20"],["(586.66)","(798.67)","(757.80)","(607.68)","(587.84)","(907.45)","(717.67)","(835.49)","(835.49)","(770.89)","(799.44)","(789.71)","(835.51)"],["-8497.52","1281.99","1609.31","1729.96","1608.88","2002.19","1453.23","1694.35","1694.35","1728.40","1156.92","1999.14","1878.68"],["(581.92)","(808.46)","(765.34)","(607.68)","(586.93)","(917.89)","(721.36)","(885.02)","(885.02)","(781.88)","(803.19)","(793.18)","(823.62)"],["-5593.82","-1850.63","-1650.98","-1187.74","-1470.44","-726.10","-2297.62","-1850.63","-1850.63","-1110.91","-1923.73","-846.69","-1248.25"],["(987.27)","(1182.99)","(1159.24)","(1088.42)","(886.15)","(1309.15)","(1201.56)","(1182.99)","(1182.99)","(1273.53)","(1163.65)","(1175.96)","(1202.68)"],["-5593.82","-1749.97","-1525.91","-1364.75","-1664.70","-1582.63","-2036.54","-1658.36","-1658.36","-1297.94","-1686.73","-1282.80","-709.90"],["(987.27)","(1419.93)","(1407.98)","(1003.95)","(869.75)","(1448.09)","(1179.06)","(1326.15)","(1326.15)","(1524.30)","(1397.33)","(1489.46)","(1580.12)"],["-5554.09","-2555.38","-2175.01","-2365.63","-2513.46","-2589.68","-2405.56","-2435.22","-2435.22","-2315.19","-2722.80","-2439.95","-2616.17"],["(1106.72)","(1283.74)","(1356.20)","(1279.58)","(1136.17)","(1407.70)","(1655.86)","(1359.60)","(1359.60)","(1291.74)","(1242.60)","(1160.01)","(1172.36)"],["-5593.82","-4432.22","-4066.06","-4107.89","-4471.96","-2997.52","-6516.65","-4432.22","-4432.22","-3978.61","-4568.94","-4415.90","-4279.85"],["(987.27)","(2491.32)","(2400.07)","(1443.92)","(883.09)","(2471.92)","(2422.76)","(2491.32)","(2491.32)","(2542.60)","(2448.47)","(2995.26)","(2577.80)"],["-5593.82","-1371.65","-901.82","-1152.17","-1492.23","-1376.79","-1415.31","-1476.04","-1476.04","-1111.80","-1540.14","-1220.16","-1738.03"],["(987.27)","(1299.37)","(1174.99)","(1087.61)","(899.17)","(1318.04)","(1099.03)","(1252.70)","(1252.70)","(1237.61)","(1247.46)","(1204.31)","(1329.21)"],["1911.04","1483.82","1825.06","1521.86","1484.43","2069.69","1018.97","1379.76","1509.99","1504.62","1506.35","1485.47","1612.67"],["(737.71)","(824.44)","(838.01)","(671.25)","(666.52)","(955.87)","(813.26)","(822.05)","(803.90)","(803.95)","(816.15)","(819.88)","(829.32)"],["306.29","-1505.24","-1577.78","-412.79","-1949.62","-522.75","-2510.85","-2062.92","-1217.15","-688.65","-1687.57","-2102.20","-2122.24"],["(985.98)","(1219.89)","(1278.65)","(905.98)","(725.68)","(1308.67)","(1165.31)","(1280.21)","(1251.87)","(1303.82)","(1209.49)","(1276.55)","(1305.68)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(A) LDW-Experimental<\/th>\n      <th>V2<\/th>\n      <th>(B) LDW-CPS-1<\/th>\n      <th>V4<\/th>\n      <th>(C) LDW-PSID-1<\/th>\n      <th>V6<\/th>\n      <th>(D) Top CPS-1: nn_crump<\/th>\n      <th>V8<\/th>\n      <th>(E) Top CPS-1: caliper_crump<\/th>\n      <th>V10<\/th>\n      <th>(F) Top CPS-1: genetic_crump<\/th>\n      <th>V12<\/th>\n      <th>(G) Top CPS-1: genetic_common_range<\/th>\n      <th>V14<\/th>\n      <th>(H) Top CPS-1: genetic_ps_threshold<\/th>\n      <th>V16<\/th>\n      <th>(I) Top PSID-1: optimal_pair_stuermer<\/th>\n      <th>V18<\/th>\n      <th>(J) Top PSID-1: cs_stuermer<\/th>\n      <th>V20<\/th>\n      <th>(K) Top PSID-1: k3_walker<\/th>\n      <th>V22<\/th>\n      <th>(L) Top PSID-1: mahvars_stuermer<\/th>\n      <th>V24<\/th>\n      <th>(M) Top PSID-1: genetic_stuermer<\/th>\n      <th>V26<\/th>\n      <th>(N) Trimmed LDW-CPS-1-PLUS<\/th>\n      <th>V28<\/th>\n      <th>(O) Trimmed LDW-PSID-1-PLUS<\/th>\n      <th>V30<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"(A) LDW-Experimental","targets":1},{"name":"V2","targets":2},{"name":"(B) LDW-CPS-1","targets":3},{"name":"V4","targets":4},{"name":"(C) LDW-PSID-1","targets":5},{"name":"V6","targets":6},{"name":"(D) Top CPS-1: nn_crump","targets":7},{"name":"V8","targets":8},{"name":"(E) Top CPS-1: caliper_crump","targets":9},{"name":"V10","targets":10},{"name":"(F) Top CPS-1: genetic_crump","targets":11},{"name":"V12","targets":12},{"name":"(G) Top CPS-1: genetic_common_range","targets":13},{"name":"V14","targets":14},{"name":"(H) Top CPS-1: genetic_ps_threshold","targets":15},{"name":"V16","targets":16},{"name":"(I) Top PSID-1: optimal_pair_stuermer","targets":17},{"name":"V18","targets":18},{"name":"(J) Top PSID-1: cs_stuermer","targets":19},{"name":"V20","targets":20},{"name":"(K) Top PSID-1: k3_walker","targets":21},{"name":"V22","targets":22},{"name":"(L) Top PSID-1: mahvars_stuermer","targets":23},{"name":"V24","targets":24},{"name":"(M) Top PSID-1: genetic_stuermer","targets":25},{"name":"V26","targets":26},{"name":"(N) Trimmed LDW-CPS-1-PLUS","targets":27},{"name":"V28","targets":28},{"name":"(O) Trimmed LDW-PSID-1-PLUS","targets":29},{"name":"V30","targets":30}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>As in model A, the tabulated results confirm visual patterns: Column (A) reports the estimates for the LDW-Experimental sample, column (B) for the LDW-CPS-1 sample, and column (C) for the LDW-PSID-1 sample. Columns (D)-(O) summarize the top-ranked sample results for both LDW-CPS-1 and LDW-PSID-1. Columns (N) and (O) present estimates for the trimmed and matched versions of the LDW-PSID-1-PLUS and LDW-PSID-1-PLUS samples.</p>
<p>In model B, most LDW-CPS-1-based samples yield ATT estimates that are closer to the experimental benchmark than in model A, with still modest variance. By contrast, the LDW-PSID-1-based estimates, while somewhat closer to the experimental benchmark than in model A, continue to exhibit substantially larger standard errors compared to LDW-CPS-1 samples. This again reflects the greater challenge of obtaining reliable estimates from the observational dataset LDW-PSID-1.</p>
<p>Overall, figures and table jointly demonstrate again that ATT estimates from observational samples tend to have larger standard errors compared to the experimental sample, reflecting greater statistical uncertainty in non-experimental causal effect estimation, and that certain criteria can bring observational estimates closer to the experimental benchmark. Nevertheless, significant estimator-dependent variability and sensitivity to sample construction persist.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb234-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb234-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb234-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat, <span class="st">&quot;ldw_att_est_model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="conditional-average-treatment-effect-on-the-treated-catt-2" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Conditional average treatment effect on the treated (CATT)<a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-1" tabindex="-1"></a><span class="co"># estimate CATT</span></span>
<span id="cb235-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-2" tabindex="-1"></a>catt.ldw <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw, Y, treat, covar)</span>
<span id="cb235-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-3" tabindex="-1"></a>catt.cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps, Y, treat, covar)</span>
<span id="cb235-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-4" tabindex="-1"></a>catt.psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid, Y, treat, covar)</span>
<span id="cb235-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-5" tabindex="-1"></a>catt.top5_cps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb235-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-6" tabindex="-1"></a>catt.top5_psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb235-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-7" tabindex="-1"></a>catt.top5_cps_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb235-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb235-8" tabindex="-1"></a>catt.top5_psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb236-1" tabindex="-1"></a><span class="co"># similar to Imbens &amp; Xu (2024) </span></span>
<span id="cb236-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb236-2" tabindex="-1"></a>catt.trim_cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_trim_cps, Y, treat, covar) </span>
<span id="cb236-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb236-3" tabindex="-1"></a>catt.trim_psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_trim_psid, Y, treat, covar) </span>
<span id="cb236-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb236-4" tabindex="-1"></a>catt.cps_trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps_trim, Y, treat, covar)  </span>
<span id="cb236-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb236-5" tabindex="-1"></a>catt.psid_trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid_trim, Y, treat, covar) </span></code></pre></div>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-1" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb237-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) </span>
<span id="cb237-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb237-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-4" tabindex="-1"></a></span>
<span id="cb237-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-5" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb237-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-6" tabindex="-1"></a>  <span class="at">catt1 =</span> catt.ldw<span class="sc">$</span>catt,</span>
<span id="cb237-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-7" tabindex="-1"></a>  <span class="at">catt2 =</span> catt.cps<span class="sc">$</span>catt,</span>
<span id="cb237-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-8" tabindex="-1"></a>  <span class="at">att1  =</span> catt.ldw<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb237-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-9" tabindex="-1"></a>  <span class="at">att2  =</span> catt.cps<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb237-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-10" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb237-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-11" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (CPS-1)&quot;</span>,</span>
<span id="cb237-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-12" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, </span>
<span id="cb237-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-13" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb237-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-14" tabindex="-1"></a>)</span>
<span id="cb237-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-15" tabindex="-1"></a></span>
<span id="cb237-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-16" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb237-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-17" tabindex="-1"></a>  <span class="at">catt1 =</span> catt.ldw<span class="sc">$</span>catt,</span>
<span id="cb237-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-18" tabindex="-1"></a>  <span class="at">catt2 =</span> catt.psid<span class="sc">$</span>catt,</span>
<span id="cb237-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-19" tabindex="-1"></a>  <span class="at">att1  =</span> catt.ldw<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb237-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-20" tabindex="-1"></a>  <span class="at">att2  =</span> catt.psid<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb237-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-21" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb237-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-22" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (PSID-1)&quot;</span>,</span>
<span id="cb237-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-23" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>,</span>
<span id="cb237-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-24" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb237-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-25" tabindex="-1"></a>)</span>
<span id="cb237-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-26" tabindex="-1"></a></span>
<span id="cb237-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-27" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(</span>
<span id="cb237-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-28" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_cps_trim,</span>
<span id="cb237-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-29" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_cps,</span>
<span id="cb237-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-30" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps)</span>
<span id="cb237-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb237-31" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-194-1.png" alt="FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.10: FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-194-2.png" alt="FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.11: FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb238-1" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(</span>
<span id="cb238-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb238-2" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_psid_trim,</span>
<span id="cb238-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb238-3" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_psid,</span>
<span id="cb238-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb238-4" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid)</span>
<span id="cb238-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb238-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-194-3.png" alt="FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.12: FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-194-4.png" alt="FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.13: FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-1" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb239-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-2" tabindex="-1"></a>  catt1 <span class="ot">&lt;-</span> catt.trim_cps<span class="sc">$</span>catt,</span>
<span id="cb239-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-3" tabindex="-1"></a>  catt2 <span class="ot">&lt;-</span> catt.cps_trim<span class="sc">$</span>catt,</span>
<span id="cb239-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-4" tabindex="-1"></a>  att1 <span class="ot">&lt;-</span> catt.trim_cps<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb239-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-5" tabindex="-1"></a>  att2 <span class="ot">&lt;-</span> catt.cps_trim<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb239-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-6" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb239-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-7" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (CPS-1-PLUS-Trimmed)&quot;</span>,</span>
<span id="cb239-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-8" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>, </span>
<span id="cb239-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-9" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb239-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-10" tabindex="-1"></a>)</span>
<span id="cb239-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-11" tabindex="-1"></a></span>
<span id="cb239-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-12" tabindex="-1"></a><span class="fu">plot_catt</span>(</span>
<span id="cb239-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-13" tabindex="-1"></a>  catt1 <span class="ot">&lt;-</span> catt.trim_psid<span class="sc">$</span>catt,</span>
<span id="cb239-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-14" tabindex="-1"></a>  catt2 <span class="ot">&lt;-</span> catt.psid_trim<span class="sc">$</span>catt,</span>
<span id="cb239-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-15" tabindex="-1"></a>  att1 <span class="ot">&lt;-</span> catt.trim_psid<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb239-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-16" tabindex="-1"></a>  att2 <span class="ot">&lt;-</span> catt.psid_trim<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb239-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-17" tabindex="-1"></a>  <span class="at">xlab  =</span> <span class="st">&quot;CATT (Experimental)&quot;</span>,</span>
<span id="cb239-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-18" tabindex="-1"></a>  <span class="at">ylab  =</span> <span class="st">&quot;CATT (PSID-1-PLUS-Trimmed)&quot;</span>,</span>
<span id="cb239-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-19" tabindex="-1"></a>  <span class="at">main  =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>,</span>
<span id="cb239-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-20" tabindex="-1"></a>  <span class="at">axes.range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8000</span>, <span class="dv">8000</span>)</span>
<span id="cb239-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb239-21" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-194-5.png" alt="FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.14: FIGUREB3. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. CATT Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-1" tabindex="-1"></a><span class="co"># combine all catt objects </span></span>
<span id="cb240-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-2" tabindex="-1"></a>all_catt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(catt.ldw, catt.cps, catt.psid), </span>
<span id="cb240-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-3" tabindex="-1"></a>              catt.top5_cps, catt.top5_psid, </span>
<span id="cb240-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-4" tabindex="-1"></a>              <span class="fu">list</span>(catt.cps_trim, catt.psid_trim))</span>
<span id="cb240-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-5" tabindex="-1"></a></span>
<span id="cb240-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-6" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb240-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-7" tabindex="-1"></a>all_catt_eval <span class="ot">&lt;-</span> <span class="fu">eval_catt</span>(all_catt, all_plot_titles)</span>
<span id="cb240-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-8" tabindex="-1"></a></span>
<span id="cb240-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-9" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb240-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-10" tabindex="-1"></a><span class="fu">datatable</span>(all_catt_eval, <span class="at">caption =</span> <span class="st">&quot;CATT Summary Statistics&quot;</span>,</span>
<span id="cb240-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb240-11" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-50ed0d6e05f7ae2abda4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-50ed0d6e05f7ae2abda4">{"x":{"filter":"none","vertical":false,"caption":"<caption>CATT Summary Statistics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: nn_crump","(E) Top CPS-1: caliper_crump","(F) Top CPS-1: genetic_crump","(G) Top CPS-1: genetic_common_range","(H) Top CPS-1: genetic_ps_threshold","(I) Top PSID-1: optimal_pair_stuermer","(J) Top PSID-1: cs_stuermer","(K) Top PSID-1: k3_walker","(L) Top PSID-1: mahvars_stuermer","(M) Top PSID-1: genetic_stuermer","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[-195.6064029072124,-3316.409860118028,-7666.248067214243,-817.2201261100711,-808.0318685125615,-571.1318196766671,-464.6237460736785,-383.427631468323,-2476.388998709936,-2005.467486312367,-3853.625827710775,-5049.408068938895,-2565.384284541049,-2254.803810311615,-4190.239143749601],[3809.379884315063,7047.932748693119,4739.51679527421,4750.750532112786,4855.855324702417,4486.524142322842,4472.791182589523,4487.305393000984,-619.4732240171131,-1066.866288019886,-1162.783306312592,-3374.12821814074,-596.0911255394894,5594.051784848242,370.871500608747],[1744.409578158392,2148.230469064707,433.0168691385144,1935.697718492914,1955.464875865421,1901.297286279969,1929.355346753144,1938.253618246167,-1171.276638181497,-1387.191339514588,-2179.997548791298,-4111.041422616206,-1299.703258355754,1319.509615439906,-2217.798190958849],[4004.986287222276,10364.34260881115,12405.76486248845,5567.970658222857,5663.887193214979,5057.655961999509,4937.414928663201,4870.733024469307,1856.915774692823,938.6011982924801,2690.842521398184,1675.279850798155,1969.29315900156,7848.855595159857,4561.110644358348]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Min_Catt<\/th>\n      <th>Max_Catt<\/th>\n      <th>Mean_Catt<\/th>\n      <th>Diff_Catt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Min_Catt","targets":2},{"name":"Max_Catt","targets":3},{"name":"Mean_Catt","targets":4},{"name":"Diff_Catt","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>In model B, using LDW-CPS-1, CATT estimates range from $-3,316.41 to $7,047.93. This span is considerably narrower than in model A, but still performs worse when contrasted with the experimental benchmark, where CATT estimates range from $-195.61 to $3,809.38 with a mean of $1,744.41. Further, LDW-PSID-1 shows an increased CATT estimate range, from $-7,666.25 to $4,739.52, and a reasonable lower mean of approximately $433.02 compared to LDW-CPS-1. These patterns mirror those observed in model A.</p>
<p>For LDW-CPS-1 and its top-ranked subsamples, CATT ranges vary considerably, yet their mean estimates are generally closer to the experimental benchmark, as in model A. Moreover, the minimum CATT estimates are less negative, which reduces the spread between minimum and maximum estimates.</p>
<p>The LDW-PSID-1 and its top-ranked subsamples, on the other hand, again yield decreased mean CATT estimates with varying CATT ranges compared to the LDW-CPS-1 sample, signaling persistent difficulties in generating reliable effect estimates. Still, compared to model A, the minimum CATT estimates are less strongly negative, though the mean CATTs do not improve marginally in their proximity to the experimental benchmark.</p>
<p>Hence, alike model A, these results show that there is considerable variation in ranges and means across methods and samples, reflecting substantial heterogeneity in treatment effect estimation. While certain criteria may improve consistency with the benchmark, they may also introduce notable discrepancies and variability in estimated effects.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb241-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-2" tabindex="-1"></a><span class="fu">save_main_catt_panels</span>(</span>
<span id="cb241-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-3" tabindex="-1"></a>  <span class="at">catt_refs =</span> <span class="fu">list</span>(catt.ldw),</span>
<span id="cb241-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-4" tabindex="-1"></a>  <span class="at">catt_comps =</span> <span class="fu">list</span>(catt.cps, catt.psid),</span>
<span id="cb241-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-5" tabindex="-1"></a>  <span class="at">ylabels =</span> <span class="fu">c</span>(<span class="st">&quot;CATT (CPS-1)&quot;</span>, <span class="st">&quot;CATT (PSID-1)&quot;</span>),</span>
<span id="cb241-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-6" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_catt_main_panels&quot;</span>,</span>
<span id="cb241-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-7" tabindex="-1"></a>  <span class="at">main_titles =</span> <span class="fu">c</span>(<span class="st">&quot;(B) LDW-CPS-1&quot;</span>, <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb241-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-8" tabindex="-1"></a>)</span>
<span id="cb241-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-9" tabindex="-1"></a></span>
<span id="cb241-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-10" tabindex="-1"></a><span class="fu">save_catt_panels</span>(</span>
<span id="cb241-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-11" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_cps_trim,</span>
<span id="cb241-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-12" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_cps,</span>
<span id="cb241-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-13" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps),</span>
<span id="cb241-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-14" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_catt_top5_cps&quot;</span></span>
<span id="cb241-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-15" tabindex="-1"></a>)</span>
<span id="cb241-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-16" tabindex="-1"></a></span>
<span id="cb241-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-17" tabindex="-1"></a><span class="fu">save_catt_panels</span>(</span>
<span id="cb241-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-18" tabindex="-1"></a>  <span class="at">exp_catt =</span> catt.top5_psid_trim,</span>
<span id="cb241-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-19" tabindex="-1"></a>  <span class="at">catt_list  =</span> catt.top5_psid,</span>
<span id="cb241-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-20" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[<span class="dv">9</span><span class="sc">:</span><span class="dv">13</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid),</span>
<span id="cb241-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-21" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_catt_top5_psid&quot;</span></span>
<span id="cb241-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-22" tabindex="-1"></a>)</span>
<span id="cb241-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-23" tabindex="-1"></a></span>
<span id="cb241-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-24" tabindex="-1"></a><span class="fu">save_plus_catt_panels</span>(</span>
<span id="cb241-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-25" tabindex="-1"></a>  <span class="at">catt1_list =</span> <span class="fu">list</span>(catt.trim_cps, catt.trim_psid),</span>
<span id="cb241-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-26" tabindex="-1"></a>  <span class="at">catt2_list =</span> <span class="fu">list</span>(catt.cps_trim, catt.psid_trim),</span>
<span id="cb241-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-27" tabindex="-1"></a>  <span class="at">ylabels =</span> <span class="fu">c</span>(<span class="st">&quot;CATT (CPS-1-PLUS-Trimmed)&quot;</span>, <span class="st">&quot;CATT (PSID-1-PLUS-Trimmed)&quot;</span>),</span>
<span id="cb241-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-28" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_catt_plus_panels&quot;</span>,</span>
<span id="cb241-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-29" tabindex="-1"></a>  <span class="at">main_titles =</span> <span class="fu">c</span>(<span class="st">&quot;(N) LDW-CPS-1-PLUS&quot;</span>, <span class="st">&quot;(O) LDW-PSID-1-PLUS&quot;</span>)</span>
<span id="cb241-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb241-30" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="quantile-treatment-effect-on-the-treated-qtet-1" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Quantile treatment effect on the treated (QTET)<a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-1" tabindex="-1"></a>qte.ldw <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb242-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-2" tabindex="-1"></a>qte.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps)</span>
<span id="cb242-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-3" tabindex="-1"></a>qte.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid)</span>
<span id="cb242-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-4" tabindex="-1"></a>qte.top5_cps  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb242-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-5" tabindex="-1"></a>qte.top5_psid <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb242-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-6" tabindex="-1"></a>qte.top5_cps_trim  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb242-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb242-7" tabindex="-1"></a>qte.top5_psid_trim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb243-1" tabindex="-1"></a>qte.trim.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_trim_cps)</span>
<span id="cb243-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb243-2" tabindex="-1"></a>qte.trim.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_trim_psid)</span>
<span id="cb243-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb243-3" tabindex="-1"></a>qte.ldw_cps.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps_trim) </span>
<span id="cb243-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb243-4" tabindex="-1"></a>qte.ldw_psid.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid_trim) </span></code></pre></div>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb244-1" tabindex="-1"></a>qte.ldw0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw)</span>
<span id="cb244-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb244-2" tabindex="-1"></a>qte.ldw_cps0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps)</span>
<span id="cb244-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb244-3" tabindex="-1"></a>qte.ldw_psid0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid)</span>
<span id="cb244-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb244-4" tabindex="-1"></a>qte.top5_cps_trim0  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps,  <span class="cf">function</span>(d) <span class="fu">est_qte_safe</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span>
<span id="cb244-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb244-5" tabindex="-1"></a>qte.top5_psid_trim0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid, <span class="cf">function</span>(d) <span class="fu">est_qte_safe</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb245-1" tabindex="-1"></a>qte.ldw_cps.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps_trim) </span>
<span id="cb245-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb245-2" tabindex="-1"></a>qte.ldw_psid.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid_trim) </span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb246-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb246-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-3" tabindex="-1"></a>ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>)</span>
<span id="cb246-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-4" tabindex="-1"></a></span>
<span id="cb246-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-5" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps, qte.ldw_cps0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>, ylim)</span>
<span id="cb246-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb246-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-7" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb246-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-8" tabindex="-1"></a></span>
<span id="cb246-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-9" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid, qte.ldw_psid0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>, ylim)</span>
<span id="cb246-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb246-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-11" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb246-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-12" tabindex="-1"></a></span>
<span id="cb246-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb246-13" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_cps_trim, qte.top5_cps_trim0, qte.top5_cps, all_plot_titles, <span class="at">main_start =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-201-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-201-1.png" alt="FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.15: FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb247-1" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_psid_trim, qte.top5_psid_trim0, qte.top5_psid, all_plot_titles, <span class="at">main_start =</span> <span class="dv">9</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-201-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-201-2.png" alt="FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.16: FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-201-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-201-3.png" alt="FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.17: FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-1" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps.trim, qte.ldw_cps.trim0, qte.trim.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(N) LDW-CPS-1-PLUS (Trimmed)&quot;</span>, ylim)</span>
<span id="cb248-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb248-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-3" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb248-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-4" tabindex="-1"></a></span>
<span id="cb248-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-5" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid.trim, qte.ldw_psid.trim0, qte.trim.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(O) LDW-PSID-1-PLUS (Trimmed)&quot;</span>, ylim)</span>
<span id="cb248-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb248-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb248-7" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-201-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-201-4.png" alt="FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.18: FIGUREB4. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. QTET Estimates Model A using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<p>These figures display QTET estimates derived from both the experimental and various observational samples.
The QTETs estimated from LDW-Experimental (A), the LDW-CPS-1 sample (B), its top-ranked <code>nn_crump</code> (D), <code>caliper_crump</code> (E) and <code>genetic_ps_threshold</code> (H) subsamples as well as the trimmed and matched version of LDW-CPS-1-PLUS (N) continue to correspond well with the true QTET.</p>
<p>The QTET estimates from the LDW-PSID-1 sample (C), its top-ranked subsamples and the trimmed and matched version of LDW-PSID-1-PLUS (O) show clear biases and noticeably wider confidence bands when compared to the experimental benchmark, indicating greater estimation uncertainty.</p>
<p>Overall, these patterns mirror those observed in model A.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-1" tabindex="-1"></a><span class="co"># list results</span></span>
<span id="cb249-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-2" tabindex="-1"></a>plots_ldw <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb249-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps, <span class="at">mod0 =</span> qte.ldw_cps0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>),</span>
<span id="cb249-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid, <span class="at">mod0 =</span> qte.ldw_psid0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>),</span>
<span id="cb249-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps.trim, <span class="at">mod0 =</span> qte.ldw_cps.trim0, <span class="at">bm =</span> qte.trim.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(N) LDW-CPS-1-PLUS (Trimmed)&quot;</span>),</span>
<span id="cb249-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-6" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid.trim, <span class="at">mod0 =</span> qte.ldw_psid.trim0, <span class="at">bm =</span> qte.trim.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(O) LDW-PSID-1-PLUS (Trimmed)&quot;</span>)</span>
<span id="cb249-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-7" tabindex="-1"></a>)</span>
<span id="cb249-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-8" tabindex="-1"></a></span>
<span id="cb249-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-9" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb249-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-10" tabindex="-1"></a><span class="fu">save_qtet</span>(plots_ldw, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b&quot;</span>)</span>
<span id="cb249-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-11" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_cps_trim, qte.top5_cps_trim0, qte.top5_cps, all_plot_titles, <span class="at">main_start =</span> <span class="dv">8</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_top&quot;</span>)</span>
<span id="cb249-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb249-12" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_psid_trim, qte.top5_psid_trim0, qte.top5_psid, all_plot_titles, <span class="at">main_start =</span> <span class="dv">13</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_top&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-outcome-weights-ow-1" class="section level3 hasAnchor" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Assessing outcome weights (OW)<a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb250-1" tabindex="-1"></a><span class="co"># list all datasets</span></span>
<span id="cb250-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb250-2" tabindex="-1"></a>all_datasets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(ldw, ldw_cps, ldw_psid), top5_datasets.cps, top5_datasets.psid, <span class="fu">list</span>(ldw_trim_cps, ldw_trim_psid))</span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb251-1" tabindex="-1"></a><span class="co"># estimate ATT </span></span>
<span id="cb251-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb251-2" tabindex="-1"></a>res_att <span class="ot">&lt;-</span> <span class="fu">get_res_att</span>(all_datasets, Y, treat, covar)</span></code></pre></div>
<pre><code>## OUTCOME WEIGHTS SUMMARY: 15 succeeded, 0 failed out of 15 datasets</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb253-1" tabindex="-1"></a><span class="co"># extract outcome weights</span></span>
<span id="cb253-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb253-2" tabindex="-1"></a>ow_att <span class="ot">&lt;-</span> <span class="fu">derive_ow</span>(res_att)</span></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb254-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb254-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb254-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb254-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb254-3" tabindex="-1"></a></span>
<span id="cb254-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb254-4" tabindex="-1"></a><span class="co"># plot outcome weights distribution</span></span>
<span id="cb254-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb254-5" tabindex="-1"></a><span class="fu">plot_ow</span>(ow_att, all_plot_titles) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-205-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-205-1.png" alt="FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.19: FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-205-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-205-2.png" alt="FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.20: FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-205-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-205-3.png" alt="FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.21: FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-205-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-205-4.png" alt="FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1.  SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.22: FIGUREB5. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-1" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb255-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-2" tabindex="-1"></a>res_ow <span class="ot">&lt;-</span> <span class="fu">eval_ow</span>(ow_att, all_datasets, all_plot_titles, treat, <span class="st">&quot;AIPW-ATT&quot;</span>)</span>
<span id="cb255-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-3" tabindex="-1"></a></span>
<span id="cb255-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-4" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb255-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-5" tabindex="-1"></a><span class="fu">datatable</span>(res_ow, <span class="at">caption =</span> <span class="st">&quot;Outcome Weights for Treated and Untreated&quot;</span>,</span>
<span id="cb255-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb255-6" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cf70fff570f11ea15ddf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cf70fff570f11ea15ddf">{"x":{"filter":"none","vertical":false,"caption":"<caption>Outcome Weights for Treated and Untreated<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: nn_crump","(E) Top CPS-1: caliper_crump","(F) Top CPS-1: genetic_crump","(G) Top CPS-1: genetic_common_range","(H) Top CPS-1: genetic_ps_threshold","(I) Top PSID-1: optimal_pair_stuermer","(J) Top PSID-1: cs_stuermer","(K) Top PSID-1: k3_walker","(L) Top PSID-1: mahvars_stuermer","(M) Top PSID-1: genetic_stuermer","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[1,1,0.9999999999999999,1,1,0.9999999999999999,1,0.9999999999999999,1,1,1,1,1,1,1],[-0.9999999999999999,-0.9999999999999987,-1,-1,-1,-0.9999999999999999,-1,-0.9999999999999999,-1,-1,-1,-1,-1,-1,-1],[1.110223024625157e-16,1.332267629550188e-15,-1.110223024625157e-16,0,0,0,0,0,0,0,0,0,2.220446049250313e-16,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Sum_Treated<\/th>\n      <th>Sum_Untreated<\/th>\n      <th>Total_Sum<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Sum_Treated","targets":2},{"name":"Sum_Untreated","targets":3},{"name":"Total_Sum","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>In model B, the evaluation once again confirms that, across each sample, the estimated outcome weights sum to one within the treated group and to minus one within the untreated group, yielding an overall total of zero. Note, that minor deviations from exact values are attributable to floating-point rounding error in numerical summation.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-1" tabindex="-1"></a><span class="co">#save results</span></span>
<span id="cb256-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-2" tabindex="-1"></a><span class="fu">save_ow</span>(ow_att, all_plot_titles, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b&quot;</span>)</span>
<span id="cb256-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-3" tabindex="-1"></a><span class="fu">save_csv</span>(res_ow, <span class="st">&quot;ldw_model_b_ow&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="validation-through-placebo-analyses-1" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Validation through placebo analyses<a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb257-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re75&quot;</span></span>
<span id="cb257-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb257-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;u74&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on original and observational samples</span></span>
<span id="cb258-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-2" tabindex="-1"></a>out1_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb258-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-3" tabindex="-1"></a>out2_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb258-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-4" tabindex="-1"></a>out3_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, Y, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on top ranked samples</span></span>
<span id="cb259-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-2" tabindex="-1"></a>out.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb259-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-3" tabindex="-1"></a>out.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb259-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-4" tabindex="-1"></a>out.cps_trim_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.cps, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb259-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-5" tabindex="-1"></a>out.psid_trim_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_trim.psid, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y, <span class="st">&quot;treat&quot;</span>, covar))</span></code></pre></div>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on plus samples</span></span>
<span id="cb260-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/trimmed.RData&quot;</span>)</span>
<span id="cb260-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-3" tabindex="-1"></a>out4_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_cps_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb260-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-4" tabindex="-1"></a>out5_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_trim_psid_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb260-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-5" tabindex="-1"></a>out6_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps_trim_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb260-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-6" tabindex="-1"></a>out7_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid_trim_pl, Y, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb261-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-2" tabindex="-1"></a></span>
<span id="cb261-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-3" tabindex="-1"></a><span class="co"># experimental benchmarks</span></span>
<span id="cb261-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-4" tabindex="-1"></a>band.exp_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb261-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-5" tabindex="-1"></a>est.exp_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb261-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-6" tabindex="-1"></a></span>
<span id="cb261-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-7" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb261-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out1_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl, </span>
<span id="cb261-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(A) LDW-Experimental&quot;</span>)</span>
<span id="cb261-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-10" tabindex="-1"></a></span>
<span id="cb261-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out2_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl, </span>
<span id="cb261-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS-1&quot;</span>)</span>
<span id="cb261-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-13" tabindex="-1"></a></span>
<span id="cb261-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-14" tabindex="-1"></a><span class="fu">plot_coef</span>(out3_pl,  <span class="at">band =</span> band.exp_pl, <span class="at">line =</span> est.exp_pl,</span>
<span id="cb261-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-15" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID-1&quot;</span>)</span>
<span id="cb261-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-16" tabindex="-1"></a></span>
<span id="cb261-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-17" tabindex="-1"></a><span class="co"># get nonexperimtenal benchmarks</span></span>
<span id="cb261-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-18" tabindex="-1"></a>method_names_cps <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.cps, <span class="cf">function</span>(m) {</span>
<span id="cb261-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-19" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.cps_trim_pl)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.cps_trim_pl), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb261-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb261-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-21" tabindex="-1"></a>})</span>
<span id="cb261-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-22" tabindex="-1"></a>method_names_psid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(top5_methods.psid, <span class="cf">function</span>(m) {</span>
<span id="cb261-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-23" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">names</span>(out.psid_trim_pl)[<span class="fu">sapply</span>(<span class="fu">names</span>(out.psid_trim_pl), <span class="cf">function</span>(n) <span class="fu">grepl</span>(n, m, <span class="at">fixed=</span><span class="cn">TRUE</span>))]</span>
<span id="cb261-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-24" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(matches) <span class="sc">&gt;</span> <span class="dv">0</span>) matches[<span class="fu">which.max</span>(<span class="fu">nchar</span>(matches))] <span class="cf">else</span> <span class="cn">NA</span> </span>
<span id="cb261-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-25" tabindex="-1"></a>})</span>
<span id="cb261-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-26" tabindex="-1"></a></span>
<span id="cb261-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-27" tabindex="-1"></a>band.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) {<span class="fu">as.numeric</span>(out.cps_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])})</span>
<span id="cb261-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-28" tabindex="-1"></a>est.cps_pl  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb261-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-29" tabindex="-1"></a>band.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) {<span class="fu">as.numeric</span>(out.psid_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])})</span>
<span id="cb261-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-30" tabindex="-1"></a>est.psid_pl  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim_pl[[j]][<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb261-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-31" tabindex="-1"></a></span>
<span id="cb261-32"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-32" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb261-33"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-33" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.cps_pl)) {</span>
<span id="cb261-34"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-34" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) Top CPS-1: &quot;</span>, top5_methods.cps[i])</span>
<span id="cb261-35"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-35" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.cps_pl[[i]], <span class="at">band =</span> band.cps_pl[[i]], <span class="at">line =</span> est.cps_pl[[i]],</span>
<span id="cb261-36"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-36" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb261-37"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-37" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-212-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-212-1.png" alt="FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.23: FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-212-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-212-2.png" alt="FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.24: FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(out.psid_pl)) {</span>
<span id="cb262-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-2" tabindex="-1"></a>  this_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) Top PSID-1: &quot;</span>, top5_methods.psid[i])</span>
<span id="cb262-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-3" tabindex="-1"></a>  <span class="fu">plot_coef</span>(out.psid_pl[[i]], <span class="at">band =</span> band.psid_pl[[i]], <span class="at">line =</span> est.psid_pl[[i]],</span>
<span id="cb262-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-4" tabindex="-1"></a>            <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">main =</span> this_title)</span>
<span id="cb262-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-212-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-212-3.png" alt="FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.25: FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-1" tabindex="-1"></a><span class="co"># nonexperimtenal benchmarks</span></span>
<span id="cb263-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-2" tabindex="-1"></a>band.cps_plus_pl <span class="ot">&lt;-</span> out4_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb263-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-3" tabindex="-1"></a>est.cps_plus_pl <span class="ot">&lt;-</span> out4_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb263-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-4" tabindex="-1"></a>band.psid_plus_pl <span class="ot">&lt;-</span> out5_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb263-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-5" tabindex="-1"></a>est.psid_plus_pl <span class="ot">&lt;-</span> out5_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb263-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-6" tabindex="-1"></a></span>
<span id="cb263-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-7" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb263-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-8" tabindex="-1"></a><span class="fu">plot_coef</span>(out6_pl, <span class="at">band =</span> band.cps_plus_pl, <span class="at">line =</span> est.cps_plus_pl, </span>
<span id="cb263-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-9" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12000</span>, <span class="dv">2000</span>), <span class="at">main =</span> <span class="st">&quot;(N) Trimmed LDW-CPS-1-PLUS&quot;</span>)</span>
<span id="cb263-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-10" tabindex="-1"></a></span>
<span id="cb263-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-11" tabindex="-1"></a><span class="fu">plot_coef</span>(out7_pl, <span class="at">band =</span> band.psid_plus_pl, <span class="at">line =</span> est.psid_plus_pl, </span>
<span id="cb263-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb263-12" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12000</span>, <span class="dv">2000</span>), <span class="at">main =</span> <span class="st">&quot;(O) Trimmed LDW-PSID-1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-212-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-212-4.png" alt="FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.26: FIGUREB6. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-1" tabindex="-1"></a><span class="co"># combine results</span></span>
<span id="cb264-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-2" tabindex="-1"></a>all_outs_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl), out.cps_pl, out.psid_pl, <span class="fu">list</span>(out6_pl, out7_pl))</span>
<span id="cb264-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-3" tabindex="-1"></a>all_bands_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(band.exp_pl, band.exp_pl, band.exp_pl), band.cps_pl, band.psid_pl, <span class="fu">list</span>(band.cps_plus_pl, band.psid_plus_pl))</span>
<span id="cb264-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-4" tabindex="-1"></a>all_ests_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(est.exp_pl, est.exp_pl, est.exp_pl), est.cps_pl, est.psid_pl, <span class="fu">list</span>(est.cps_plus_pl, est.psid_plus_pl))</span>
<span id="cb264-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-5" tabindex="-1"></a></span>
<span id="cb264-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-6" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb264-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-7" tabindex="-1"></a><span class="fu">save_att_panels</span>(</span>
<span id="cb264-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-8" tabindex="-1"></a>    <span class="at">out_list    =</span> all_outs_pl,</span>
<span id="cb264-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-9" tabindex="-1"></a>    <span class="at">plot_titles =</span> all_plot_titles,</span>
<span id="cb264-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-10" tabindex="-1"></a>    <span class="at">band_list   =</span> all_bands_pl,</span>
<span id="cb264-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-11" tabindex="-1"></a>    <span class="at">est_list    =</span> all_ests_pl,</span>
<span id="cb264-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-12" tabindex="-1"></a>    <span class="at">prefix      =</span> <span class="st">&quot;ldw_model_b_pl_est_comb&quot;</span></span>
<span id="cb264-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-13" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-1" tabindex="-1"></a><span class="co"># get placebo results</span></span>
<span id="cb265-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-2" tabindex="-1"></a>all_outs_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl), out.cps_pl, out.psid_pl, <span class="fu">list</span>(out6_pl, out7_pl))</span>
<span id="cb265-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-3" tabindex="-1"></a>out.cps_top_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_cps, <span class="cf">function</span>(j) out.cps_trim_pl[[j]])</span>
<span id="cb265-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-4" tabindex="-1"></a>out.psid_top_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(method_names_psid, <span class="cf">function</span>(j) out.psid_trim_pl[[j]])</span>
<span id="cb265-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-5" tabindex="-1"></a>all_out_mat_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl), out.cps_top_pl, out.psid_top_pl, <span class="fu">list</span>(out4_pl, out5_pl))</span>
<span id="cb265-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-6" tabindex="-1"></a>result_mat_pl <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs_pl, all_out_mat_pl, all_plot_titles)</span>
<span id="cb265-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-7" tabindex="-1"></a></span>
<span id="cb265-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-8" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb265-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-9" tabindex="-1"></a><span class="fu">datatable</span>(result_mat_pl, <span class="at">caption =</span> <span class="st">&quot;Placebo ATT Estimates and SEs&quot;</span>,</span>
<span id="cb265-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb265-10" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-05d5255e0553fb0e21a9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-05d5255e0553fb0e21a9">{"x":{"filter":"none","vertical":false,"caption":"<caption>Placebo ATT Estimates and SEs<\/caption>","data":[["Experimental Benchmark","diff","reg","om.reg","om.grf","matching","psm","ipw","cbps","ebal","dml","aipw_grf","aipw_ow"],["265.15","265.15","69.27","19.66","20.47","38.18","215.26","147.39","26.98","28.61","203.82","26.41","81.29"],["(305.00)","(305.00)","(247.94)","(283.70)","(280.84)","(251.82)","(323.48)","(317.66)","(333.87)","(333.77)","(271.39)","(243.94)","(242.62)"],["265.15","-12118.75","660.83","799.37","-2093.85","-1937.76","-2201.37","-2089.91","-2122.24","-2119.43","-635.94","-1830.45","-1899.32"],["(305.00)","(247.18)","(420.04)","(508.30)","(396.56)","(375.30)","(468.30)","(363.80)","(327.83)","(327.76)","(360.55)","(286.30)","(303.72)"],["265.15","-17531.28","2299.67","4446.93","-5025.62","-2379.28","-3518.26","-3812.37","-3043.49","-3085.05","-696.89","-2733.31","-3235.78"],["(305.00)","(360.60)","(909.35)","(739.98)","(355.33)","(867.21)","(580.22)","(845.02)","(962.24)","(960.59)","(827.83)","(741.88)","(737.09)"],["-1143.55","-535.25","-201.16","-173.98","-280.91","-484.28","-615.27","-34.41","-34.41","-178.26","-403.97","-231.92","-333.26"],["(207.71)","(292.11)","(263.95)","(171.66)","(164.25)","(287.79)","(269.57)","(248.91)","(248.91)","(308.29)","(273.64)","(283.88)","(309.00)"],["-1143.55","-535.25","-201.16","-173.98","-252.76","-484.28","-615.27","-34.41","-34.41","-178.26","-403.97","-231.92","-333.26"],["(207.71)","(292.11)","(263.95)","(171.66)","(164.54)","(287.79)","(269.57)","(248.91)","(248.91)","(308.29)","(273.64)","(283.88)","(309.00)"],["-1143.55","-370.45","-160.26","-185.93","-147.16","-327.83","-495.33","12.16","12.16","-180.83","-306.94","-141.06","-54.02"],["(207.71)","(278.34)","(242.19)","(168.91)","(163.23)","(236.02)","(232.90)","(242.12)","(242.12)","(280.90)","(260.54)","(239.54)","(242.49)"],["-5745.40","-649.79","-233.83","-211.72","-215.08","-273.40","-824.40","-22.90","-22.90","-201.54","-506.62","-168.60","-261.00"],["(254.14)","(433.73)","(347.13)","(289.65)","(277.82)","(289.77)","(384.98)","(369.34)","(369.34)","(382.94)","(402.91)","(299.06)","(351.03)"],["-12118.75","-634.70","-209.03","-189.23","-179.43","-322.51","-359.92","-19.31","-19.31","-183.20","-547.43","-103.89","-125.44"],["(247.18)","(437.58)","(353.53)","(289.10)","(274.60)","(295.78)","(362.26)","(371.17)","(371.17)","(383.72)","(405.16)","(299.06)","(355.56)"],["-3620.41","-431.71","-202.01","-197.62","-316.44","-172.59","-418.49","-431.71","-431.71","-186.17","-553.40","-193.26","-289.33"],["(611.15)","(665.86)","(668.06)","(585.32)","(535.64)","(734.61)","(661.69)","(665.86)","(665.86)","(766.45)","(662.73)","(703.91)","(708.59)"],["-3620.41","237.43","351.89","285.45","324.73","132.47","189.26","198.96","198.96","140.06","351.34","397.05","572.57"],["(611.15)","(726.53)","(750.60)","(561.54)","(535.33)","(789.50)","(615.97)","(746.17)","(746.17)","(867.18)","(710.34)","(768.95)","(797.58)"],["-2678.93","-284.71","-235.53","-115.87","-381.17","-69.55","-348.29","127.00","127.00","-312.42","-245.83","-568.28","-586.79"],["(813.41)","(940.05)","(918.05)","(893.57)","(807.57)","(856.15)","(1031.57)","(863.09)","(863.09)","(912.01)","(936.30)","(840.13)","(877.39)"],["-3620.41","-184.54","-174.78","-198.02","-166.31","38.96","-524.07","-184.54","-184.54","-256.43","-239.58","-181.04","-180.51"],["(611.15)","(748.27)","(721.09)","(590.44)","(548.28)","(600.49)","(744.95)","(748.27)","(748.27)","(743.61)","(724.85)","(697.54)","(802.29)"],["-3620.41","-263.48","-274.59","-238.98","-330.78","-48.67","-1285.58","-194.61","-194.61","-260.13","-321.52","-254.76","-391.03"],["(611.15)","(826.28)","(767.40)","(625.06)","(549.29)","(708.04)","(741.36)","(787.94)","(787.94)","(776.17)","(820.23)","(719.79)","(826.92)"],["273.86","-1456.55","-1168.37","-1105.84","-1439.48","-1461.60","-1507.16","-1829.47","-1119.71","-1119.15","-1366.91","-1535.14","-1564.72"],["(334.27)","(484.60)","(402.37)","(342.32)","(341.72)","(361.61)","(446.36)","(518.46)","(444.98)","(444.92)","(456.73)","(439.41)","(483.69)"],["-210.15","-4670.77","-3607.58","-3272.83","-4416.54","-3039.41","-4028.46","-4439.35","-3416.15","-3315.62","-4649.46","-3871.33","-4282.45"],["(693.12)","(1057.12)","(977.95)","(746.61)","(527.36)","(963.34)","(1046.46)","(1050.34)","(1020.14)","(1022.71)","(1025.22)","(978.86)","(1079.25)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(A) LDW-Experimental<\/th>\n      <th>V2<\/th>\n      <th>(B) LDW-CPS-1<\/th>\n      <th>V4<\/th>\n      <th>(C) LDW-PSID-1<\/th>\n      <th>V6<\/th>\n      <th>(D) Top CPS-1: nn_crump<\/th>\n      <th>V8<\/th>\n      <th>(E) Top CPS-1: caliper_crump<\/th>\n      <th>V10<\/th>\n      <th>(F) Top CPS-1: genetic_crump<\/th>\n      <th>V12<\/th>\n      <th>(G) Top CPS-1: genetic_common_range<\/th>\n      <th>V14<\/th>\n      <th>(H) Top CPS-1: genetic_ps_threshold<\/th>\n      <th>V16<\/th>\n      <th>(I) Top PSID-1: optimal_pair_stuermer<\/th>\n      <th>V18<\/th>\n      <th>(J) Top PSID-1: cs_stuermer<\/th>\n      <th>V20<\/th>\n      <th>(K) Top PSID-1: k3_walker<\/th>\n      <th>V22<\/th>\n      <th>(L) Top PSID-1: mahvars_stuermer<\/th>\n      <th>V24<\/th>\n      <th>(M) Top PSID-1: genetic_stuermer<\/th>\n      <th>V26<\/th>\n      <th>(N) Trimmed LDW-CPS-1-PLUS<\/th>\n      <th>V28<\/th>\n      <th>(O) Trimmed LDW-PSID-1-PLUS<\/th>\n      <th>V30<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"(A) LDW-Experimental","targets":1},{"name":"V2","targets":2},{"name":"(B) LDW-CPS-1","targets":3},{"name":"V4","targets":4},{"name":"(C) LDW-PSID-1","targets":5},{"name":"V6","targets":6},{"name":"(D) Top CPS-1: nn_crump","targets":7},{"name":"V8","targets":8},{"name":"(E) Top CPS-1: caliper_crump","targets":9},{"name":"V10","targets":10},{"name":"(F) Top CPS-1: genetic_crump","targets":11},{"name":"V12","targets":12},{"name":"(G) Top CPS-1: genetic_common_range","targets":13},{"name":"V14","targets":14},{"name":"(H) Top CPS-1: genetic_ps_threshold","targets":15},{"name":"V16","targets":16},{"name":"(I) Top PSID-1: optimal_pair_stuermer","targets":17},{"name":"V18","targets":18},{"name":"(J) Top PSID-1: cs_stuermer","targets":19},{"name":"V20","targets":20},{"name":"(K) Top PSID-1: k3_walker","targets":21},{"name":"V22","targets":22},{"name":"(L) Top PSID-1: mahvars_stuermer","targets":23},{"name":"V24","targets":24},{"name":"(M) Top PSID-1: genetic_stuermer","targets":25},{"name":"V26","targets":26},{"name":"(N) Trimmed LDW-CPS-1-PLUS","targets":27},{"name":"V28","targets":28},{"name":"(O) Trimmed LDW-PSID-1-PLUS","targets":29},{"name":"V30","targets":30}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The placebo analysis shows that the experimental benchmarks remain close to zero and statistically insignificant, closely mirroring the results in model A. The results for LDW-CPS-1 and LDW-PSID-1 are similar to those observed in model A.</p>
<p>For LDW-CPS-1 subsamples (D-H), ATT estimates remain largely negative with only a few exceptions, with modest improvement toward the benchmark compared to LDW-CPS-1 (B) estimates and notably wider confidence intervals, revealing persistent imbalance and increased uncertainty. For LDW-PSID-1 subsamples (I-M), a similar pattern results compared to the LDW-PSID-1 sample.</p>
<p>As in model A, the trimmed and matched versions of LDW-CPS-1-PLUS and LDW-PSID-1-PLUS exhibit even larger negative ATT estimates, continuing to reflect substantial bias and deviation from the true effect and highlighting the persistent challenges in adjusting for confounding using observational data.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb266-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb266-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb266-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat_pl, <span class="st">&quot;ldw_att_estimates_pl_model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="validation-through-sensitivity-analyses-1" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Validation through sensitivity analyses<a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb267-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb267-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb267-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span></span>
<span id="cb267-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb267-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb267-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb267-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>)</span>
<span id="cb267-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb267-5" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;re75&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb268-1" tabindex="-1"></a><span class="co"># check for valid datasets </span></span>
<span id="cb268-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb268-2" tabindex="-1"></a>filtered_datasets_sens <span class="ot">&lt;-</span> <span class="fu">check_filter_datasets</span>(all_datasets, Y, treat, covar, bm)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb269-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb269-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-3" tabindex="-1"></a></span>
<span id="cb269-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-4" tabindex="-1"></a><span class="co"># loop over valid datasets and assign index</span></span>
<span id="cb269-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(filtered_datasets_sens)) {</span>
<span id="cb269-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-6" tabindex="-1"></a>    <span class="fu">sens_ana</span>(filtered_datasets_sens[[i]], Y, treat, covar, bm, <span class="at">kd =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb269-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-7" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> all_plot_titles[i])</span>
<span id="cb269-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb269-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-218-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-218-1.png" alt="FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.27: FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-218-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-218-2.png" alt="FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.28: FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-218-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-218-3.png" alt="FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.29: FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-218-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-218-4.png" alt="FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.30: FIGUREB7. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Sensitivity Analyses Model B
</p>
</div>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb270-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb270-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb270-2" tabindex="-1"></a><span class="fu">save_sensitivity_plots</span>(filtered_datasets_sens, Y, treat, covar, bm, all_plot_titles, <span class="st">&quot;ldw_model_b&quot;</span>)</span></code></pre></div>
<pre><code>## SUMMARY: Sensitivity plots - 15 succeeded, 0 failed out of 15 total</code></pre>
<p>The sensitivity analysis demonstrates identical results for LDW-Experimental, LDW-CPS-1 and LDW-PSID-1 as in model A.</p>
<p>Specifically, it shows that for the LDW-Experimental sample, as well as for the LDW-CPS-1 and its top-ranked subsamples <code>nn_crump</code>, <code>caliper_crump</code> and <code>genetic_crump</code> (D-F) the estimated treatment effects are fairly robust to increasing confounder strength, as indicated by relatively stable values despite up to triple the correlation levels of the confounder. For the trimmed and matched LDW-CPS1-PLUS and LDW-PSID1-PLUS samples the estimated treatment effects remain also fairly robust, indicating improved resistance to unmeasured confounding due to this integrated approach.</p>
<p>For two top-ranked subsamples of LDW-CPS-1, including <code>genetic_common_range</code> (G) and <code>genetic_ps_threshold</code> (H) and three top-ranked subsamples of LDW-PSID-1, including <code>optimal_pair_stuermer</code> (I), <code>k3_walker</code> (K) and <code>mahvars_stuermer</code> (L) the estimated treatment effect are reasonably sensitive to unmeasured confounding. In contrast, the LDW-PSID-1 sample (C) itself and its top-ranked subsamples <code>cs_stuermer</code> (J) and <code>genetic_stuermer</code> (M) produce treatment effects estimates that are even more sensitive to unmeasured confounding.</p>
<p>Similar to model A, these results overall highlights sample-specific differences in robustness against potential unobserved confounding.</p>
</div>
<div id="inspection-of-re74-and-re75-1" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Inspection of re74 and re75<a href="lalonde-dehejia-wahba-ldw-data-1.html#inspection-of-re74-and-re75-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="correlation-1" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> Correlation<a href="lalonde-dehejia-wahba-ldw-data-1.html#correlation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-1" tabindex="-1"></a><span class="co"># compute correlations</span></span>
<span id="cb272-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-2" tabindex="-1"></a>cor_treat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_datasets, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>treat, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb272-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-3" tabindex="-1"></a>cor_outcome <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_datasets, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>re78, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb272-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-4" tabindex="-1"></a>cor_cov <span class="ot">&lt;-</span>  <span class="fu">sapply</span>(all_datasets, <span class="cf">function</span>(d) <span class="fu">cor</span>(d<span class="sc">$</span>re74, d<span class="sc">$</span>re75, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb272-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-5" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Method =</span> all_plot_titles, <span class="at">Cor_re74_treat =</span> cor_treat, <span class="at">Cor_re74_out =</span> cor_outcome, <span class="at">Cor_re74_re75 =</span> cor_cov)</span>
<span id="cb272-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-6" tabindex="-1"></a></span>
<span id="cb272-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-7" tabindex="-1"></a><span class="co"># print table output</span></span>
<span id="cb272-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-8" tabindex="-1"></a><span class="fu">datatable</span>(cor_table, <span class="at">caption =</span> <span class="st">&quot;Correlations of re74 with treatment and outcome across samples&quot;</span>,</span>
<span id="cb272-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-9" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>, <span class="at">pageLength =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">searching =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d6bbfd0b7f9928c04137" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d6bbfd0b7f9928c04137">{"x":{"filter":"none","vertical":false,"caption":"<caption>Correlations of re74 with treatment and outcome across samples<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["(A) LDW-Experimental","(B) LDW-CPS-1","(C) LDW-PSID-1","(D) Top CPS-1: nn_crump","(E) Top CPS-1: caliper_crump","(F) Top CPS-1: genetic_crump","(G) Top CPS-1: genetic_common_range","(H) Top CPS-1: genetic_ps_threshold","(I) Top PSID-1: optimal_pair_stuermer","(J) Top PSID-1: cs_stuermer","(K) Top PSID-1: k3_walker","(L) Top PSID-1: mahvars_stuermer","(M) Top PSID-1: genetic_stuermer","(N) Trimmed LDW-CPS-1-PLUS","(O) Trimmed LDW-PSID-1-PLUS"],[-0.001053570876315096,-0.1318589171128933,-0.3205498776935601,-0.01255595995915493,-0.01255595995915493,-0.0486898925898942,-0.03927222510476483,-0.0391035448263666,-0.002552587789195141,-0.03272082391465556,-0.02130065869594313,-0.04058058736487959,0.003151807767848992,-0.006795889901496777,-0.08856539121720285],[0.08538444807049547,0.6403298797173105,0.7037833918980824,-0.02560752328860651,-0.02560752328860651,-0.02181184092818415,0.203464998867521,0.2005000207407981,0.3997225174920833,0.4106846057925058,0.4327222267026417,0.4303369001247977,0.4341039274400953,0.06827093779599486,0.1103138278032386],[0.6552006463328206,0.8719266231341293,0.8558591757325856,0.4991467410480871,0.4991467410480871,0.5077500369608581,0.6852153348391329,0.683272413443187,0.4588161060471121,0.4199840320965743,0.5459875340748146,0.4496693794453686,0.549292660957527,0.6460144798540387,0.5451711804205687]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Method<\/th>\n      <th>Cor_re74_treat<\/th>\n      <th>Cor_re74_out<\/th>\n      <th>Cor_re74_re75<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"pageLength":-1,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Method","targets":1},{"name":"Cor_re74_treat","targets":2},{"name":"Cor_re74_out","targets":3},{"name":"Cor_re74_re75","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[-1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>The tabulated results demonstrate correlations patterns consistent with model A.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb273-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb273-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb273-2" tabindex="-1"></a><span class="fu">save_csv</span>(cor_table, <span class="st">&quot;ldw_model_b_corr_results&quot;</span>)</span></code></pre></div>
</div>
<div id="distributional-balance-1" class="section level3 hasAnchor" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Distributional balance<a href="lalonde-dehejia-wahba-ldw-data-1.html#distributional-balance-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-1" tabindex="-1"></a><span class="co"># re75</span></span>
<span id="cb274-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(top5_datasets.cps)) {</span>
<span id="cb274-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-3" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb274-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-4" tabindex="-1"></a>    plot_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) CPS-1: &quot;</span>, top5_methods.cps[i], <span class="st">&quot; - re75&quot;</span>)</span>
<span id="cb274-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-5" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bal.plot</span>(treat <span class="sc">~</span> re75, <span class="at">data =</span> top5_datasets.cps[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span> </span>
<span id="cb274-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-6" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(plot_title))</span>
<span id="cb274-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-7" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb274-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, top5_methods.cps[i], e<span class="sc">$</span>message))</span>
<span id="cb274-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-9" tabindex="-1"></a>  })</span>
<span id="cb274-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-1.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.31: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-2.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.32: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-3.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.33: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-4.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.34: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-5.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.35: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(top5_datasets.psid)) {</span>
<span id="cb275-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-2" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb275-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-3" tabindex="-1"></a>    plot_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) PSID-1: &quot;</span>, top5_methods.psid[i], <span class="st">&quot; - re75&quot;</span>)</span>
<span id="cb275-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bal.plot</span>(treat <span class="sc">~</span> re75, <span class="at">data =</span> top5_datasets.psid[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span> </span>
<span id="cb275-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-5" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(plot_title))</span>
<span id="cb275-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-6" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb275-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-7" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, top5_methods.psid[i], e<span class="sc">$</span>message))</span>
<span id="cb275-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-8" tabindex="-1"></a>  })</span>
<span id="cb275-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-6.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.36: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-7.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.37: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-8.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.38: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-9.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.39: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-222-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-222-10.png" alt="FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75" width="100%" />
<p class="caption">
Figure 3.40: FIGUREB8. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re75
</p>
</div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-1" tabindex="-1"></a><span class="co"># re74</span></span>
<span id="cb276-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(top5_datasets.cps)) {</span>
<span id="cb276-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-3" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb276-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-4" tabindex="-1"></a>    plot_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">3</span>], <span class="st">&quot;) CPS-1: &quot;</span>, top5_methods.cps[i], <span class="st">&quot; - re74&quot;</span>)</span>
<span id="cb276-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-5" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bal.plot</span>(treat <span class="sc">~</span> re74, <span class="at">data =</span> top5_datasets.cps[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span> </span>
<span id="cb276-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-6" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(plot_title))</span>
<span id="cb276-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-7" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb276-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, top5_methods.cps[i], e<span class="sc">$</span>message))</span>
<span id="cb276-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-9" tabindex="-1"></a>  })</span>
<span id="cb276-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-1.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.41: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-2.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.42: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-3.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.43: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-4.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.44: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-5.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.45: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(top5_datasets.psid)) {</span>
<span id="cb277-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-2" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb277-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-3" tabindex="-1"></a>    plot_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, LETTERS[i<span class="sc">+</span><span class="dv">8</span>], <span class="st">&quot;) PSID-1: &quot;</span>, top5_methods.psid[i], <span class="st">&quot; - re74&quot;</span>)</span>
<span id="cb277-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bal.plot</span>(treat <span class="sc">~</span> re74, <span class="at">data =</span> top5_datasets.psid[[i]], <span class="at">which =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span> </span>
<span id="cb277-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-5" tabindex="-1"></a>            ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(plot_title))</span>
<span id="cb277-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-6" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb277-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-7" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Could not plot %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, top5_methods.psid[i], e<span class="sc">$</span>message))</span>
<span id="cb277-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-8" tabindex="-1"></a>  })</span>
<span id="cb277-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-6.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.46: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-7.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.47: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-8.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.48: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-9.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.49: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-223-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-223-10.png" alt="FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74" width="100%" />
<p class="caption">
Figure 3.50: FIGUREB9. SubfigureA:LDW-Experimental. SubfigureB:LDW-CPS-1. SubfigureD-H:Top-LDW-CPS-1. SubfigureC:LDW-PSID-1. SubfigureI-M:Top-LDW-PSID-1. SubfigureN:LDW-CPS-1-PLUS. SubfigureO:LDW-PSID-1-PLUS. Balance Model B of re74
</p>
</div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb278-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-2" tabindex="-1"></a><span class="fu">save_balance</span>(top5_datasets.cps, top5_methods.cps, <span class="at">balance_var =</span> <span class="st">&quot;re75&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_balance_panels_cps&quot;</span>)</span>
<span id="cb278-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-3" tabindex="-1"></a><span class="fu">save_balance</span>(top5_datasets.cps, top5_methods.cps, <span class="at">balance_var =</span> <span class="st">&quot;re74&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_balance_panels_cps&quot;</span>)</span>
<span id="cb278-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-4" tabindex="-1"></a><span class="fu">save_balance</span>(top5_datasets.psid, top5_methods.psid, <span class="at">balance_var =</span> <span class="st">&quot;re75&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_balance_panels_psid&quot;</span>)</span>
<span id="cb278-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-5" tabindex="-1"></a><span class="fu">save_balance</span>(top5_datasets.psid, top5_methods.psid, <span class="at">balance_var =</span> <span class="st">&quot;re74&quot;</span>, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_balance_panels_psid&quot;</span>)</span></code></pre></div>
<p>The density plots show that treated and control units do not substantially differ in <code>re74</code> across all samples, Although model B did not control for <code>re74</code>, this result suggests that the confounding bias from its omission is likely negligible
and that exclusion of it in the set of covariates may be justified.</p>
</div>
</div>
<div id="summary-1" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Summary<a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After reexamining model B, which uses the LaLonde-Dehejia-Wahba (LDW) data with a reduced set of covariates, we find that changing the covariate set leads to noticeable shifts in effect estimates. For LDW-CPS-1, estimates are generally more consistent and remain closer to the experimental benchmark, though standard errors are considerably large. In contrast, LDW-PSID-1 continues to show greater dispersion and substantially larger standard errors, highlighting persistent challenges with this observational sample.</p>
<p>Conditional and quantile treatment effect estimates confirm that, while some methods bring estimates closer to the experimental benchmark, considerable heterogeneity and estimator-dependent variability remain. Placebo tests using lagged earnings as the outcome reveal that, despite some improvements, bias and deviation from the true effect persist. Sensitivity analyses indicate that most treatment effect estimates are fairly sensitive to increasing confounder strength, but some upward shifts are observed compared to model A.</p>
<p>Further, the balance results suggest that excluding re74 from the covariate set incurs negligible confounding risk, thereby validating model B’s specification.</p>
<p>Overall, these results reinforce the importance of overlap, covariate balance, and careful method selection, while underscoring the ongoing difficulty of recovering unbiased causal effects from observational data.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-imbens2024" class="csl-entry">
Imbens, Guido W., and Yiqing Xu. 2024. <span>“LaLonde (1986) After Nearly Four Decades: Lessons Learned.”</span>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lalonde-dehejia-wahba-ldw-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lalonde-nsw-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study/edit/main/tutorial/03-LDW-Model-B.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Outcome-Weights.pdf", "Outcome-Weights.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
