<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</title>
  <meta name="description" content="<p>This book replicates the LaLonde study as revisited by Imbens &amp; Xu (2024), comparing full
and reduced covariate models to reduce potential confounding.
It evaluates various methods to improve overlap and covariate balance for more robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to LaLonde data variants as well as analyzes the distributional properties of outcome weights.</p>" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book replicates the LaLonde study as revisited by Imbens &amp; Xu (2024), comparing full
and reduced covariate models to reduce potential confounding.
It evaluates various methods to improve overlap and covariate balance for more robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to LaLonde data variants as well as analyzes the distributional properties of outcome weights.</p>" />
  <meta name="github-repo" content="lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 LaLonde-Dehejia-Wahba (LDW) Data | Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study" />
  
  <meta name="twitter:description" content="<p>This book replicates the LaLonde study as revisited by Imbens &amp; Xu (2024), comparing full
and reduced covariate models to reduce potential confounding.
It evaluates various methods to improve overlap and covariate balance for more robust
treatment effect estimation and applies the outcome weights framework by Knaus &amp; Pfleiderer (2024)
to LaLonde data variants as well as analyzes the distributional properties of outcome weights.</p>" />
  

<meta name="author" content="Laura Kreisel" />


<meta name="date" content="2025-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lalonde-dehejia-wahba-ldw-data.html"/>
<link rel="next" href="lalonde-nsw-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tutorial/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Application of Outcome Weights Framework for DML to Lalonde Study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#wrapper-functions"><i class="fa fa-check"></i><b>1.2</b> Wrapper functions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started.html"><a href="getting-started.html#overview"><i class="fa fa-check"></i><b>1.2.1</b> Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started.html"><a href="getting-started.html#inspection"><i class="fa fa-check"></i><b>1.2.2</b> Inspection</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started.html"><a href="getting-started.html#improving-covariate-balance-and-overlap"><i class="fa fa-check"></i><b>1.2.3</b> Improving covariate balance and overlap</a></li>
<li class="chapter" data-level="1.2.4" data-path="getting-started.html"><a href="getting-started.html#reassessing-methods"><i class="fa fa-check"></i><b>1.2.4</b> Reassessing methods</a></li>
<li class="chapter" data-level="1.2.5" data-path="getting-started.html"><a href="getting-started.html#estimating"><i class="fa fa-check"></i><b>1.2.5</b> Estimating</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#outcome-weights-analysis"><i class="fa fa-check"></i><b>1.3</b> Outcome weights analysis</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#sensitivity-analysis"><i class="fa fa-check"></i><b>1.4</b> Sensitivity analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html"><i class="fa fa-check"></i><b>2</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#set-up"><i class="fa fa-check"></i><b>2.1</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#source-functions-and-load-data"><i class="fa fa-check"></i><b>2.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="2.1.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#inspect-data"><i class="fa fa-check"></i><b>2.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="2.1.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#load-and-preprocess-data"><i class="fa fa-check"></i><b>2.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#model-a"><i class="fa fa-check"></i><b>2.2</b> Model A</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-overlap-and-covariate-balance"><i class="fa fa-check"></i><b>2.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-covariate-balance"><i class="fa fa-check"></i><b>2.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#matching-2"><i class="fa fa-check"></i><b>2.3.1</b> Matching</a></li>
<li class="chapter" data-level="2.3.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#weighting-2"><i class="fa fa-check"></i><b>2.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#improving-primarily-overlap"><i class="fa fa-check"></i><b>2.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#truncation-2"><i class="fa fa-check"></i><b>2.4.1</b> Truncation</a></li>
<li class="chapter" data-level="2.4.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#trimming-2"><i class="fa fa-check"></i><b>2.4.2</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods"><i class="fa fa-check"></i><b>2.5</b> Integrated methods</a></li>
<li class="chapter" data-level="2.6" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#reassessing-methods-1"><i class="fa fa-check"></i><b>2.6</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#matching-3"><i class="fa fa-check"></i><b>2.6.1</b> Matching</a></li>
<li class="chapter" data-level="2.6.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#weighting-3"><i class="fa fa-check"></i><b>2.6.2</b> Weighting</a></li>
<li class="chapter" data-level="2.6.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#truncation-3"><i class="fa fa-check"></i><b>2.6.3</b> Truncation</a></li>
<li class="chapter" data-level="2.6.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#trimming-3"><i class="fa fa-check"></i><b>2.6.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#integrated-methods-1"><i class="fa fa-check"></i><b>2.7</b> Integrated methods</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#top-methods-and-datasets"><i class="fa fa-check"></i><b>2.7.1</b> Top methods and datasets</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#estimating-1"><i class="fa fa-check"></i><b>2.8</b> Estimating</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#average-treatment-effect-on-the-treated-att"><i class="fa fa-check"></i><b>2.8.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="2.8.2" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#conditional-average-treatment-effect-on-the-treated-catt-1"><i class="fa fa-check"></i><b>2.8.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="2.8.3" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#quantile-treatment-effect-on-the-treated-qtet"><i class="fa fa-check"></i><b>2.8.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="2.8.4" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#assessing-outcome-weights-ow"><i class="fa fa-check"></i><b>2.8.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-placebo-analyses"><i class="fa fa-check"></i><b>2.9</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="2.10" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#validation-through-sensitivity-analyses"><i class="fa fa-check"></i><b>2.10</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="2.11" data-path="lalonde-dehejia-wahba-ldw-data.html"><a href="lalonde-dehejia-wahba-ldw-data.html#summary"><i class="fa fa-check"></i><b>2.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html"><i class="fa fa-check"></i><b>3</b> LaLonde-Dehejia-Wahba (LDW) Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1"><i class="fa fa-check"></i><b>3.1</b> Set up</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1"><i class="fa fa-check"></i><b>3.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="3.1.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1"><i class="fa fa-check"></i><b>3.1.2</b> Inspect data</a></li>
<li class="chapter" data-level="3.1.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Load and preprocess data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#model-b"><i class="fa fa-check"></i><b>3.2</b> Model B</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-overlap-and-covariate-balance-1"><i class="fa fa-check"></i><b>3.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-covariate-balance-1"><i class="fa fa-check"></i><b>3.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-4"><i class="fa fa-check"></i><b>3.3.1</b> Matching</a></li>
<li class="chapter" data-level="3.3.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-4"><i class="fa fa-check"></i><b>3.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-overlap-1"><i class="fa fa-check"></i><b>3.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-4"><i class="fa fa-check"></i><b>3.4.1</b> Truncation</a></li>
<li class="chapter" data-level="3.4.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-4"><i class="fa fa-check"></i><b>3.4.2</b> Trimming</a></li>
<li class="chapter" data-level="3.4.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-2"><i class="fa fa-check"></i><b>3.4.3</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#reassessing-methods-2"><i class="fa fa-check"></i><b>3.5</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-5"><i class="fa fa-check"></i><b>3.5.1</b> Matching</a></li>
<li class="chapter" data-level="3.5.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-5"><i class="fa fa-check"></i><b>3.5.2</b> Weighting</a></li>
<li class="chapter" data-level="3.5.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-5"><i class="fa fa-check"></i><b>3.5.3</b> Truncation</a></li>
<li class="chapter" data-level="3.5.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-5"><i class="fa fa-check"></i><b>3.5.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-3"><i class="fa fa-check"></i><b>3.6</b> Integrated methods</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#top-methods-and-datasets-1"><i class="fa fa-check"></i><b>3.6.1</b> Top methods and datasets</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2"><i class="fa fa-check"></i><b>3.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1"><i class="fa fa-check"></i><b>3.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="3.7.2" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2"><i class="fa fa-check"></i><b>3.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="3.7.3" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1"><i class="fa fa-check"></i><b>3.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="3.7.4" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1"><i class="fa fa-check"></i><b>3.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1"><i class="fa fa-check"></i><b>3.8</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="3.9" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1"><i class="fa fa-check"></i><b>3.9</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="3.10" data-path="lalonde-dehejia-wahba-ldw-data-1.html"><a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1"><i class="fa fa-check"></i><b>3.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html"><i class="fa fa-check"></i><b>4</b> LaLonde (NSW) Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#set-up-2"><i class="fa fa-check"></i><b>4.1</b> Set up</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#source-functions-and-load-data-2"><i class="fa fa-check"></i><b>4.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="4.1.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#load-and-preprocess-data-2"><i class="fa fa-check"></i><b>4.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="4.1.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#inspect-data-2"><i class="fa fa-check"></i><b>4.1.3</b> Inspect data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#nsw"><i class="fa fa-check"></i><b>4.2</b> NSW</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-overlap-and-covariate-balance-2"><i class="fa fa-check"></i><b>4.2.1</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-primarily-covariate-balance-2"><i class="fa fa-check"></i><b>4.3</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#matching-6"><i class="fa fa-check"></i><b>4.3.1</b> Matching</a></li>
<li class="chapter" data-level="4.3.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#weighting-6"><i class="fa fa-check"></i><b>4.3.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#improving-primarily-overlap-2"><i class="fa fa-check"></i><b>4.4</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#truncation-6"><i class="fa fa-check"></i><b>4.4.1</b> Truncation</a></li>
<li class="chapter" data-level="4.4.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#trimming-6"><i class="fa fa-check"></i><b>4.4.2</b> Trimming</a></li>
<li class="chapter" data-level="4.4.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-4"><i class="fa fa-check"></i><b>4.4.3</b> Integrated methods</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#reassessing-methods-3"><i class="fa fa-check"></i><b>4.5</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#matching-7"><i class="fa fa-check"></i><b>4.5.1</b> Matching</a></li>
<li class="chapter" data-level="4.5.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#weighting-7"><i class="fa fa-check"></i><b>4.5.2</b> Weighting</a></li>
<li class="chapter" data-level="4.5.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#truncation-7"><i class="fa fa-check"></i><b>4.5.3</b> Truncation</a></li>
<li class="chapter" data-level="4.5.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#trimming-7"><i class="fa fa-check"></i><b>4.5.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#integrated-methods-5"><i class="fa fa-check"></i><b>4.6</b> Integrated methods</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#top-methods-and-datasets-2"><i class="fa fa-check"></i><b>4.6.1</b> Top methods and datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#estimating-3"><i class="fa fa-check"></i><b>4.7</b> Estimating</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#average-treatment-effect-on-the-treated-att-2"><i class="fa fa-check"></i><b>4.7.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="4.7.2" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#conditional-average-treatment-effect-on-the-treated-catt-3"><i class="fa fa-check"></i><b>4.7.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="4.7.3" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#quantile-treatment-effect-on-the-treated-qtet-2"><i class="fa fa-check"></i><b>4.7.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="4.7.4" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#assessing-outcome-weights-ow-2"><i class="fa fa-check"></i><b>4.7.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#validation-through-sensitivity-analyses-2"><i class="fa fa-check"></i><b>4.8</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="4.9" data-path="lalonde-nsw-data.html"><a href="lalonde-nsw-data.html#summary-2"><i class="fa fa-check"></i><b>4.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html"><i class="fa fa-check"></i><b>5</b> LaLonde-Calónico-Smith (LCS) Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#set-up-3"><i class="fa fa-check"></i><b>5.1</b> Set up</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#source-functions-and-load-data-3"><i class="fa fa-check"></i><b>5.1.1</b> Source functions and load data</a></li>
<li class="chapter" data-level="5.1.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#load-and-preprocess-data-3"><i class="fa fa-check"></i><b>5.1.2</b> Load and preprocess data</a></li>
<li class="chapter" data-level="5.1.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#inspect-data-3"><i class="fa fa-check"></i><b>5.1.3</b> Inspect data</a></li>
<li class="chapter" data-level="5.1.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-overlap-and-covariate-balance-3"><i class="fa fa-check"></i><b>5.1.4</b> Assessing overlap and covariate balance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-primarily-covariate-balance-3"><i class="fa fa-check"></i><b>5.2</b> Improving primarily covariate balance</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#matching-8"><i class="fa fa-check"></i><b>5.2.1</b> Matching</a></li>
<li class="chapter" data-level="5.2.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#weighting-8"><i class="fa fa-check"></i><b>5.2.2</b> Weighting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#improving-primarily-overlap-3"><i class="fa fa-check"></i><b>5.3</b> Improving primarily overlap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#truncation-8"><i class="fa fa-check"></i><b>5.3.1</b> Truncation</a></li>
<li class="chapter" data-level="5.3.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#trimming-8"><i class="fa fa-check"></i><b>5.3.2</b> Trimming</a></li>
<li class="chapter" data-level="5.3.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#combination-of-methods"><i class="fa fa-check"></i><b>5.3.3</b> Combination of methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#reassessing-methods-4"><i class="fa fa-check"></i><b>5.4</b> Reassessing methods</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#matching-9"><i class="fa fa-check"></i><b>5.4.1</b> Matching</a></li>
<li class="chapter" data-level="5.4.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#weighting-9"><i class="fa fa-check"></i><b>5.4.2</b> Weighting</a></li>
<li class="chapter" data-level="5.4.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#truncation-9"><i class="fa fa-check"></i><b>5.4.3</b> Truncation</a></li>
<li class="chapter" data-level="5.4.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#trimming-9"><i class="fa fa-check"></i><b>5.4.4</b> Trimming</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#integrated-methods-6"><i class="fa fa-check"></i><b>5.5</b> Integrated methods</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#top-methods-and-datasets-3"><i class="fa fa-check"></i><b>5.5.1</b> Top methods and datasets</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#estimating-4"><i class="fa fa-check"></i><b>5.6</b> Estimating</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#average-treatment-effect-on-the-treated-att-3"><i class="fa fa-check"></i><b>5.6.1</b> Average treatment effect on the treated (ATT)</a></li>
<li class="chapter" data-level="5.6.2" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#conditional-average-treatment-effect-on-the-treated-catt-4"><i class="fa fa-check"></i><b>5.6.2</b> Conditional average treatment effect on the treated (CATT)</a></li>
<li class="chapter" data-level="5.6.3" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#quantile-treatment-effect-on-the-treated-qtet-3"><i class="fa fa-check"></i><b>5.6.3</b> Quantile treatment effect on the treated (QTET)</a></li>
<li class="chapter" data-level="5.6.4" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#assessing-outcome-weights-ow-3"><i class="fa fa-check"></i><b>5.6.4</b> Assessing outcome weights (OW)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-placebo-analyses-2"><i class="fa fa-check"></i><b>5.7</b> Validation through placebo analyses</a></li>
<li class="chapter" data-level="5.8" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#validation-through-sensitivity-analyses-3"><i class="fa fa-check"></i><b>5.8</b> Validation through sensitivity analyses</a></li>
<li class="chapter" data-level="5.9" data-path="lalonde-calónico-smith-lcs-data.html"><a href="lalonde-calónico-smith-lcs-data.html#summary-3"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Application of the Outcome Weights Framework for Double Machine Learning to the Lalonde Study</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lalonde-dehejia-wahba-ldw-data-1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> LaLonde-Dehejia-Wahba (LDW) Data<a href="lalonde-dehejia-wahba-ldw-data-1.html#lalonde-dehejia-wahba-ldw-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section (3) covers model B, which, similar to model A, uses 1978 earnings (<code>re78</code>) as the outcome variable but adjusts for a slightly different set of covariates: age, education, race indicators (black, hispanic), marital status, lack of a high school degree, 1975 earnings (<code>re75</code>), and unemployment status in 1974 and 1975 (<code>u74</code>, <code>u75</code>), explicitly excluding 1974 earnings (<code>re74</code>) to test the model’s robustness. The model is specified via a logistic regression formula based on these covariates. To enhance covariate balance between treated and untreated groups, the same comprehensive suite of methods is employed as in model A, organized into five categories. From these approaches, the top 5 ranked methods are selected based on absolute standardized mean differences (SMDs) and effective sample size (ESS), and their resulting datasets are used to estimate the average treatment effect on the treated (ATT). This estimation process also incorporates the augmented inverse probability weighting (AIPW) estimator from the <code>OutcomeWeights</code> R package. Subsequently, alternative estimands are considered, including the conditional average treatment effect for the treated (CATT) and the quantile treatment effect on the treated (QTET). After estimating these effects, outcome weights are analyzed to identify patterns in the contribution of individual observations to the ATT. Placebo tests are then conducted using 1975 earnings (<code>re75</code>) as the outcome variable to assess potential biases and the validity of the unconfoundedness assumption. Finally, sensitivity analyses are performed to evaluate the robustness of the treatment effect estimates to violations of these assumptions.</p>
<p>For detailed explanations of the analysis steps and tips, please refer to section 2. Here, we only explain the model B–specific results.</p>
<div id="set-up-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Set up<a href="lalonde-dehejia-wahba-ldw-data-1.html#set-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="source-functions-and-load-data-1" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Source functions and load data<a href="lalonde-dehejia-wahba-ldw-data-1.html#source-functions-and-load-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-1" tabindex="-1"></a><span class="co"># source functions</span></span>
<span id="cb256-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://github.com/xuyiqing/lalonde/blob/main/tutorial/functions.R?raw=TRUE&quot;</span>)</span>
<span id="cb256-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb256-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;tutorial/functions.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-1" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb257-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb257-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/lalonde.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-1" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb258-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb258-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="inspect-data-1" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Inspect data<a href="lalonde-dehejia-wahba-ldw-data-1.html#inspect-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-1" tabindex="-1"></a><span class="co"># collect datasets in a list</span></span>
<span id="cb259-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">lalonde =</span> lalonde, <span class="at">ldw_tr =</span> ldw_tr, <span class="at">ldw_co =</span> ldw_co, <span class="at">ldw_cps =</span> ldw_cps, <span class="at">ldw_psid =</span> ldw_psid)</span>
<span id="cb259-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-3" tabindex="-1"></a></span>
<span id="cb259-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-4" tabindex="-1"></a><span class="co"># inspect key metrics of each dataset</span></span>
<span id="cb259-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-5" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(data)</span>
<span id="cb259-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb259-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-180">Table 3.1: </span>Summary Statistics</caption>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dataset</th>
<th align="right">num_obs</th>
<th align="right">num_vars</th>
<th align="left">name_vars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lalonde</td>
<td align="right">2675</td>
<td align="right">13</td>
<td align="left">nsw, age, educ, black, hisp, married, re74, re75, re78, u74, u75, u78, nodegr</td>
</tr>
<tr class="even">
<td align="left">ldw_tr</td>
<td align="right">185</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="odd">
<td align="left">ldw_co</td>
<td align="right">260</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="even">
<td align="left">ldw_cps</td>
<td align="right">16177</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="odd">
<td align="left">ldw_psid</td>
<td align="right">2675</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
</tbody>
</table>
</div>
<div id="load-and-preprocess-data-1" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Load and preprocess data<a href="lalonde-dehejia-wahba-ldw-data-1.html#load-and-preprocess-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-1" tabindex="-1"></a><span class="co"># assigns 1 to the experimental controls</span></span>
<span id="cb260-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-2" tabindex="-1"></a>ldw_co<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb260-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-3" tabindex="-1"></a></span>
<span id="cb260-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-4" tabindex="-1"></a><span class="co"># merge experimental data with CPS1 data</span></span>
<span id="cb260-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-5" tabindex="-1"></a>ldw_cps_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb260-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-6" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb260-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-7" tabindex="-1"></a>  ldw_cps    <span class="co"># CPS1 data (16177 observations)</span></span>
<span id="cb260-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-8" tabindex="-1"></a>)</span>
<span id="cb260-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-9" tabindex="-1"></a></span>
<span id="cb260-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-10" tabindex="-1"></a><span class="co"># merge experimental data with PSID1 data</span></span>
<span id="cb260-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-11" tabindex="-1"></a>ldw_psid_plus <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb260-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-12" tabindex="-1"></a>  ldw_co,    <span class="co"># experimental controls (260 observations)</span></span>
<span id="cb260-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-13" tabindex="-1"></a>  ldw_psid   <span class="co"># PSID1 data (2675 observations)</span></span>
<span id="cb260-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-14" tabindex="-1"></a>)</span>
<span id="cb260-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-15" tabindex="-1"></a></span>
<span id="cb260-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-16" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ldw_cps_plus  =</span> ldw_cps_plus, <span class="at">ldw_psid_plus =</span> ldw_psid_plus)</span>
<span id="cb260-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-17" tabindex="-1"></a></span>
<span id="cb260-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-18" tabindex="-1"></a><span class="co"># inspect each dataset</span></span>
<span id="cb260-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-19" tabindex="-1"></a>summary_stats_plus <span class="ot">&lt;-</span> <span class="fu">inspect_data</span>(datasets)</span>
<span id="cb260-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb260-20" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats_plus, <span class="at">caption =</span> <span class="st">&quot;Summary Statistics&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-181">Table 3.2: </span>Summary Statistics</caption>
<colgroup>
<col width="10%" />
<col width="5%" />
<col width="6%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dataset</th>
<th align="right">num_obs</th>
<th align="right">num_vars</th>
<th align="left">name_vars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ldw_cps_plus</td>
<td align="right">16437</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
<tr class="even">
<td align="left">ldw_psid_plus</td>
<td align="right">2935</td>
<td align="right">14</td>
<td align="left">data_id, treat, age, education, black, hispanic, married, nodegree, re74, re75, re78, u74, u75, sample</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="model-b" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Model B<a href="lalonde-dehejia-wahba-ldw-data-1.html#model-b" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb261-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span> </span>
<span id="cb261-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span> </span>
<span id="cb261-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, </span>
<span id="cb261-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb261-5" tabindex="-1"></a>           <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>) <span class="co">#re74 excluded</span></span></code></pre></div>
<div id="assessing-overlap-and-covariate-balance-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Assessing overlap and covariate balance<a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-overlap-and-covariate-balance-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="overlap-1" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Overlap<a href="lalonde-dehejia-wahba-ldw-data-1.html#overlap-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-1" tabindex="-1"></a><span class="co"># assess overlap</span></span>
<span id="cb262-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb262-2" tabindex="-1"></a>ldw.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -1.26191 0.7410732</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-183-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-183-1.png" alt="FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 3.1: FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb264-1" tabindex="-1"></a>ldw_cps.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 1.813362</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-183-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-183-2.png" alt="FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 3.2: FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb266-1" tabindex="-1"></a>ldw_psid.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -11.47475 3.722802</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-183-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-183-3.png" alt="FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1." width="100%" />
<p class="caption">
Figure 3.3: FIGURE B1. SubfigureA:LDW. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.
</p>
</div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb268-1" tabindex="-1"></a><span class="co"># assess overlap</span></span>
<span id="cb268-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb268-2" tabindex="-1"></a>ldw_cps_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_cps_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar) </span></code></pre></div>
<pre><code>## -16.1181 3.425533</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-184-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-184-1.png" alt="FIGURE B1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.4: FIGURE B1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb270-1" tabindex="-1"></a>ldw_psid_plus.ps <span class="ot">&lt;-</span> <span class="fu">assess_overlap</span>(<span class="at">data =</span> ldw_psid_plus, <span class="at">treat =</span> treat, <span class="at">cov =</span> covar)</span></code></pre></div>
<pre><code>## -11.65343 7.149751</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-184-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-184-2.png" alt="FIGURE B1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.5: FIGURE B1. SubfigureD:LDW-CPS1-PLUS. SubfigureE:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-1" tabindex="-1"></a><span class="co"># set model formula</span></span>
<span id="cb272-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb272-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(treat, <span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(covar, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)))</span></code></pre></div>
</div>
<div id="covariate-balance-1" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Covariate balance<a href="lalonde-dehejia-wahba-ldw-data-1.html#covariate-balance-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb273-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_cps, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-186-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-186-1.png" alt="FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.6: FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb274-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_cps_plus, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-186-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-186-2.png" alt="FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.7: FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb275-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_psid, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-186-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-186-3.png" alt="FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.8: FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb276-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw, ldw_psid_plus, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-186-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-186-4.png" alt="FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS." width="80%" />
<p class="caption">
Figure 3.9: FIGURE B2. SubfigureA:LDW-CPS1. SubfigureB:LDW-CPS1-PLUS. SubfigureC:LDW-PSID1. SubfigureD:LDW-PSID1-PLUS.
</p>
</div>
</div>
</div>
</div>
<div id="improving-primarily-covariate-balance-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Improving primarily covariate balance<a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-covariate-balance-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="matching-4" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="distance-matching-1" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Distance Matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#distance-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="nearest-neighbor-matching-1" class="section level5 hasAnchor" number="3.3.1.1.1">
<h5><span class="header-section-number">3.3.1.1.1</span> 1:1 Nearest neighbor matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#nearest-neighbor-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=1, logistic propensity score and replacement</span></span>
<span id="cb277-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-2" tabindex="-1"></a>m.out.cps_plus.nearest <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb277-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb277-3" tabindex="-1"></a>m.out.psid_plus.nearest <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="k1-matching-k2-1" class="section level5 hasAnchor" number="3.3.1.1.2">
<h5><span class="header-section-number">3.3.1.1.2</span> k:1 matching (k=2)<a href="lalonde-dehejia-wahba-ldw-data-1.html#k1-matching-k2-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb278-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-2" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=2, logistic propensity score and replacement</span></span>
<span id="cb278-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-3" tabindex="-1"></a>m.out.cps_plus.k2 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb278-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb278-4" tabindex="-1"></a>m.out.psid_plus.k2 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="k1-matching-k3-1" class="section level5 hasAnchor" number="3.3.1.1.3">
<h5><span class="header-section-number">3.3.1.1.3</span> k:1 matching (k=3)<a href="lalonde-dehejia-wahba-ldw-data-1.html#k1-matching-k3-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb279-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb279-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb279-2" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with k=3, logistic propensity score and replacement</span></span>
<span id="cb279-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb279-3" tabindex="-1"></a>m.out.cps_plus.k3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb279-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb279-4" tabindex="-1"></a>m.out.psid_plus.k3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">ratio =</span> k, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="caliper-matching-1" class="section level5 hasAnchor" number="3.3.1.1.4">
<h5><span class="header-section-number">3.3.1.1.4</span> Caliper matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#caliper-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb280-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with a caliper of 0.1 on the logistic propensity score </span></span>
<span id="cb280-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb280-2" tabindex="-1"></a>m.out.cps_plus.caliper <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb280-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb280-3" tabindex="-1"></a>m.out.psid_plus.caliper <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="common-support-restriction-matching-1" class="section level5 hasAnchor" number="3.3.1.1.5">
<h5><span class="header-section-number">3.3.1.1.5</span> Common support restriction matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#common-support-restriction-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb281-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching with exclusion of units outside common support</span></span>
<span id="cb281-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb281-2" tabindex="-1"></a>m.out.cps_plus.cs <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb281-3" tabindex="-1"></a>m.out.psid_plus.cs <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">discard =</span> <span class="st">&quot;both&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="mahalanobis-distance-matching-mahvars-1" class="section level5 hasAnchor" number="3.3.1.1.6">
<h5><span class="header-section-number">3.3.1.1.6</span> Mahalanobis distance matching (mahvars)<a href="lalonde-dehejia-wahba-ldw-data-1.html#mahalanobis-distance-matching-mahvars-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb282-1" tabindex="-1"></a><span class="co"># perform nearest neighbor matching using mahalanobis distance on selected covariates</span></span>
<span id="cb282-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb282-2" tabindex="-1"></a>m.out.cps_plus.mahvars <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.2</span>, <span class="at">mahvars =</span> <span class="sc">~</span> age <span class="sc">+</span> education <span class="sc">+</span> re75, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb282-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb282-3" tabindex="-1"></a>m.out.psid_plus.mahvars <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">caliper =</span> <span class="fl">0.2</span>, <span class="at">mahvars =</span> <span class="sc">~</span> age <span class="sc">+</span> education <span class="sc">+</span> re75, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="optimal-pair-matching-1" class="section level5 hasAnchor" number="3.3.1.1.7">
<h5><span class="header-section-number">3.3.1.1.7</span> Optimal pair matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#optimal-pair-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb283-1" tabindex="-1"></a><span class="co"># perform optimal pair matching that minimizes total within-pair distance on propensity scores</span></span>
<span id="cb283-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb283-2" tabindex="-1"></a>m.out.cps_plus.optimal_pair <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb283-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb283-3" tabindex="-1"></a>m.out.psid_plus.optimal_pair <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;optimal&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="optimal-full-matching-1" class="section level5 hasAnchor" number="3.3.1.1.8">
<h5><span class="header-section-number">3.3.1.1.8</span> Optimal full matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#optimal-full-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb284-1" tabindex="-1"></a><span class="co"># perform optimal full matching allowing sets with varying ratios of treated to controls and minimizing a global distance criterion</span></span>
<span id="cb284-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb284-2" tabindex="-1"></a>m.out.cps_plus.optimal_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb284-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb284-3" tabindex="-1"></a>m.out.psid_plus.optimal_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;full&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="generalized-full-matching-1" class="section level5 hasAnchor" number="3.3.1.1.9">
<h5><span class="header-section-number">3.3.1.1.9</span> Generalized full matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#generalized-full-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb285-1" tabindex="-1"></a><span class="co"># perform generalized full matching using fast approximation and producing matched sets with flexible treated/control ratios </span></span>
<span id="cb285-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb285-2" tabindex="-1"></a>m.out.cps_plus.general_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb285-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb285-3" tabindex="-1"></a>m.out.psid_plus.general_full <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>)</span></code></pre></div>
</div>
<div id="genetic-matching-1" class="section level5 hasAnchor" number="3.3.1.1.10">
<h5><span class="header-section-number">3.3.1.1.10</span> Genetic matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#genetic-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb286-1" tabindex="-1"></a><span class="co"># perform genetic matching </span></span>
<span id="cb286-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb286-2" tabindex="-1"></a>m.out.cps_plus.genetic <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span>
<span id="cb286-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb286-3" tabindex="-1"></a>m.out.psid_plus.genetic <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;genetic&quot;</span>, <span class="at">distance =</span> <span class="st">&quot;logit&quot;</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">pop.size =</span> <span class="dv">100</span>)</span></code></pre></div>
</div>
</div>
<div id="stratum-matching-1" class="section level4 hasAnchor" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> Stratum matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#stratum-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="exact-matching-exact-1" class="section level5 hasAnchor" number="3.3.1.2.1">
<h5><span class="header-section-number">3.3.1.2.1</span> Exact matching (exact)<a href="lalonde-dehejia-wahba-ldw-data-1.html#exact-matching-exact-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb287-1" tabindex="-1"></a><span class="co"># match units exactly by raw covariate profiles </span></span>
<span id="cb287-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb287-2" tabindex="-1"></a>m.out.cps_plus.exact <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span>
<span id="cb287-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb287-3" tabindex="-1"></a>m.out.psid_plus.exact <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;exact&quot;</span>)</span></code></pre></div>
</div>
<div id="coarsened-matching-cem-1" class="section level5 hasAnchor" number="3.3.1.2.2">
<h5><span class="header-section-number">3.3.1.2.2</span> Coarsened matching (cem)<a href="lalonde-dehejia-wahba-ldw-data-1.html#coarsened-matching-cem-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb288-1" tabindex="-1"></a><span class="co"># match units exactly within coarse strata </span></span>
<span id="cb288-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb288-2" tabindex="-1"></a>m.out.cps_plus.cem <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span>
<span id="cb288-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb288-3" tabindex="-1"></a>m.out.psid_plus.cem <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;cem&quot;</span>)</span></code></pre></div>
</div>
<div id="subclassification-1" class="section level5 hasAnchor" number="3.3.1.2.3">
<h5><span class="header-section-number">3.3.1.2.3</span> Subclassification<a href="lalonde-dehejia-wahba-ldw-data-1.html#subclassification-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb289-1" tabindex="-1"></a><span class="co"># partition sample into fixed number of bins based on propensity score </span></span>
<span id="cb289-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb289-2" tabindex="-1"></a>m.out.cps_plus.subcl <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">5</span>)</span>
<span id="cb289-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb289-3" tabindex="-1"></a>m.out.psid_plus.subcl <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;subclass&quot;</span>, <span class="at">subclass =</span> <span class="dv">5</span>)</span></code></pre></div>
</div>
</div>
<div id="pure-subset-selection-1" class="section level4 hasAnchor" number="3.3.1.3">
<h4><span class="header-section-number">3.3.1.3</span> Pure subset selection<a href="lalonde-dehejia-wahba-ldw-data-1.html#pure-subset-selection-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="cardinality-profile-matching-1" class="section level5 hasAnchor" number="3.3.1.3.1">
<h5><span class="header-section-number">3.3.1.3.1</span> Cardinality profile matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#cardinality-profile-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb290-1" tabindex="-1"></a><span class="co"># select largest balanced subsample meeting covariate balance tolerances</span></span>
<span id="cb290-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb290-2" tabindex="-1"></a>m.out.cps_plus.card <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>)</span>
<span id="cb290-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb290-3" tabindex="-1"></a>m.out.psid_plus.card <span class="ot">&lt;-</span> <span class="fu">matchit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;cardinality&quot;</span>, <span class="at">tols =</span> <span class="fl">0.1</span>, <span class="at">ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="profile-matching-1" class="section level5 hasAnchor" number="3.3.1.3.2">
<h5><span class="header-section-number">3.3.1.3.2</span> Profile matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#profile-matching-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb291-1" tabindex="-1"></a><span class="co"># matching by directly optimizing balance profile measures across covariates</span></span>
<span id="cb291-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb291-2" tabindex="-1"></a>m.out.cps_plus.profile <span class="ot">&lt;-</span> <span class="fu">matchit_profile</span>(ldw_cps_plus, treat, covar)</span>
<span id="cb291-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb291-3" tabindex="-1"></a>m.out.psid_plus.profile <span class="ot">&lt;-</span> <span class="fu">matchit_profile</span>(ldw_psid_plus, treat, covar)</span></code></pre></div>
</div>
</div>
</div>
<div id="weighting-4" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Weighting<a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="inverse-probability-weights-ipw-1" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Inverse probability weights (IPW)<a href="lalonde-dehejia-wahba-ldw-data-1.html#inverse-probability-weights-ipw-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-1" tabindex="-1"></a><span class="co"># compute weights as inverse of estimated propensity scores </span></span>
<span id="cb292-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-2" tabindex="-1"></a>w.out.cps_plus.ipw <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb292-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-3" tabindex="-1"></a>w.out.psid_plus.ipw <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb292-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-4" tabindex="-1"></a></span>
<span id="cb292-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-5" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>ipw_weight <span class="ot">&lt;-</span> w.out.cps_plus.ipw<span class="sc">$</span>weights</span>
<span id="cb292-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb292-6" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>ipw_weight <span class="ot">&lt;-</span> w.out.psid_plus.ipw<span class="sc">$</span>weights</span></code></pre></div>
</div>
<div id="standardized-mortality-ratio-smr-treated-weights-1" class="section level4 hasAnchor" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> Standardized mortality ratio (SMR) treated weights<a href="lalonde-dehejia-wahba-ldw-data-1.html#standardized-mortality-ratio-smr-treated-weights-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb293-1" tabindex="-1"></a><span class="co"># calculate weights for ATT by assigning weight = 1 to treated units and weights proportional to odds of treatment for control</span></span>
<span id="cb293-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb293-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>smr_weight <span class="ot">&lt;-</span> <span class="fu">create_smr_weights</span>(ldw_cps_plus, model, <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb293-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb293-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>smr_weight <span class="ot">&lt;-</span> <span class="fu">create_smr_weights</span>(ldw_psid_plus, model, <span class="st">&quot;ATT&quot;</span>)</span></code></pre></div>
</div>
<div id="matching-weights-1" class="section level4 hasAnchor" number="3.3.2.3">
<h4><span class="header-section-number">3.3.2.3</span> Matching weights<a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-weights-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-1" tabindex="-1"></a><span class="co"># derive optimal matching weights intending to minimize covariate imbalance while targeting ATT</span></span>
<span id="cb294-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-2" tabindex="-1"></a>w.out.cps_plus.opt <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;optweight&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb294-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-3" tabindex="-1"></a>w.out.psid_plus.opt <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;optweight&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb294-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-4" tabindex="-1"></a></span>
<span id="cb294-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-5" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>opt_weight <span class="ot">&lt;-</span> w.out.cps_plus.opt<span class="sc">$</span>weights</span>
<span id="cb294-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb294-6" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>opt_weight <span class="ot">&lt;-</span> w.out.psid_plus.opt<span class="sc">$</span>weights</span></code></pre></div>
</div>
<div id="overlap-weights-1" class="section level4 hasAnchor" number="3.3.2.4">
<h4><span class="header-section-number">3.3.2.4</span> Overlap weights<a href="lalonde-dehejia-wahba-ldw-data-1.html#overlap-weights-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb295-1" tabindex="-1"></a><span class="co"># calculate overlap weights emphasizing units with propensity scores near 0.5</span></span>
<span id="cb295-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb295-2" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>overlap_weight <span class="ot">&lt;-</span> <span class="fu">create_overlap_weights</span>(ldw_cps_plus, model)</span>
<span id="cb295-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb295-3" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>overlap_weight <span class="ot">&lt;-</span> <span class="fu">create_overlap_weights</span>(ldw_psid_plus, model)</span></code></pre></div>
</div>
<div id="entropy-weights-1" class="section level4 hasAnchor" number="3.3.2.5">
<h4><span class="header-section-number">3.3.2.5</span> Entropy weights<a href="lalonde-dehejia-wahba-ldw-data-1.html#entropy-weights-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-1" tabindex="-1"></a><span class="co"># compute entropy balancing weights </span></span>
<span id="cb296-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-2" tabindex="-1"></a>w.out.cps_plus.ebal <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">method =</span> <span class="st">&quot;ebal&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb296-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-3" tabindex="-1"></a>w.out.psid_plus.ebal <span class="ot">&lt;-</span> <span class="fu">weightit</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">method =</span> <span class="st">&quot;ebal&quot;</span>, <span class="at">estimand =</span> <span class="st">&quot;ATT&quot;</span>)</span>
<span id="cb296-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-4" tabindex="-1"></a></span>
<span id="cb296-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-5" tabindex="-1"></a>ldw_cps_plus<span class="sc">$</span>ebal_weight <span class="ot">&lt;-</span> w.out.cps_plus.ebal<span class="sc">$</span>weights</span>
<span id="cb296-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb296-6" tabindex="-1"></a>ldw_psid_plus<span class="sc">$</span>ebal_weight <span class="ot">&lt;-</span> w.out.psid_plus.ebal<span class="sc">$</span>weights</span></code></pre></div>
</div>
</div>
</div>
<div id="improving-primarily-overlap-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Improving primarily overlap<a href="lalonde-dehejia-wahba-ldw-data-1.html#improving-primarily-overlap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="truncation-4" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Truncation<a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb297-1" tabindex="-1"></a><span class="co"># list weight columns to apply truncation </span></span>
<span id="cb297-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb297-2" tabindex="-1"></a>weight_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ipw_weight&quot;</span>, <span class="st">&quot;smr_weight&quot;</span>, <span class="st">&quot;opt_weight&quot;</span>, <span class="st">&quot;overlap_weight&quot;</span>, <span class="st">&quot;ebal_weight&quot;</span>)</span></code></pre></div>
<div id="fixed-maximum-value-truncation-1" class="section level4 hasAnchor" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> Fixed maximum value truncation<a href="lalonde-dehejia-wahba-ldw-data-1.html#fixed-maximum-value-truncation-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-1" tabindex="-1"></a><span class="co"># truncate weights by imposing a maximum threshold of 10</span></span>
<span id="cb298-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-2" tabindex="-1"></a>ldw_cps_plus.fixed <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb298-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb298-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.fixed)) {</span>
<span id="cb298-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-5" tabindex="-1"></a>    ldw_cps_plus.fixed <span class="ot">&lt;-</span> <span class="fu">truncate_weights_fixed</span>(ldw_cps_plus.fixed, <span class="at">weight_col =</span> wcol, <span class="at">max_weight =</span> <span class="dv">10</span>)</span>
<span id="cb298-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-6" tabindex="-1"></a>  }</span>
<span id="cb298-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-7" tabindex="-1"></a>}</span>
<span id="cb298-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-8" tabindex="-1"></a></span>
<span id="cb298-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-9" tabindex="-1"></a>ldw_psid_plus.fixed <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb298-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb298-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.fixed)) {</span>
<span id="cb298-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-12" tabindex="-1"></a>    ldw_psid_plus.fixed <span class="ot">&lt;-</span> <span class="fu">truncate_weights_fixed</span>(ldw_psid_plus.fixed, <span class="at">weight_col =</span> wcol, <span class="at">max_weight =</span> <span class="dv">10</span>)</span>
<span id="cb298-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-13" tabindex="-1"></a>  }</span>
<span id="cb298-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb298-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="at-percentile-truncation-1" class="section level4 hasAnchor" number="3.4.1.2">
<h4><span class="header-section-number">3.4.1.2</span> At percentile truncation<a href="lalonde-dehejia-wahba-ldw-data-1.html#at-percentile-truncation-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-1" tabindex="-1"></a><span class="co"># truncate weights such that values above the 99th percentile are capped</span></span>
<span id="cb299-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-2" tabindex="-1"></a>ldw_cps_plus.percent <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb299-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb299-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.percent)) {</span>
<span id="cb299-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-5" tabindex="-1"></a>    ldw_cps_plus.percent <span class="ot">&lt;-</span> <span class="fu">truncate_weights_percentile</span>(ldw_cps_plus.percent, <span class="at">weight_col =</span> wcol, <span class="at">percentile =</span> <span class="fl">0.99</span>)</span>
<span id="cb299-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-6" tabindex="-1"></a>  }</span>
<span id="cb299-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-7" tabindex="-1"></a>}</span>
<span id="cb299-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-8" tabindex="-1"></a></span>
<span id="cb299-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-9" tabindex="-1"></a>ldw_psid_plus.percent <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb299-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb299-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.percent)) {</span>
<span id="cb299-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-12" tabindex="-1"></a>    ldw_psid_plus.percent <span class="ot">&lt;-</span> <span class="fu">truncate_weights_percentile</span>(ldw_psid_plus.percent, <span class="at">weight_col =</span> wcol, <span class="at">percentile =</span> <span class="fl">0.99</span>)</span>
<span id="cb299-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-13" tabindex="-1"></a>  }</span>
<span id="cb299-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb299-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="adaptive-weight-truncation-1" class="section level4 hasAnchor" number="3.4.1.3">
<h4><span class="header-section-number">3.4.1.3</span> Adaptive weight truncation<a href="lalonde-dehejia-wahba-ldw-data-1.html#adaptive-weight-truncation-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-1" tabindex="-1"></a><span class="co"># inspect variance of weights </span></span>
<span id="cb300-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-2" tabindex="-1"></a>cps_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb300-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-3" tabindex="-1"></a>psid_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb300-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-4" tabindex="-1"></a></span>
<span id="cb300-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-5" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb300-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-6" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus)) {</span>
<span id="cb300-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-7" tabindex="-1"></a>    cps_results[[<span class="fu">paste0</span>(<span class="st">&quot;cps_&quot;</span>, wcol)]] <span class="ot">&lt;-</span> <span class="fu">check_weights</span>(ldw_cps_plus, wcol)</span>
<span id="cb300-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-8" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb300-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-9" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Column&quot;</span>, wcol, <span class="st">&quot;not found in ldw_cps_plus&quot;</span>))</span>
<span id="cb300-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-10" tabindex="-1"></a>  }</span>
<span id="cb300-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-11" tabindex="-1"></a>}</span>
<span id="cb300-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-12" tabindex="-1"></a></span>
<span id="cb300-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-13" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb300-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-14" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus)) {</span>
<span id="cb300-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-15" tabindex="-1"></a>    psid_results[[<span class="fu">paste0</span>(<span class="st">&quot;psid_&quot;</span>, wcol)]] <span class="ot">&lt;-</span> <span class="fu">check_weights</span>(ldw_psid_plus, wcol)</span>
<span id="cb300-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-16" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb300-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-17" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Column&quot;</span>, wcol, <span class="st">&quot;not found in ldw_psid_plus&quot;</span>))</span>
<span id="cb300-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-18" tabindex="-1"></a>  }</span>
<span id="cb300-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-19" tabindex="-1"></a>}</span>
<span id="cb300-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-20" tabindex="-1"></a></span>
<span id="cb300-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-21" tabindex="-1"></a>var_cps_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cps_results)</span>
<span id="cb300-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-22" tabindex="-1"></a>var_psid_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(psid_results)</span>
<span id="cb300-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-23" tabindex="-1"></a></span>
<span id="cb300-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb300-24" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(var_cps_table, <span class="at">caption =</span> <span class="st">&quot;Variance of Weights (CPS)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-210">Table 3.3: </span>Variance of Weights (CPS)</caption>
<thead>
<tr class="header">
<th align="left">Weight_Column</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ipw_weight</td>
<td align="right">8.275220e-02</td>
</tr>
<tr class="even">
<td align="left">smr_weight</td>
<td align="right">1.811097e+03</td>
</tr>
<tr class="odd">
<td align="left">opt_weight</td>
<td align="right">1.210057e+17</td>
</tr>
<tr class="even">
<td align="left">overlap_weight</td>
<td align="right">1.271230e-02</td>
</tr>
<tr class="odd">
<td align="left">ebal_weight</td>
<td align="right">7.065942e+01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb301-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(var_psid_table, <span class="at">caption =</span> <span class="st">&quot;Variance of Weights (PSID)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-210">Table 3.3: </span>Variance of Weights (PSID)</caption>
<thead>
<tr class="header">
<th align="left">Weight_Column</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ipw_weight</td>
<td align="right">12.1074733</td>
</tr>
<tr class="even">
<td align="left">smr_weight</td>
<td align="right">1139.8553936</td>
</tr>
<tr class="odd">
<td align="left">opt_weight</td>
<td align="right">74.5166468</td>
</tr>
<tr class="even">
<td align="left">overlap_weight</td>
<td align="right">0.0257408</td>
</tr>
<tr class="odd">
<td align="left">ebal_weight</td>
<td align="right">109.7344945</td>
</tr>
</tbody>
</table>
<p>Regarding these results we can apply adaptive weight truncation to all considered weights, where it may help mitigate the influence of extreme weights.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-1" tabindex="-1"></a><span class="co"># truncate adaptively at mean + 3 standard deviations </span></span>
<span id="cb302-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-2" tabindex="-1"></a>ldw_cps_plus.adapt <span class="ot">&lt;-</span> ldw_cps_plus</span>
<span id="cb302-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-3" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb302-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-4" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_cps_plus.adapt)) {</span>
<span id="cb302-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-5" tabindex="-1"></a>    ldw_cps_plus.adapt <span class="ot">&lt;-</span> <span class="fu">truncate_weights_adaptive</span>(ldw_cps_plus.adapt, <span class="at">weight_col =</span> wcol, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb302-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-6" tabindex="-1"></a>  }</span>
<span id="cb302-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-7" tabindex="-1"></a>}</span>
<span id="cb302-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-8" tabindex="-1"></a></span>
<span id="cb302-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-9" tabindex="-1"></a>ldw_psid_plus.adapt <span class="ot">&lt;-</span> ldw_psid_plus</span>
<span id="cb302-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-10" tabindex="-1"></a><span class="cf">for</span> (wcol <span class="cf">in</span> weight_columns) {</span>
<span id="cb302-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-11" tabindex="-1"></a>  <span class="cf">if</span> (wcol <span class="sc">%in%</span> <span class="fu">names</span>(ldw_psid_plus.adapt)) {</span>
<span id="cb302-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-12" tabindex="-1"></a>    ldw_psid_plus.adapt <span class="ot">&lt;-</span> <span class="fu">truncate_weights_adaptive</span>(ldw_psid_plus.adapt, <span class="at">weight_col =</span> wcol, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb302-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-13" tabindex="-1"></a>  }</span>
<span id="cb302-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb302-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="trimming-4" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="propensity-score-threshold-trimming-analogous-to-tutorial-of-imbens2024" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Propensity score threshold trimming (analogous to tutorial of <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>)<a href="lalonde-dehejia-wahba-ldw-data-1.html#propensity-score-threshold-trimming-analogous-to-tutorial-of-imbens2024" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-1" tabindex="-1"></a><span class="co"># apply trimming with thresholds 0.9 and 0.8 </span></span>
<span id="cb303-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-2" tabindex="-1"></a>ldw_cps_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_cps_plus.ps, <span class="at">threshold =</span> <span class="fl">0.9</span>)</span>
<span id="cb303-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-3" tabindex="-1"></a>ldw_psid_trim <span class="ot">&lt;-</span> <span class="fu">ps_trim</span>(ldw_psid_plus.ps, <span class="at">threshold =</span> <span class="fl">0.8</span>)</span>
<span id="cb303-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-4" tabindex="-1"></a></span>
<span id="cb303-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-5" tabindex="-1"></a><span class="co"># exclude experimental controls, subset trimmed data appropriately</span></span>
<span id="cb303-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-6" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_cps_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb303-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-7" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">subset</span>(ldw_psid_trim, sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">&amp;</span> ps_assoverlap)</span>
<span id="cb303-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-8" tabindex="-1"></a></span>
<span id="cb303-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-9" tabindex="-1"></a><span class="co"># re-assign treat variable for controls in sample 3 or 4 (non-treated group)</span></span>
<span id="cb303-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-10" tabindex="-1"></a>ldw_cps.trim_match<span class="sc">$</span>treat[ldw_cps.trim_match<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb303-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-11" tabindex="-1"></a>ldw_psid.trim_match<span class="sc">$</span>treat[ldw_psid.trim_match<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb303-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-12" tabindex="-1"></a></span>
<span id="cb303-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-13" tabindex="-1"></a><span class="co"># re-estimate propensity scores on trimmed data and perform 1:1 matching</span></span>
<span id="cb303-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-14" tabindex="-1"></a>ldw_cps.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_cps.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span>
<span id="cb303-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb303-15" tabindex="-1"></a>ldw_psid.trim_match <span class="ot">&lt;-</span> <span class="fu">psmatch</span>(<span class="at">data =</span> ldw_psid.trim_match, <span class="at">Y =</span> <span class="st">&quot;re78&quot;</span>, <span class="at">treat =</span> <span class="st">&quot;treat&quot;</span>, <span class="at">cov =</span> covar)</span></code></pre></div>
</div>
<div id="common-range-trimming-1" class="section level4 hasAnchor" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> Common range trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#common-range-trimming-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb304-1" tabindex="-1"></a><span class="co"># trim observations outside the common support region of propensity scores</span></span>
<span id="cb304-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb304-2" tabindex="-1"></a>ldw_cps_plus.common   <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb304-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb304-3" tabindex="-1"></a>ldw_psid_plus.common  <span class="ot">&lt;-</span> <span class="fu">common_range_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
<div id="propensity-score-trimming-crump-1" class="section level4 hasAnchor" number="3.4.2.3">
<h4><span class="header-section-number">3.4.2.3</span> Propensity score trimming (Crump)<a href="lalonde-dehejia-wahba-ldw-data-1.html#propensity-score-trimming-crump-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb305-1" tabindex="-1"></a><span class="co"># trim observations with propensity scores outside [0.1, 0.9] interval</span></span>
<span id="cb305-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb305-2" tabindex="-1"></a>ldw_cps_plus.crump  <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_cps_plus.ps, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fl">0.9</span>)</span>
<span id="cb305-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb305-3" tabindex="-1"></a>ldw_psid_plus.crump <span class="ot">&lt;-</span> <span class="fu">crump_trim</span>(ldw_psid_plus.ps, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fl">0.9</span>)</span></code></pre></div>
</div>
<div id="stuermer-trimming-1" class="section level4 hasAnchor" number="3.4.2.4">
<h4><span class="header-section-number">3.4.2.4</span> Stuermer trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#stuermer-trimming-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb306-1" tabindex="-1"></a><span class="co"># trim observations based on propensity score quantiles separately for treated and control</span></span>
<span id="cb306-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb306-2" tabindex="-1"></a>ldw_cps_plus.stuermer  <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb306-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb306-3" tabindex="-1"></a>ldw_psid_plus.stuermer <span class="ot">&lt;-</span> <span class="fu">stuermer_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
<div id="walker-trimming-1" class="section level4 hasAnchor" number="3.4.2.5">
<h4><span class="header-section-number">3.4.2.5</span> Walker trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#walker-trimming-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb307-1" tabindex="-1"></a><span class="co"># trim observations based on preference scores that adjust for treatment prevalence using logit transformations</span></span>
<span id="cb307-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb307-2" tabindex="-1"></a>ldw_cps_plus.walker   <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_cps_plus.ps)</span>
<span id="cb307-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb307-3" tabindex="-1"></a>ldw_psid_plus.walker  <span class="ot">&lt;-</span> <span class="fu">walker_trim</span>(ldw_psid_plus.ps)</span></code></pre></div>
</div>
</div>
<div id="integrated-methods-2" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb308-1" tabindex="-1"></a><span class="co"># list trimming methods</span></span>
<span id="cb308-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb308-2" tabindex="-1"></a>trim_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ps_threshold&quot;</span>, <span class="st">&quot;common_range&quot;</span>, <span class="st">&quot;stuermer&quot;</span>, <span class="st">&quot;walker&quot;</span>, <span class="st">&quot;crump&quot;</span>)</span>
<span id="cb308-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb308-3" tabindex="-1"></a>trimmed_cps  <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold =</span> ldw_cps_trim, <span class="at">common_range =</span> ldw_cps_plus.common, <span class="at">stuermer =</span> ldw_cps_plus.stuermer, <span class="at">walker =</span> ldw_cps_plus.walker, <span class="at">crump =</span> ldw_cps_plus.crump)</span>
<span id="cb308-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb308-4" tabindex="-1"></a>trimmed_psid <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ps_threshold =</span> ldw_psid_trim, <span class="at">common_range =</span> ldw_psid_plus.common, <span class="at">stuermer =</span> ldw_psid_plus.stuermer, <span class="at">walker =</span> ldw_psid_plus.walker, <span class="at">crump =</span> ldw_psid_plus.crump)</span></code></pre></div>
<div id="ipw-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="section level4 hasAnchor" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> IPW with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data-1.html#ipw-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-1" tabindex="-1"></a><span class="co"># apply inverse probability weighting (IPW) with trimming and attach IPW weights</span></span>
<span id="cb309-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-2" tabindex="-1"></a>ipw_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb309-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;ipw_weight&quot;</span>)),</span>
<span id="cb309-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-4" tabindex="-1"></a>  trim_names</span>
<span id="cb309-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-5" tabindex="-1"></a>)</span>
<span id="cb309-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-6" tabindex="-1"></a>ipw_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb309-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;ipw_weight&quot;</span>)),</span>
<span id="cb309-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-8" tabindex="-1"></a>  trim_names</span>
<span id="cb309-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb309-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="smr-treated-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="section level4 hasAnchor" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> SMR treated weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data-1.html#smr-treated-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-1" tabindex="-1"></a><span class="co"># apply standardized mortality ratio (SMR) weighting with trimming and attach SMR weights</span></span>
<span id="cb310-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-2" tabindex="-1"></a>smr_treat_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb310-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;smr_weight&quot;</span>)),</span>
<span id="cb310-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-4" tabindex="-1"></a>  trim_names</span>
<span id="cb310-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-5" tabindex="-1"></a>)</span>
<span id="cb310-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-6" tabindex="-1"></a>smr_treat_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb310-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;smr_weight&quot;</span>)),</span>
<span id="cb310-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-8" tabindex="-1"></a>  trim_names</span>
<span id="cb310-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb310-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="overlap-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="section level4 hasAnchor" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> Overlap weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data-1.html#overlap-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-1" tabindex="-1"></a><span class="co"># apply overlap weighting with trimming and attach overlap weights</span></span>
<span id="cb311-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-2" tabindex="-1"></a>ov_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb311-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;overlap_weight&quot;</span>)),</span>
<span id="cb311-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-4" tabindex="-1"></a>  trim_names</span>
<span id="cb311-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-5" tabindex="-1"></a>)</span>
<span id="cb311-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-6" tabindex="-1"></a>ov_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb311-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;overlap_weight&quot;</span>)),</span>
<span id="cb311-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-8" tabindex="-1"></a>  trim_names</span>
<span id="cb311-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb311-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="entropy-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="section level4 hasAnchor" number="3.4.3.4">
<h4><span class="header-section-number">3.4.3.4</span> Entropy weights with 1) propensity threshold 2) common range 3) stuermer 4) walker 5) crump<a href="lalonde-dehejia-wahba-ldw-data-1.html#entropy-weights-with-1-propensity-threshold-2-common-range-3-stuermer-4-walker-5-crump-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-1" tabindex="-1"></a><span class="co"># apply entropy balancing weights with trimming and attach entropy weights</span></span>
<span id="cb312-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-2" tabindex="-1"></a>entropy_comb.cps_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb312-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-3" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_cps[[nm]], ldw_cps_plus, <span class="st">&quot;ebal_weight&quot;</span>)),</span>
<span id="cb312-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-4" tabindex="-1"></a>  trim_names</span>
<span id="cb312-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-5" tabindex="-1"></a>)</span>
<span id="cb312-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-6" tabindex="-1"></a>entropy_comb.psid_plus <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb312-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-7" tabindex="-1"></a>  <span class="fu">lapply</span>(trim_names, <span class="cf">function</span>(nm) <span class="fu">trim_attach_weights</span>(trimmed_psid[[nm]], ldw_psid_plus, <span class="st">&quot;ebal_weight&quot;</span>)),</span>
<span id="cb312-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-8" tabindex="-1"></a>  trim_names</span>
<span id="cb312-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb312-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div id="reassessing-methods-2" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Reassessing methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#reassessing-methods-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="matching-5" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Matching<a href="lalonde-dehejia-wahba-ldw-data-1.html#matching-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-1" tabindex="-1"></a><span class="co"># list all matching methods</span></span>
<span id="cb313-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-2" tabindex="-1"></a>methods.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb313-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-3" tabindex="-1"></a>  <span class="at">nn =</span> m.out.cps_plus.nearest,</span>
<span id="cb313-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-4" tabindex="-1"></a>  <span class="at">k2 =</span> m.out.cps_plus.k2,</span>
<span id="cb313-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-5" tabindex="-1"></a>  <span class="at">k3 =</span> m.out.cps_plus.k3,</span>
<span id="cb313-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-6" tabindex="-1"></a>  <span class="at">caliper =</span> m.out.cps_plus.caliper,</span>
<span id="cb313-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-7" tabindex="-1"></a>  <span class="at">cS =</span> m.out.cps_plus.cs,</span>
<span id="cb313-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-8" tabindex="-1"></a>  <span class="at">mahvars =</span> m.out.cps_plus.mahvars,</span>
<span id="cb313-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-9" tabindex="-1"></a>  <span class="at">optimal_pair =</span> m.out.cps_plus.optimal_pair,</span>
<span id="cb313-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-10" tabindex="-1"></a>  <span class="at">optimal_full =</span> m.out.cps_plus.optimal_full,</span>
<span id="cb313-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-11" tabindex="-1"></a>  <span class="at">gen_full =</span> m.out.cps_plus.general_full,</span>
<span id="cb313-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-12" tabindex="-1"></a>  <span class="at">genetic =</span> m.out.cps_plus.genetic,</span>
<span id="cb313-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-13" tabindex="-1"></a>  <span class="at">exact =</span> m.out.cps_plus.exact,</span>
<span id="cb313-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-14" tabindex="-1"></a>  <span class="at">cem =</span> m.out.cps_plus.cem,</span>
<span id="cb313-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-15" tabindex="-1"></a>  <span class="at">card =</span> m.out.cps_plus.card,</span>
<span id="cb313-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-16" tabindex="-1"></a>  <span class="at">profile =</span> m.out.cps_plus.profile,</span>
<span id="cb313-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-17" tabindex="-1"></a>  <span class="at">subcl =</span> m.out.cps_plus.subcl</span>
<span id="cb313-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-18" tabindex="-1"></a>)</span>
<span id="cb313-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-19" tabindex="-1"></a></span>
<span id="cb313-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-20" tabindex="-1"></a>methods.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb313-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-21" tabindex="-1"></a>  <span class="at">nn =</span> m.out.psid_plus.nearest,</span>
<span id="cb313-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-22" tabindex="-1"></a>  <span class="at">k2 =</span> m.out.psid_plus.k2,</span>
<span id="cb313-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-23" tabindex="-1"></a>  <span class="at">k3 =</span> m.out.psid_plus.k3,</span>
<span id="cb313-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-24" tabindex="-1"></a>  <span class="at">caliper =</span> m.out.psid_plus.caliper,</span>
<span id="cb313-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-25" tabindex="-1"></a>  <span class="at">cs =</span> m.out.psid_plus.cs,</span>
<span id="cb313-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-26" tabindex="-1"></a>  <span class="at">mahvars =</span> m.out.psid_plus.mahvars,</span>
<span id="cb313-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-27" tabindex="-1"></a>  <span class="at">optimal_pair =</span> m.out.psid_plus.optimal_pair,</span>
<span id="cb313-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-28" tabindex="-1"></a>  <span class="at">optimal_full =</span> m.out.psid_plus.optimal_full,</span>
<span id="cb313-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-29" tabindex="-1"></a>  <span class="at">gen_full =</span> m.out.psid_plus.general_full,</span>
<span id="cb313-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-30" tabindex="-1"></a>  <span class="at">genetic =</span> m.out.psid_plus.genetic,</span>
<span id="cb313-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-31" tabindex="-1"></a>  <span class="at">exact =</span> m.out.psid_plus.exact,</span>
<span id="cb313-32"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-32" tabindex="-1"></a>  <span class="at">cem =</span> m.out.psid_plus.cem,</span>
<span id="cb313-33"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-33" tabindex="-1"></a>  <span class="at">card =</span> m.out.psid_plus.card,</span>
<span id="cb313-34"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-34" tabindex="-1"></a>  <span class="at">profile =</span> m.out.psid_plus.profile,</span>
<span id="cb313-35"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-35" tabindex="-1"></a>  <span class="at">subcl =</span> m.out.psid_plus.subcl</span>
<span id="cb313-36"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb313-36" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-5" class="section level4 hasAnchor" number="3.5.1.1">
<h4><span class="header-section-number">3.5.1.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb314-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb314-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb314-2" tabindex="-1"></a>smd_matchit.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(methods.cps_plus)</span>
<span id="cb314-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb314-3" tabindex="-1"></a>smd_matchit.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_matchit</span>(methods.psid_plus)</span></code></pre></div>
</div>
<div id="ess-5" class="section level4 hasAnchor" number="3.5.1.2">
<h4><span class="header-section-number">3.5.1.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data-1.html#ess-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb315-1" tabindex="-1"></a><span class="co"># calculate balance statistics </span></span>
<span id="cb315-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb315-2" tabindex="-1"></a>bal.cps_plus <span class="ot">&lt;-</span> cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(model, <span class="at">data =</span> ldw_cps_plus, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">weights =</span> methods.cps_plus, <span class="at">s.d.denom =</span> <span class="st">&quot;treated&quot;</span>)</span>
<span id="cb315-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb315-3" tabindex="-1"></a>bal.psid_plus <span class="ot">&lt;-</span> cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(model, <span class="at">data =</span> ldw_psid_plus, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">weights =</span> methods.psid_plus, <span class="at">s.d.denom =</span> <span class="st">&quot;treated&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb316-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb316-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb316-2" tabindex="-1"></a>ess_matchit.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_matchit</span>(bal.cps_plus)</span>
<span id="cb316-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb316-3" tabindex="-1"></a>ess_matchit.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_matchit</span>(bal.psid_plus)</span></code></pre></div>
</div>
<div id="visuals-5" class="section level4 hasAnchor" number="3.5.1.3">
<h4><span class="header-section-number">3.5.1.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data-1.html#visuals-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb317-1" tabindex="-1"></a><span class="co"># visualize covariate balance </span></span>
<span id="cb317-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb317-2" tabindex="-1"></a><span class="fu">plot_matchit</span>(methods.cps_plus, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-1.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.10: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-2.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.11: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-3.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.12: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-4.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.13: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-5.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.14: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-6.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.15: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-7.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.16: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-8.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.17: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-9.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.18: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-10.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.19: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-11.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.20: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-12.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.21: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-13.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.22: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-14.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.23: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-15.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.24: FIGURE B3.
</p>
</div>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb318-1" tabindex="-1"></a><span class="fu">plot_matchit</span>(methods.psid_plus, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-16.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.25: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-17.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.26: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-18.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.27: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-19.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.28: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-20.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.29: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-21.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.30: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-22.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.31: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-23.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.32: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-24.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.33: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-25.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.34: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-26.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.35: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-27.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.36: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-28.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.37: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-29.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.38: FIGURE B3.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-226-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-226-30.png" alt="FIGURE B3." width="672" />
<p class="caption">
Figure 3.39: FIGURE B3.
</p>
</div>
</div>
</div>
<div id="weighting-5" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Weighting<a href="lalonde-dehejia-wahba-ldw-data-1.html#weighting-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-1" tabindex="-1"></a><span class="co"># list all weights</span></span>
<span id="cb319-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-2" tabindex="-1"></a>weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb319-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-3" tabindex="-1"></a>  <span class="at">ipw =</span> ldw_cps_plus<span class="sc">$</span>ipw_weight,</span>
<span id="cb319-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-4" tabindex="-1"></a>  <span class="at">smr_tr =</span> ldw_cps_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb319-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-5" tabindex="-1"></a>  <span class="at">mw =</span> ldw_cps_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb319-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-6" tabindex="-1"></a>  <span class="at">ow =</span> ldw_cps_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb319-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-7" tabindex="-1"></a>  <span class="at">ew =</span> ldw_cps_plus<span class="sc">$</span>ebal_weight</span>
<span id="cb319-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-8" tabindex="-1"></a>)</span>
<span id="cb319-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-9" tabindex="-1"></a></span>
<span id="cb319-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-10" tabindex="-1"></a>weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb319-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-11" tabindex="-1"></a>  <span class="at">ipw =</span> ldw_psid_plus<span class="sc">$</span>ipw_weight,</span>
<span id="cb319-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-12" tabindex="-1"></a>  <span class="at">smr_tr =</span> ldw_psid_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb319-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-13" tabindex="-1"></a>  <span class="at">mw =</span> ldw_psid_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb319-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-14" tabindex="-1"></a>  <span class="at">ow =</span> ldw_psid_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb319-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-15" tabindex="-1"></a>  <span class="at">ew =</span> ldw_psid_plus<span class="sc">$</span>ebal_weight</span>
<span id="cb319-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb319-16" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-6" class="section level4 hasAnchor" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb320-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb320-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb320-2" tabindex="-1"></a>smd_weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_weight</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb320-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb320-3" tabindex="-1"></a>smd_weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_weight</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="ess-6" class="section level4 hasAnchor" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data-1.html#ess-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb321-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb321-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb321-2" tabindex="-1"></a>ess_weight.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_weight</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb321-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb321-3" tabindex="-1"></a>ess_weight.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_weight</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="visuals-6" class="section level4 hasAnchor" number="3.5.2.3">
<h4><span class="header-section-number">3.5.2.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data-1.html#visuals-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb322-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb322-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb322-2" tabindex="-1"></a><span class="fu">plot_weighting_methods</span>(ldw_cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight.cps_plus, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-1.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.40: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-2.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.41: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-3.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.42: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-4.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.43: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-5.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.44: FIGURE B4.
</p>
</div>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb323-1" tabindex="-1"></a><span class="fu">plot_weighting_methods</span>(ldw_psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight.psid_plus, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-6.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.45: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-7.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.46: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-8.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.47: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-9.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.48: FIGURE B4.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-230-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-230-10.png" alt="FIGURE B4." width="672" />
<p class="caption">
Figure 3.49: FIGURE B4.
</p>
</div>
</div>
</div>
<div id="truncation-5" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Truncation<a href="lalonde-dehejia-wahba-ldw-data-1.html#truncation-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-1" tabindex="-1"></a><span class="co"># list truncation methods</span></span>
<span id="cb324-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-2" tabindex="-1"></a>trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb324-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-3" tabindex="-1"></a>  <span class="at">fix_max_value_trunc.cps_plus =</span> ldw_cps_plus.fixed,</span>
<span id="cb324-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-4" tabindex="-1"></a>  <span class="at">at_perc_trunc.cps_plus =</span> ldw_cps_plus.percent,</span>
<span id="cb324-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-5" tabindex="-1"></a>  <span class="at">adap_weight_trunc.cps_plus =</span> ldw_cps_plus.adapt</span>
<span id="cb324-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-6" tabindex="-1"></a>)</span>
<span id="cb324-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-7" tabindex="-1"></a></span>
<span id="cb324-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-8" tabindex="-1"></a>trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb324-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-9" tabindex="-1"></a>  <span class="at">fix_max_value_trunc.psid_plus =</span> ldw_psid_plus.fixed,</span>
<span id="cb324-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-10" tabindex="-1"></a>  <span class="at">at_perc_trunc.psid_plus =</span> ldw_psid_plus.percent,</span>
<span id="cb324-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-11" tabindex="-1"></a>  <span class="at">adap_weight_trunc.psid_plus =</span> ldw_psid_plus.adapt</span>
<span id="cb324-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb324-12" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-7" class="section level4 hasAnchor" number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb325-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb325-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb325-2" tabindex="-1"></a>smd_trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trunc</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb325-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb325-3" tabindex="-1"></a>smd_trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trunc</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="ess-7" class="section level4 hasAnchor" number="3.5.3.2">
<h4><span class="header-section-number">3.5.3.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data-1.html#ess-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb326-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb326-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb326-2" tabindex="-1"></a>ess_trunc.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trunc</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span>
<span id="cb326-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb326-3" tabindex="-1"></a>ess_trunc.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trunc</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns)</span></code></pre></div>
</div>
<div id="visuals-7" class="section level4 hasAnchor" number="3.5.3.3">
<h4><span class="header-section-number">3.5.3.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data-1.html#visuals-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb327-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb327-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb327-2" tabindex="-1"></a><span class="fu">plot_trunc_methods</span>(trunc.cps_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns, <span class="st">&quot;LDW-CPS1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-1.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.50: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-2.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.51: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-3.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.52: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-4.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.53: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-5.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.54: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-6.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.55: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-7.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.56: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-8.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.57: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-9.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.58: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-10.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.59: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-11.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.60: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-12.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.61: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-13.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.62: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-14.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.63: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-15.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.64: FIGURE B5.
</p>
</div>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb328-1" tabindex="-1"></a><span class="fu">plot_trunc_methods</span>(trunc.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, weight_columns, <span class="st">&quot;LDW-PSID1-PLUS&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-16.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.65: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-17.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.66: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-18.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.67: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-19.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.68: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-20.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.69: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-21.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.70: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-22.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.71: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-23.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.72: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-24.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.73: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-25.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.74: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-26.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.75: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-27.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.76: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-28.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.77: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-29.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.78: FIGURE B5.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-234-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-234-30.png" alt="FIGURE B5." width="672" />
<p class="caption">
Figure 3.79: FIGURE B5.
</p>
</div>
</div>
</div>
<div id="trimming-5" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Trimming<a href="lalonde-dehejia-wahba-ldw-data-1.html#trimming-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-1" tabindex="-1"></a><span class="co"># list trimming objects</span></span>
<span id="cb329-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-2" tabindex="-1"></a>trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb329-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-3" tabindex="-1"></a>  <span class="at">original =</span> ldw_cps_plus,  </span>
<span id="cb329-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-4" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_cps.trim_match,  </span>
<span id="cb329-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-5" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_cps_plus.common,      </span>
<span id="cb329-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-6" tabindex="-1"></a>  <span class="at">crump =</span> ldw_cps_plus.crump,      </span>
<span id="cb329-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-7" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_cps_plus.stuermer,     </span>
<span id="cb329-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-8" tabindex="-1"></a>  <span class="at">walker =</span> ldw_cps_plus.walker    </span>
<span id="cb329-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-9" tabindex="-1"></a>)</span>
<span id="cb329-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-10" tabindex="-1"></a></span>
<span id="cb329-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-11" tabindex="-1"></a>trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb329-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-12" tabindex="-1"></a>  <span class="at">original =</span> ldw_psid_plus,</span>
<span id="cb329-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-13" tabindex="-1"></a>  <span class="at">ps_threshold =</span> ldw_psid.trim_match,</span>
<span id="cb329-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-14" tabindex="-1"></a>  <span class="at">common_range =</span> ldw_psid_plus.common,</span>
<span id="cb329-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-15" tabindex="-1"></a>  <span class="at">crump =</span> ldw_psid_plus.crump,</span>
<span id="cb329-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-16" tabindex="-1"></a>  <span class="at">stuermer =</span> ldw_psid_plus.stuermer,</span>
<span id="cb329-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-17" tabindex="-1"></a>  <span class="at">walker =</span> ldw_psid_plus.walker</span>
<span id="cb329-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb329-18" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-8" class="section level4 hasAnchor" number="3.5.4.1">
<h4><span class="header-section-number">3.5.4.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb330-1" tabindex="-1"></a><span class="co"># compute SMDs</span></span>
<span id="cb330-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb330-2" tabindex="-1"></a>smd_trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb330-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb330-3" tabindex="-1"></a>smd_trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_abs_smd_trim</span>(trim.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ess-8" class="section level4 hasAnchor" number="3.5.4.2">
<h4><span class="header-section-number">3.5.4.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data-1.html#ess-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb331-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb331-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb331-2" tabindex="-1"></a>ess_trim.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trim</span>(trim.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb331-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb331-3" tabindex="-1"></a>ess_trim.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_trim</span>(trim.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="visuals-8" class="section level4 hasAnchor" number="3.5.4.3">
<h4><span class="header-section-number">3.5.4.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data-1.html#visuals-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb332-1" tabindex="-1"></a><span class="co"># visualize overlap</span></span>
<span id="cb332-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb332-2" tabindex="-1"></a><span class="fu">plot_trim</span>(trim.cps_plus, treat, covar)</span></code></pre></div>
<pre><code>## -16.1181 3.425533</code></pre>
<pre><code>## -1.202299 0.8705262</code></pre>
<pre><code>## -9.631567 3.741997</code></pre>
<pre><code>## -2.335917 2.233477</code></pre>
<pre><code>## -7.250275 -2.186822</code></pre>
<pre><code>## -9.93813 -2.116352</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-238-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-238-1.png" alt="FIGURE B6." width="672" />
<p class="caption">
Figure 3.80: FIGURE B6.
</p>
</div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb339-1" tabindex="-1"></a><span class="fu">plot_trim</span>(trim.psid_plus, treat, covar)</span></code></pre></div>
<pre><code>## -11.65343 7.149751</code></pre>
<pre><code>## -0.7942771 0.5238475</code></pre>
<pre><code>## -5.989901 4.08461</code></pre>
<pre><code>## -1.995755 3.016909</code></pre>
<pre><code>## -3.356205 -1.192685</code></pre>
<pre><code>## -4.061815 -1.287922</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-238-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-238-2.png" alt="FIGURE B6." width="672" />
<p class="caption">
Figure 3.81: FIGURE B6.
</p>
</div>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb346-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb346-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb346-2" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps, ldw_cps.trim_match, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - propensity threshold trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-1.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.82: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb347-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps_plus, ldw_cps_plus.common, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - common range trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-2.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.83: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb348-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps_plus, ldw_cps_plus.crump,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - crump trimming&quot;</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-3.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.84: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb349-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps_plus, ldw_cps_plus.stuermer, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - stuermer trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-4.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.85: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb350-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_cps_plus, ldw_cps_plus.walker,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-CPS1-PLUS - walker trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-5.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.86: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb351-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid, ldw_psid.trim_match, treat, <span class="at">covar =</span> covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - propensity threshold trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-6.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.87: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb352-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid_plus, ldw_psid_plus.common, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - common range trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-7.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.88: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb353-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid_plus, ldw_psid_plus.crump, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - crump trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-8.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.89: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb354-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid_plus, ldw_psid_plus.stuermer, treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - stuermer trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-9.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.90: FIGURE B7.
</p>
</div>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb355-1" tabindex="-1"></a><span class="fu">love.plot</span>(ldw_psid_plus, ldw_psid_plus.walker,  treat, covar, <span class="at">title =</span> <span class="st">&quot;LDW-PSID1-PLUS - walker trimming&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-239-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-239-10.png" alt="FIGURE B7." width="672" />
<p class="caption">
Figure 3.91: FIGURE B7.
</p>
</div>
</div>
</div>
</div>
<div id="integrated-methods-3" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Integrated methods<a href="lalonde-dehejia-wahba-ldw-data-1.html#integrated-methods-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-1" tabindex="-1"></a><span class="co"># list all combined method results</span></span>
<span id="cb356-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-2" tabindex="-1"></a>comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb356-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-3" tabindex="-1"></a>  <span class="at">ipw =</span> ipw_comb.cps_plus,</span>
<span id="cb356-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-4" tabindex="-1"></a>  <span class="at">smr_treated =</span> smr_treat_comb.cps_plus,</span>
<span id="cb356-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-5" tabindex="-1"></a>  <span class="at">overlap =</span> ov_comb.cps_plus,</span>
<span id="cb356-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-6" tabindex="-1"></a>  <span class="at">entropy =</span> entropy_comb.cps_plus</span>
<span id="cb356-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-7" tabindex="-1"></a>)</span>
<span id="cb356-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-8" tabindex="-1"></a></span>
<span id="cb356-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-9" tabindex="-1"></a>comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb356-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-10" tabindex="-1"></a>  <span class="at">ipw =</span> ipw_comb.psid_plus,</span>
<span id="cb356-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-11" tabindex="-1"></a>  <span class="at">smr_treated =</span> smr_treat_comb.psid_plus,</span>
<span id="cb356-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-12" tabindex="-1"></a>  <span class="at">overlap =</span> ov_comb.psid_plus,</span>
<span id="cb356-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-13" tabindex="-1"></a>  <span class="at">entropy =</span> entropy_comb.psid_plus</span>
<span id="cb356-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb356-14" tabindex="-1"></a>)</span></code></pre></div>
<div id="smd-9" class="section level4 hasAnchor" number="3.6.0.1">
<h4><span class="header-section-number">3.6.0.1</span> SMD<a href="lalonde-dehejia-wahba-ldw-data-1.html#smd-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb357-1" tabindex="-1"></a><span class="co"># compute SMD</span></span>
<span id="cb357-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb357-2" tabindex="-1"></a>smd_all_comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_smd_all_datasets</span>(comb_meth.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb357-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb357-3" tabindex="-1"></a>smd_all_comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_smd_all_datasets</span>(comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="ess-9" class="section level4 hasAnchor" number="3.6.0.2">
<h4><span class="header-section-number">3.6.0.2</span> ESS<a href="lalonde-dehejia-wahba-ldw-data-1.html#ess-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb358-1" tabindex="-1"></a><span class="co"># compute ESS</span></span>
<span id="cb358-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb358-2" tabindex="-1"></a>ess_all_comb_meth.cps_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_all_datasets</span>(comb_meth.cps_plus, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb358-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb358-3" tabindex="-1"></a>ess_all_comb_meth.psid_plus <span class="ot">&lt;-</span> <span class="fu">compute_ess_all_datasets</span>(comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar)</span></code></pre></div>
</div>
<div id="visuals-9" class="section level4 hasAnchor" number="3.6.0.3">
<h4><span class="header-section-number">3.6.0.3</span> Visuals<a href="lalonde-dehejia-wahba-ldw-data-1.html#visuals-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb359-1" tabindex="-1"></a><span class="co"># visualize overlap</span></span>
<span id="cb359-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb359-2" tabindex="-1"></a><span class="fu">plot_comb_overlap</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix_cps =</span> <span class="st">&quot;LDW-CPS1&quot;</span>, <span class="at">prefix_psid =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<pre><code>## -13.48501 2.305571</code></pre>
<pre><code>## -8.874661 3.659497</code></pre>
<pre><code>## -7.861866 -2.176737</code></pre>
<pre><code>## -9.05304 -2.081006</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-1.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.92: FIGURE B8.
</p>
</div>
<pre><code>## -2.289938 2.23231</code></pre>
<pre><code>## -13.48501 2.305571</code></pre>
<pre><code>## -8.874661 3.659497</code></pre>
<pre><code>## -7.861866 -2.176737</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-2.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.93: FIGURE B8.
</p>
</div>
<pre><code>## -9.05304 -2.081006</code></pre>
<pre><code>## -2.289938 2.23231</code></pre>
<pre><code>## -13.48501 2.305571</code></pre>
<pre><code>## -8.874661 3.659497</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-3.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.94: FIGURE B8.
</p>
</div>
<pre><code>## -7.861866 -2.176737</code></pre>
<pre><code>## -9.05304 -2.081006</code></pre>
<pre><code>## -2.289938 2.23231</code></pre>
<pre><code>## -13.48501 2.305571</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-4.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.95: FIGURE B8.
</p>
</div>
<pre><code>## -8.874661 3.659497</code></pre>
<pre><code>## -7.861866 -2.176737</code></pre>
<pre><code>## -9.05304 -2.081006</code></pre>
<pre><code>## -2.289938 2.23231</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-5.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.96: FIGURE B8.
</p>
</div>
<pre><code>## -10.38834 0.9649936</code></pre>
<pre><code>## -5.718524 4.135585</code></pre>
<pre><code>## -3.513045 -1.212378</code></pre>
<pre><code>## -3.83598 -1.315594</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-6.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.97: FIGURE B8.
</p>
</div>
<pre><code>## -1.985899 2.972557</code></pre>
<pre><code>## -10.38834 0.9649936</code></pre>
<pre><code>## -5.718524 4.135585</code></pre>
<pre><code>## -3.513045 -1.212378</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-7.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.98: FIGURE B8.
</p>
</div>
<pre><code>## -3.83598 -1.315594</code></pre>
<pre><code>## -1.985899 2.972557</code></pre>
<pre><code>## -10.38834 0.9649936</code></pre>
<pre><code>## -5.718524 4.135585</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-8.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.99: FIGURE B8.
</p>
</div>
<pre><code>## -3.513045 -1.212378</code></pre>
<pre><code>## -3.83598 -1.315594</code></pre>
<pre><code>## -1.985899 2.972557</code></pre>
<pre><code>## -10.38834 0.9649936</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-9.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.100: FIGURE B8.
</p>
</div>
<pre><code>## -5.718524 4.135585</code></pre>
<pre><code>## -3.513045 -1.212378</code></pre>
<pre><code>## -3.83598 -1.315594</code></pre>
<pre><code>## -1.985899 2.972557</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-243-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-243-10.png" alt="FIGURE B8." width="672" />
<p class="caption">
Figure 3.101: FIGURE B8.
</p>
</div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb400-1" tabindex="-1"></a><span class="co"># visualize covariate balance</span></span>
<span id="cb400-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb400-2" tabindex="-1"></a><span class="fu">plot_comb_love_plots</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix_cps =</span> <span class="st">&quot;LDW-CPS1&quot;</span>, <span class="at">prefix_psid =</span> <span class="st">&quot;LDW-PSID1&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-1.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.102: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-2.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.103: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-3.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.104: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-4.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.105: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-5"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-5.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.106: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-6"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-6.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.107: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-7"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-7.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.108: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-8"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-8.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.109: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-9"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-9.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.110: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-10"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-10.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.111: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-11"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-11.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.112: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-12"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-12.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.113: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-13"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-13.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.114: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-14"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-14.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.115: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-15"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-15.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.116: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-16"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-16.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.117: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-17"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-17.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.118: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-18"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-18.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.119: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-19"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-19.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.120: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-20"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-20.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.121: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-21"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-21.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.122: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-22"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-22.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.123: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-23"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-23.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.124: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-24"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-24.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.125: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-25"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-25.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.126: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-26"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-26.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.127: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-27"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-27.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.128: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-28"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-28.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.129: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-29"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-29.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.130: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-30"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-30.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.131: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-31"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-31.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.132: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-32"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-32.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.133: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-33"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-33.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.134: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-34"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-34.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.135: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-35"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-35.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.136: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-36"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-36.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.137: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-37"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-37.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.138: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-38"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-38.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.139: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-39"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-39.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.140: FIGURE B9.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-244-40"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-244-40.png" alt="FIGURE B9." width="672" />
<p class="caption">
Figure 3.141: FIGURE B9.
</p>
</div>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb401-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb401-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb401-2" tabindex="-1"></a><span class="fu">save_comb_hist</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix =</span> <span class="st">&quot;model_b&quot;</span>)</span>
<span id="cb401-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb401-3" tabindex="-1"></a><span class="fu">save_comb_loveplots</span>(comb_meth.cps_plus, comb_meth.psid_plus, <span class="st">&quot;treat&quot;</span>, covar, <span class="at">prefix =</span> <span class="st">&quot;model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="top-methods-and-datasets-1" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Top methods and datasets<a href="lalonde-dehejia-wahba-ldw-data-1.html#top-methods-and-datasets-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb402-1" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb402-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb402-2" tabindex="-1"></a>all_cps_plus <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;cps_plus&quot;</span>)</span>
<span id="cb402-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb402-3" tabindex="-1"></a>all_psid_plus <span class="ot">&lt;-</span> <span class="fu">combine_results</span>(<span class="st">&quot;psid_plus&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb403-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb403-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb403-2" tabindex="-1"></a><span class="fu">save_csv</span>(all_cps_plus, <span class="st">&quot;CPS1_PLUS_all_results_model_b&quot;</span>)</span>
<span id="cb403-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb403-3" tabindex="-1"></a><span class="fu">save_csv</span>(all_psid_plus, <span class="st">&quot;PSID1_PLUS_all_results_model_b&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb404-1" tabindex="-1"></a><span class="co"># rank methods </span></span>
<span id="cb404-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb404-2" tabindex="-1"></a>ranked_cps_plus  <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_cps_plus)</span>
<span id="cb404-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb404-3" tabindex="-1"></a>ranked_psid_plus <span class="ot">&lt;-</span> <span class="fu">assess_methods</span>(all_psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-1" tabindex="-1"></a><span class="co"># get top 5 methods </span></span>
<span id="cb405-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-2" tabindex="-1"></a>top5_methods.cps_plus <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_cps_plus, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb405-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-3" tabindex="-1"></a>top5_methods.psid_plus <span class="ot">&lt;-</span> <span class="fu">get_top_methods</span>(ranked_psid_plus, <span class="at">top_n =</span> <span class="dv">5</span>)</span>
<span id="cb405-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-4" tabindex="-1"></a></span>
<span id="cb405-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-5" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb405-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-6" tabindex="-1"></a>top5_methods_df.cps_plus <span class="ot">&lt;-</span> ranked_cps_plus <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb405-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-7" tabindex="-1"></a>top5_methods_df.psid_plus <span class="ot">&lt;-</span> ranked_psid_plus <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb405-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb405-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top5_methods_df.cps_plus, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for CPS1-PLUS&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-249">Table 3.4: </span>Top 5 Methods for CPS1-PLUS</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mahvars</td>
<td align="right">0.7340485</td>
</tr>
<tr class="even">
<td align="left">card</td>
<td align="right">0.7325957</td>
</tr>
<tr class="odd">
<td align="left">overlap_crump</td>
<td align="right">0.7101653</td>
</tr>
<tr class="even">
<td align="left">ps_threshold</td>
<td align="right">0.6939340</td>
</tr>
<tr class="odd">
<td align="left">optimal_pair</td>
<td align="right">0.6896214</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb406-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top5_methods_df.psid_plus, <span class="at">caption =</span> <span class="st">&quot;Top 5 Methods for PSID1-PLUS&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-249">Table 3.4: </span>Top 5 Methods for PSID1-PLUS</caption>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">card</td>
<td align="right">0.7566410</td>
</tr>
<tr class="even">
<td align="left">mahvars</td>
<td align="right">0.7461287</td>
</tr>
<tr class="odd">
<td align="left">ps_threshold</td>
<td align="right">0.7267397</td>
</tr>
<tr class="even">
<td align="left">fix_max_value_trunc_overlap_weight</td>
<td align="right">0.7235709</td>
</tr>
<tr class="odd">
<td align="left">overlap_weight</td>
<td align="right">0.7235709</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb407-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb407-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb407-2" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.cps_plus, <span class="st">&quot;CPS1_PLUS_top5_methods_model_b&quot;</span>)</span>
<span id="cb407-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb407-3" tabindex="-1"></a><span class="fu">save_csv</span>(top5_methods.psid_plus, <span class="st">&quot;PSID1_PLUS_top5_methods_model_b&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-1" tabindex="-1"></a>dataset_list_cps <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb408-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-2" tabindex="-1"></a>  <span class="st">&quot;All&quot;</span> <span class="ot">=</span> ldw_cps_plus,</span>
<span id="cb408-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-3" tabindex="-1"></a>  <span class="st">&quot;original&quot;</span> <span class="ot">=</span> ldw_cps_plus,</span>
<span id="cb408-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-4" tabindex="-1"></a>  <span class="st">&quot;nn&quot;</span> <span class="ot">=</span> m.out.cps_plus.nearest, </span>
<span id="cb408-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-5" tabindex="-1"></a>  <span class="st">&quot;caliper&quot;</span> <span class="ot">=</span> m.out.cps_plus.caliper,</span>
<span id="cb408-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-6" tabindex="-1"></a>  <span class="st">&quot;card&quot;</span> <span class="ot">=</span> m.out.cps_plus.card,</span>
<span id="cb408-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-7" tabindex="-1"></a>  <span class="st">&quot;cem&quot;</span> <span class="ot">=</span> m.out.cps_plus.cem,</span>
<span id="cb408-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-8" tabindex="-1"></a>  <span class="st">&quot;cS&quot;</span> <span class="ot">=</span> m.out.cps_plus.cs,</span>
<span id="cb408-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-9" tabindex="-1"></a>  <span class="st">&quot;k2&quot;</span>  <span class="ot">=</span> m.out.cps_plus.k2,</span>
<span id="cb408-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-10" tabindex="-1"></a>  <span class="st">&quot;k3&quot;</span> <span class="ot">=</span> m.out.cps_plus.k3,</span>
<span id="cb408-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-11" tabindex="-1"></a>  <span class="st">&quot;mahvars&quot;</span> <span class="ot">=</span> m.out.cps_plus.mahvars,</span>
<span id="cb408-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-12" tabindex="-1"></a>  <span class="st">&quot;optimal_full&quot;</span> <span class="ot">=</span> m.out.cps_plus.optimal_full,</span>
<span id="cb408-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-13" tabindex="-1"></a>  <span class="st">&quot;optimal_pair&quot;</span> <span class="ot">=</span> m.out.cps_plus.optimal_pair,</span>
<span id="cb408-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-14" tabindex="-1"></a>  <span class="st">&quot;gen_full&quot;</span> <span class="ot">=</span> m.out.cps_plus.general_full,</span>
<span id="cb408-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-15" tabindex="-1"></a>  <span class="st">&quot;genetic&quot;</span> <span class="ot">=</span> m.out.cps_plus.genetic,</span>
<span id="cb408-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-16" tabindex="-1"></a>  <span class="st">&quot;exact&quot;</span> <span class="ot">=</span> m.out.cps_plus.exact,</span>
<span id="cb408-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-17" tabindex="-1"></a>  <span class="st">&quot;subcl&quot;</span> <span class="ot">=</span> m.out.cps_plus.subcl,</span>
<span id="cb408-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-18" tabindex="-1"></a>  <span class="st">&quot;profile&quot;</span>  <span class="ot">=</span> m.out.cps_plus.profile,</span>
<span id="cb408-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-19" tabindex="-1"></a>  <span class="st">&quot;ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>ipw_weight, </span>
<span id="cb408-20"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-20" tabindex="-1"></a>  <span class="st">&quot;smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb408-21"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-21" tabindex="-1"></a>  <span class="st">&quot;opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb408-22"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-22" tabindex="-1"></a>  <span class="st">&quot;overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb408-23"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-23" tabindex="-1"></a>  <span class="st">&quot;ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus<span class="sc">$</span>ebal_weight, </span>
<span id="cb408-24"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-24" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb408-25"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-25" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb408-26"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-26" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb408-27"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-27" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb408-28"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-28" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.fixed,</span>
<span id="cb408-29"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-29" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb408-30"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-30" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ipw_weight&quot;</span>  <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb408-31"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-31" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_opt_weight&quot;</span>  <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb408-32"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-32" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb408-33"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-33" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.percent,</span>
<span id="cb408-34"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-34" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb408-35"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-35" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb408-36"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-36" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb408-37"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-37" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb408-38"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-38" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_cps_plus.adapt,</span>
<span id="cb408-39"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-39" tabindex="-1"></a>  <span class="st">&quot;ps_threshold&quot;</span> <span class="ot">=</span> ldw_cps.trim_match,</span>
<span id="cb408-40"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-40" tabindex="-1"></a>  <span class="st">&quot;common_range&quot;</span> <span class="ot">=</span> ldw_cps_plus.common,</span>
<span id="cb408-41"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-41" tabindex="-1"></a>  <span class="st">&quot;stuermer&quot;</span> <span class="ot">=</span> ldw_cps_plus.stuermer,</span>
<span id="cb408-42"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-42" tabindex="-1"></a>  <span class="st">&quot;walker&quot;</span> <span class="ot">=</span> ldw_cps_plus.walker,</span>
<span id="cb408-43"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-43" tabindex="-1"></a>  <span class="st">&quot;crump&quot;</span> <span class="ot">=</span> ldw_cps_plus.crump,</span>
<span id="cb408-44"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-44" tabindex="-1"></a>  <span class="st">&quot;ipw_common_range&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-45"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-45" tabindex="-1"></a>  <span class="st">&quot;ipw_crump&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-46"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-46" tabindex="-1"></a>  <span class="st">&quot;ipw_ps_threshold&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-47"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-47" tabindex="-1"></a>  <span class="st">&quot;ipw_stuermer&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-48"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-48" tabindex="-1"></a>  <span class="st">&quot;ipw_walker&quot;</span> <span class="ot">=</span> ipw_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-49"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-49" tabindex="-1"></a>  <span class="st">&quot;smr_treated_common_range&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-50"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-50" tabindex="-1"></a>  <span class="st">&quot;smr_treated_crump&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-51"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-51" tabindex="-1"></a>  <span class="st">&quot;smr_treated_ps_threshold&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-52"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-52" tabindex="-1"></a>  <span class="st">&quot;smr_treated_stuermer&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-53"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-53" tabindex="-1"></a>  <span class="st">&quot;smr_treated_walker&quot;</span> <span class="ot">=</span> smr_treat_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-54"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-54" tabindex="-1"></a>  <span class="st">&quot;overlap_common_range&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-55"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-55" tabindex="-1"></a>  <span class="st">&quot;overlap_crump&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-56"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-56" tabindex="-1"></a>  <span class="st">&quot;overlap_ps_threshold&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-57"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-57" tabindex="-1"></a>  <span class="st">&quot;overlap_stuermer&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-58"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-58" tabindex="-1"></a>  <span class="st">&quot;overlap_walker&quot;</span> <span class="ot">=</span> ov_comb.cps_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-59"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-59" tabindex="-1"></a>  <span class="st">&quot;entropy_common_range&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-60"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-60" tabindex="-1"></a>  <span class="st">&quot;entropy_crump&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-61"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-61" tabindex="-1"></a>  <span class="st">&quot;entropy_ps_threshold&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-62"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-62" tabindex="-1"></a>  <span class="st">&quot;entropy_stuermer&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-63"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-63" tabindex="-1"></a>  <span class="st">&quot;entropy_walker&quot;</span> <span class="ot">=</span> entropy_comb.cps_plus[[<span class="dv">5</span>]])</span>
<span id="cb408-64"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-64" tabindex="-1"></a></span>
<span id="cb408-65"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-65" tabindex="-1"></a>dataset_list_psid <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb408-66"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-66" tabindex="-1"></a>  <span class="st">&quot;All&quot;</span> <span class="ot">=</span> ldw_psid_plus, </span>
<span id="cb408-67"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-67" tabindex="-1"></a>  <span class="st">&quot;original&quot;</span> <span class="ot">=</span> ldw_psid_plus, </span>
<span id="cb408-68"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-68" tabindex="-1"></a>  <span class="st">&quot;nn&quot;</span> <span class="ot">=</span> m.out.psid_plus.nearest, </span>
<span id="cb408-69"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-69" tabindex="-1"></a>  <span class="st">&quot;caliper&quot;</span><span class="ot">=</span> m.out.psid_plus.caliper,</span>
<span id="cb408-70"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-70" tabindex="-1"></a>  <span class="st">&quot;card&quot;</span> <span class="ot">=</span> m.out.psid_plus.card,</span>
<span id="cb408-71"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-71" tabindex="-1"></a>  <span class="st">&quot;cem&quot;</span> <span class="ot">=</span> m.out.psid_plus.cem,</span>
<span id="cb408-72"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-72" tabindex="-1"></a>  <span class="st">&quot;cS&quot;</span> <span class="ot">=</span> m.out.psid_plus.cs,</span>
<span id="cb408-73"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-73" tabindex="-1"></a>  <span class="st">&quot;k2&quot;</span> <span class="ot">=</span> m.out.psid_plus.k2,</span>
<span id="cb408-74"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-74" tabindex="-1"></a>  <span class="st">&quot;k3&quot;</span> <span class="ot">=</span> m.out.psid_plus.k3,</span>
<span id="cb408-75"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-75" tabindex="-1"></a>  <span class="st">&quot;mahvars&quot;</span> <span class="ot">=</span> m.out.psid_plus.mahvars,</span>
<span id="cb408-76"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-76" tabindex="-1"></a>  <span class="st">&quot;optimal_full&quot;</span> <span class="ot">=</span> m.out.psid_plus.optimal_full,</span>
<span id="cb408-77"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-77" tabindex="-1"></a>  <span class="st">&quot;optimal_pair&quot;</span> <span class="ot">=</span> m.out.psid_plus.optimal_pair,</span>
<span id="cb408-78"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-78" tabindex="-1"></a>  <span class="st">&quot;gen_full&quot;</span> <span class="ot">=</span> m.out.psid_plus.general_full,</span>
<span id="cb408-79"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-79" tabindex="-1"></a>  <span class="st">&quot;genetic&quot;</span> <span class="ot">=</span> m.out.psid_plus.genetic,</span>
<span id="cb408-80"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-80" tabindex="-1"></a>  <span class="st">&quot;exact&quot;</span> <span class="ot">=</span> m.out.psid_plus.exact,</span>
<span id="cb408-81"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-81" tabindex="-1"></a>  <span class="st">&quot;subcl&quot;</span> <span class="ot">=</span> m.out.psid_plus.subcl,</span>
<span id="cb408-82"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-82" tabindex="-1"></a>  <span class="st">&quot;profile&quot;</span> <span class="ot">=</span> m.out.psid_plus.profile,</span>
<span id="cb408-83"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-83" tabindex="-1"></a>  <span class="st">&quot;ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>ipw_weight, </span>
<span id="cb408-84"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-84" tabindex="-1"></a>  <span class="st">&quot;smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>smr_weight,</span>
<span id="cb408-85"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-85" tabindex="-1"></a>  <span class="st">&quot;opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>opt_weight,</span>
<span id="cb408-86"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-86" tabindex="-1"></a>  <span class="st">&quot;overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>overlap_weight,</span>
<span id="cb408-87"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-87" tabindex="-1"></a>  <span class="st">&quot;ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus<span class="sc">$</span>ebal_weight,</span>
<span id="cb408-88"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-88" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb408-89"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-89" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb408-90"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-90" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb408-91"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-91" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb408-92"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-92" tabindex="-1"></a>  <span class="st">&quot;fix_max_value_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.fixed,</span>
<span id="cb408-93"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-93" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb408-94"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-94" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb408-95"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-95" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb408-96"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-96" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb408-97"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-97" tabindex="-1"></a>  <span class="st">&quot;at_perc_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.percent,</span>
<span id="cb408-98"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-98" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ebal_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb408-99"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-99" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_ipw_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb408-100"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-100" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_opt_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb408-101"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-101" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_overlap_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb408-102"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-102" tabindex="-1"></a>  <span class="st">&quot;adap_weight_trunc_smr_weight&quot;</span> <span class="ot">=</span> ldw_psid_plus.adapt,</span>
<span id="cb408-103"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-103" tabindex="-1"></a>  <span class="st">&quot;ps_threshold&quot;</span> <span class="ot">=</span> ldw_psid.trim_match,</span>
<span id="cb408-104"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-104" tabindex="-1"></a>  <span class="st">&quot;common_range&quot;</span> <span class="ot">=</span> ldw_psid_plus.common,</span>
<span id="cb408-105"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-105" tabindex="-1"></a>  <span class="st">&quot;stuermer&quot;</span> <span class="ot">=</span> ldw_psid_plus.stuermer,</span>
<span id="cb408-106"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-106" tabindex="-1"></a>  <span class="st">&quot;walker&quot;</span> <span class="ot">=</span> ldw_psid_plus.walker,</span>
<span id="cb408-107"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-107" tabindex="-1"></a>  <span class="st">&quot;crump&quot;</span> <span class="ot">=</span> ldw_psid_plus.crump,</span>
<span id="cb408-108"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-108" tabindex="-1"></a>  <span class="st">&quot;ipw_common_range&quot;</span> <span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-109"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-109" tabindex="-1"></a>  <span class="st">&quot;ipw_crump&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-110"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-110" tabindex="-1"></a>  <span class="st">&quot;ipw_ps_threshold&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-111"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-111" tabindex="-1"></a>  <span class="st">&quot;ipw_stuermer&quot;</span><span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-112"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-112" tabindex="-1"></a>  <span class="st">&quot;ipw_walker&quot;</span> <span class="ot">=</span> ipw_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-113"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-113" tabindex="-1"></a>  <span class="st">&quot;smr_treated_common_range&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-114"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-114" tabindex="-1"></a>  <span class="st">&quot;smr_treated_crump&quot;</span><span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-115"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-115" tabindex="-1"></a>  <span class="st">&quot;smr_treated_ps_threshold&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-116"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-116" tabindex="-1"></a>  <span class="st">&quot;smr_treated_stuermer&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-117"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-117" tabindex="-1"></a>  <span class="st">&quot;smr_treated_walker&quot;</span> <span class="ot">=</span> smr_treat_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-118"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-118" tabindex="-1"></a>  <span class="st">&quot;overlap_common_range&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-119"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-119" tabindex="-1"></a>  <span class="st">&quot;overlap_crump&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-120"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-120" tabindex="-1"></a>  <span class="st">&quot;overlap_ps_threshold&quot;</span>  <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-121"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-121" tabindex="-1"></a>  <span class="st">&quot;overlap_stuermer&quot;</span> <span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-122"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-122" tabindex="-1"></a>  <span class="st">&quot;overlap_walker&quot;</span><span class="ot">=</span> ov_comb.psid_plus[[<span class="dv">5</span>]],</span>
<span id="cb408-123"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-123" tabindex="-1"></a>  <span class="st">&quot;entropy_common_range&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">1</span>]],</span>
<span id="cb408-124"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-124" tabindex="-1"></a>  <span class="st">&quot;entropy_crump&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">2</span>]],</span>
<span id="cb408-125"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-125" tabindex="-1"></a>  <span class="st">&quot;entropy_ps_threshold&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">3</span>]],</span>
<span id="cb408-126"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-126" tabindex="-1"></a>  <span class="st">&quot;entropy_stuermer&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">4</span>]],</span>
<span id="cb408-127"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb408-127" tabindex="-1"></a>  <span class="st">&quot;entropy_walker&quot;</span> <span class="ot">=</span> entropy_comb.psid_plus[[<span class="dv">5</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb409-1" tabindex="-1"></a><span class="co"># create datasets corresponding to the top 5 methods for each dataset</span></span>
<span id="cb409-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb409-2" tabindex="-1"></a>top5_datasets.cps_plus <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(dataset_list_cps, top5_methods.cps_plus)</span>
<span id="cb409-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb409-3" tabindex="-1"></a>top5_datasets.psid_plus <span class="ot">&lt;-</span> <span class="fu">create_top5_datasets</span>(dataset_list_psid, top5_methods.psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb410-1" tabindex="-1"></a><span class="co"># save datasets into .RData files</span></span>
<span id="cb410-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb410-2" tabindex="-1"></a><span class="fu">save_top5_individual_files</span>(dataset_list_cps, top5_methods.cps_plus, <span class="at">prefix =</span> <span class="st">&quot;model_b_cps&quot;</span>)</span>
<span id="cb410-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb410-3" tabindex="-1"></a><span class="fu">save_top5_individual_files</span>(dataset_list_psid, top5_methods.psid_plus, <span class="at">prefix =</span> <span class="st">&quot;model_b_psid&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="estimating-2" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Estimating<a href="lalonde-dehejia-wahba-ldw-data-1.html#estimating-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-treatment-effect-on-the-treated-att-1" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Average treatment effect on the treated (ATT)<a href="lalonde-dehejia-wahba-ldw-data-1.html#average-treatment-effect-on-the-treated-att-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-1" tabindex="-1"></a><span class="co"># estimate ATT</span></span>
<span id="cb411-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-2" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb411-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-3" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb411-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-4" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb411-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-5" tabindex="-1"></a>out4 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps.trim_match, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar) </span>
<span id="cb411-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-6" tabindex="-1"></a>out5 <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid.trim_match, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar)</span>
<span id="cb411-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-7" tabindex="-1"></a></span>
<span id="cb411-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-8" tabindex="-1"></a>out.cps_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb411-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-9" tabindex="-1"></a>out.psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, <span class="st">&quot;re78&quot;</span>, <span class="st">&quot;treat&quot;</span>, covar))</span>
<span id="cb411-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-10" tabindex="-1"></a>out6 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">1</span>]]</span>
<span id="cb411-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-11" tabindex="-1"></a>out7 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">2</span>]]</span>
<span id="cb411-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-12" tabindex="-1"></a>out8 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">3</span>]]</span>
<span id="cb411-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-13" tabindex="-1"></a>out9 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">4</span>]]</span>
<span id="cb411-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-14" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out.cps_plus[[<span class="dv">5</span>]]</span>
<span id="cb411-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-15" tabindex="-1"></a>out11 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">1</span>]]</span>
<span id="cb411-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-16" tabindex="-1"></a>out12 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">2</span>]]</span>
<span id="cb411-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-17" tabindex="-1"></a>out13 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">3</span>]]</span>
<span id="cb411-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-18" tabindex="-1"></a>out14 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">4</span>]]</span>
<span id="cb411-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb411-19" tabindex="-1"></a>out15 <span class="ot">&lt;-</span> out.psid_plus[[<span class="dv">5</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-1" tabindex="-1"></a><span class="co"># build plot titles </span></span>
<span id="cb412-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-2" tabindex="-1"></a>base_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;(A) LDW-Experimental&quot;</span>, <span class="st">&quot;(B) LDW-CPS1&quot;</span> , <span class="st">&quot;(C) LDW-PSID1&quot;</span>, <span class="st">&quot;(D) Trimmed LDW-CPS1 &quot;</span>, <span class="st">&quot;(E) Trimmed LDW-PSID1&quot;</span>)</span>
<span id="cb412-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-3" tabindex="-1"></a>top_start <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># F is 6th letter</span></span>
<span id="cb412-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-4" tabindex="-1"></a>num_cps <span class="ot">&lt;-</span> <span class="fu">length</span>(top5_methods.cps_plus)</span>
<span id="cb412-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-5" tabindex="-1"></a>num_psid <span class="ot">&lt;-</span> <span class="fu">length</span>(top5_methods.psid_plus)</span>
<span id="cb412-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-6" tabindex="-1"></a>top_letters_cps <span class="ot">&lt;-</span> LETTERS[top_start<span class="sc">:</span>(top_start <span class="sc">+</span> num_cps <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb412-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-7" tabindex="-1"></a>top_letters_psid <span class="ot">&lt;-</span> LETTERS[(top_start <span class="sc">+</span> num_cps)<span class="sc">:</span>(top_start <span class="sc">+</span> num_cps <span class="sc">+</span> num_psid <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb412-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-8" tabindex="-1"></a>top5_titles.cps_plus <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, top_letters_cps, <span class="st">&quot;) Top CPS1: &quot;</span>, top5_methods.cps_plus)</span>
<span id="cb412-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-9" tabindex="-1"></a>top5_titles.psid_plus <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, top_letters_psid, <span class="st">&quot;) Top PSID1: &quot;</span>, top5_methods.psid_plus)</span>
<span id="cb412-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-10" tabindex="-1"></a>plot_titles <span class="ot">&lt;-</span> <span class="fu">c</span>(base_titles, top5_titles.cps_plus, top5_titles.psid_plus)</span>
<span id="cb412-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-11" tabindex="-1"></a></span>
<span id="cb412-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-12" tabindex="-1"></a><span class="co"># combine all results</span></span>
<span id="cb412-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb412-13" tabindex="-1"></a>all_outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1, out2, out3, out4, out5), out.cps_plus, out.psid_plus)</span></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb413-1" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb413-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb413-2" tabindex="-1"></a>band <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb413-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb413-3" tabindex="-1"></a>est  <span class="ot">&lt;-</span> out1[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb413-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb413-4" tabindex="-1"></a><span class="fu">plot_att_panels</span>(all_outs, plot_titles, band, est, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>), <span class="at">textsize =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-256-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-256-1.png" alt="FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.142: FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-256-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-256-2.png" alt="FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.143: FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-256-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-256-3.png" alt="FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.144: FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-256-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-256-4.png" alt="FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples" width="100%" />
<p class="caption">
Figure 3.145: FIGURE B10. ATT Estimates Model B Given Unconfoundedness using LDW Samples
</p>
</div>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb414-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb414-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb414-2" tabindex="-1"></a><span class="fu">save_att_panels</span>(all_outs, plot_titles, band, est, <span class="st">&quot;model_b&quot;</span>)</span></code></pre></div>
<p>As in model A, the above figures show the ATT estimates and their 95% confidence intervals for fifteen samples: LDW-Experimental, LDW-CPS1, LDW-PSID1, trimmed versions of the LDW-CPS1 and LDW-PSID1 samples (analogous to <span class="citation">Imbens and Xu (<a href="#ref-imbens2024">2024</a>)</span>) and a series of top-ranked subsamples of both LDW-CPS1 and LDW-PSID1 based on various matching, weighting, truncation and trimming criteria.</p>
<p>Again, figure (A) presents the benchmark, serving as a reference for bias and variance assessment of observational samples. Figures (B) and (C) show results for the LDW-CPS1 and LDW-PSID1y, while figures (D) and (E) present those for the trimmed versions. Figures (F) through (J) display results for CPS1-derived subsamples constructed with the top-ranked methods. Analogously, figures (K) through (O) summarize results for the corresponding PSID1-derived subsamples under parallel rules.</p>
<p>For LDW-CPS1, the top-ranked subsamples are derived with the same methods as in model A, though they appear in a slightly different order. However, for the LDW-PSID1, the top-ranked subsamples are based on two different methods, <code>fix_max_value_trunc_overlap_weight</code> and <code>overlap_weight</code>.</p>
<p>Across the LDW-CPS1 and its top-ranked samples, all estimators generally yield ATT estimates that cluster near the experimental benchmark, overall slightly closer than in model A but with greater standard errors. Notable deviations from the experimental benchmark remain for the <code>optimal_pair</code> and <code>overlap_crump</code> subsamples.</p>
<p>For LDW-PSID1 and its subsamples, the ATT estimates continue to exhibit greater dispersion and considerably larger standard errors compared to LDW-CPS1 counterpart samples, yet they lie closer to the benchmark than in model A.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb415-1" tabindex="-1"></a><span class="co"># prepare all results in the order shown in the plots</span></span>
<span id="cb415-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb415-2" tabindex="-1"></a>all_summaries <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_outs, eval_att)</span>
<span id="cb415-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb415-3" tabindex="-1"></a>att_summary <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, all_summaries)</span>
<span id="cb415-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb415-4" tabindex="-1"></a><span class="fu">rownames</span>(att_summary) <span class="ot">&lt;-</span> plot_titles</span>
<span id="cb415-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb415-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(att_summary, <span class="at">caption =</span> <span class="st">&quot;ATT Summary Statistics&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-258">Table 3.5: </span>ATT Summary Statistics</caption>
<colgroup>
<col width="50%" />
<col width="10%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean_SE</th>
<th align="right">Min_Estimate</th>
<th align="right">Max_Estimate</th>
<th align="right">Diff_Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">673.0190</td>
<td align="right">1583.55441</td>
<td align="right">2228.37274</td>
<td align="right">644.8183</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">670.8516</td>
<td align="right">-8497.51615</td>
<td align="right">1591.48975</td>
<td align="right">10089.0059</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">878.2394</td>
<td align="right">-15204.77742</td>
<td align="right">2424.45272</td>
<td align="right">17629.2301</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">817.4108</td>
<td align="right">943.22214</td>
<td align="right">2079.09168</td>
<td align="right">1135.8695</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">1124.4889</td>
<td align="right">-1984.81640</td>
<td align="right">-726.28718</td>
<td align="right">1258.5292</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: mahvars</td>
<td align="right">533.9464</td>
<td align="right">439.59826</td>
<td align="right">878.13313</td>
<td align="right">438.5349</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: card</td>
<td align="right">480.2842</td>
<td align="right">468.44377</td>
<td align="right">1186.75803</td>
<td align="right">718.3143</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: overlap_crump</td>
<td align="right">479.4121</td>
<td align="right">-3654.18460</td>
<td align="right">536.10279</td>
<td align="right">4190.2874</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: ps_threshold</td>
<td align="right">817.4266</td>
<td align="right">934.66402</td>
<td align="right">2079.09168</td>
<td align="right">1144.4277</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">460.4078</td>
<td align="right">-43.19702</td>
<td align="right">774.12991</td>
<td align="right">817.3269</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">912.7812</td>
<td align="right">-1208.76339</td>
<td align="right">38.97256</td>
<td align="right">1247.7359</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">912.7672</td>
<td align="right">-2321.92141</td>
<td align="right">-1320.75878</td>
<td align="right">1001.1626</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">1124.2991</td>
<td align="right">-1984.81640</td>
<td align="right">-726.28718</td>
<td align="right">1258.5292</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: fix_max_value_trunc_overlap_weight</td>
<td align="right">686.5378</td>
<td align="right">-16253.15724</td>
<td align="right">1863.97116</td>
<td align="right">18117.1284</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_weight</td>
<td align="right">675.2322</td>
<td align="right">-16253.15724</td>
<td align="right">1863.97116</td>
<td align="right">18117.1284</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb416-1" tabindex="-1"></a><span class="co"># get result matrix</span></span>
<span id="cb416-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb416-2" tabindex="-1"></a>result_mat <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs, plot_titles)</span>
<span id="cb416-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb416-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result_mat, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">&quot;ATT Estimates and SEs&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-259">Table 3.6: </span>ATT Estimates and SEs</caption>
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="9%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">(A) LDW-Experimental</th>
<th align="left"></th>
<th align="left">(B) LDW-CPS1</th>
<th align="left"></th>
<th align="left">(C) LDW-PSID1</th>
<th align="left"></th>
<th align="left">(D) Trimmed LDW-CPS1</th>
<th align="left"></th>
<th align="left">(E) Trimmed LDW-PSID1</th>
<th align="left"></th>
<th align="left">(F) Top CPS1: mahvars</th>
<th align="left"></th>
<th align="left">(G) Top CPS1: card</th>
<th align="left"></th>
<th align="left">(H) Top CPS1: overlap_crump</th>
<th align="left"></th>
<th align="left">(I) Top CPS1: ps_threshold</th>
<th align="left"></th>
<th align="left">(J) Top CPS1: optimal_pair</th>
<th align="left"></th>
<th align="left">(K) Top PSID1: card</th>
<th align="left"></th>
<th align="left">(L) Top PSID1: mahvars</th>
<th align="left"></th>
<th align="left">(M) Top PSID1: ps_threshold</th>
<th align="left"></th>
<th align="left">(N) Top PSID1: fix_max_value_trunc_overlap_weight</th>
<th align="left"></th>
<th align="left">(O) Top PSID1: overlap_weight</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Experimental Benchmark</td>
<td align="left">1794.34</td>
<td align="left">(670.82)</td>
<td align="left">-8497.52</td>
<td align="left">(581.92)</td>
<td align="left">-15204.78</td>
<td align="left">(655.91)</td>
<td align="left">1466.69</td>
<td align="left">(827.73)</td>
<td align="left">-1870.71</td>
<td align="left">(1183.54)</td>
<td align="left">645.19</td>
<td align="left">(544.37)</td>
<td align="left">468.44</td>
<td align="left">(467.88)</td>
<td align="left">-3654.18</td>
<td align="left">(339.88)</td>
<td align="left">1466.69</td>
<td align="left">(827.73)</td>
<td align="left">-43.20</td>
<td align="left">(438.92)</td>
<td align="left">-508.12</td>
<td align="left">(972.27)</td>
<td align="left">-1966.48</td>
<td align="left">(990.23)</td>
<td align="left">-1870.71</td>
<td align="left">(1183.54)</td>
<td align="left">-16253.16</td>
<td align="left">(442.57)</td>
<td align="left">-16253.16</td>
<td align="left">(442.57)</td>
</tr>
<tr class="even">
<td align="left">diff</td>
<td align="left">1794.34</td>
<td align="left">(670.82)</td>
<td align="left">-8497.52</td>
<td align="left">(581.92)</td>
<td align="left">-15204.78</td>
<td align="left">(655.91)</td>
<td align="left">1466.69</td>
<td align="left">(827.73)</td>
<td align="left">-1870.71</td>
<td align="left">(1183.54)</td>
<td align="left">645.19</td>
<td align="left">(544.37)</td>
<td align="left">468.44</td>
<td align="left">(467.88)</td>
<td align="left">-3654.18</td>
<td align="left">(339.88)</td>
<td align="left">1466.69</td>
<td align="left">(827.73)</td>
<td align="left">-43.20</td>
<td align="left">(438.92)</td>
<td align="left">-508.12</td>
<td align="left">(972.27)</td>
<td align="left">-1966.48</td>
<td align="left">(990.23)</td>
<td align="left">-1870.71</td>
<td align="left">(1183.54)</td>
<td align="left">-16253.16</td>
<td align="left">(442.57)</td>
<td align="left">-16253.16</td>
<td align="left">(442.57)</td>
</tr>
<tr class="odd">
<td align="left">reg</td>
<td align="left">1605.52</td>
<td align="left">(665.93)</td>
<td align="left">1484.61</td>
<td align="left">(631.51)</td>
<td align="left">1227.70</td>
<td align="left">(892.77)</td>
<td align="left">1818.38</td>
<td align="left">(858.86)</td>
<td align="left">-1609.82</td>
<td align="left">(1081.50)</td>
<td align="left">685.59</td>
<td align="left">(521.98)</td>
<td align="left">610.54</td>
<td align="left">(450.71)</td>
<td align="left">-73.00</td>
<td align="left">(406.43)</td>
<td align="left">1818.38</td>
<td align="left">(858.86)</td>
<td align="left">439.83</td>
<td align="left">(454.63)</td>
<td align="left">-184.58</td>
<td align="left">(826.61)</td>
<td align="left">-1634.36</td>
<td align="left">(893.10)</td>
<td align="left">-1609.82</td>
<td align="left">(1081.50)</td>
<td align="left">-191.13</td>
<td align="left">(720.76)</td>
<td align="left">-191.13</td>
<td align="left">(720.76)</td>
</tr>
<tr class="even">
<td align="left">om.reg</td>
<td align="left">1709.79</td>
<td align="left">(587.92)</td>
<td align="left">1553.68</td>
<td align="left">(621.16)</td>
<td align="left">2052.84</td>
<td align="left">(644.01)</td>
<td align="left">1642.27</td>
<td align="left">(665.91)</td>
<td align="left">-726.29</td>
<td align="left">(966.76)</td>
<td align="left">826.69</td>
<td align="left">(442.69)</td>
<td align="left">748.68</td>
<td align="left">(383.40)</td>
<td align="left">70.60</td>
<td align="left">(341.86)</td>
<td align="left">1642.27</td>
<td align="left">(665.91)</td>
<td align="left">680.25</td>
<td align="left">(342.85)</td>
<td align="left">-46.64</td>
<td align="left">(584.02)</td>
<td align="left">-1320.76</td>
<td align="left">(739.29)</td>
<td align="left">-726.29</td>
<td align="left">(966.76)</td>
<td align="left">1116.83</td>
<td align="left">(362.05)</td>
<td align="left">1116.83</td>
<td align="left">(362.05)</td>
</tr>
<tr class="odd">
<td align="left">om.grf</td>
<td align="left">1728.97</td>
<td align="left">(582.14)</td>
<td align="left">1164.55</td>
<td align="left">(625.47)</td>
<td align="left">449.34</td>
<td align="left">(636.41)</td>
<td align="left">1729.56</td>
<td align="left">(653.40)</td>
<td align="left">-1467.28</td>
<td align="left">(782.27)</td>
<td align="left">723.39</td>
<td align="left">(435.27)</td>
<td align="left">828.85</td>
<td align="left">(367.12)</td>
<td align="left">195.09</td>
<td align="left">(343.18)</td>
<td align="left">1728.14</td>
<td align="left">(652.98)</td>
<td align="left">429.55</td>
<td align="left">(333.22)</td>
<td align="left">-439.68</td>
<td align="left">(538.88)</td>
<td align="left">-1936.52</td>
<td align="left">(606.72)</td>
<td align="left">-1410.88</td>
<td align="left">(780.00)</td>
<td align="left">-343.91</td>
<td align="left">(353.52)</td>
<td align="left">-380.97</td>
<td align="left">(352.10)</td>
</tr>
<tr class="even">
<td align="left">matching</td>
<td align="left">1583.55</td>
<td align="left">(785.15)</td>
<td align="left">1591.49</td>
<td align="left">(832.21)</td>
<td align="left">2174.97</td>
<td align="left">(1575.49)</td>
<td align="left">1862.82</td>
<td align="left">(979.63)</td>
<td align="left">-1349.74</td>
<td align="left">(1230.15)</td>
<td align="left">878.13</td>
<td align="left">(627.58)</td>
<td align="left">492.99</td>
<td align="left">(647.89)</td>
<td align="left">536.10</td>
<td align="left">(637.64)</td>
<td align="left">1862.82</td>
<td align="left">(979.63)</td>
<td align="left">667.85</td>
<td align="left">(626.84)</td>
<td align="left">38.97</td>
<td align="left">(930.07)</td>
<td align="left">-1495.33</td>
<td align="left">(973.79)</td>
<td align="left">-1349.74</td>
<td align="left">(1230.15)</td>
<td align="left">1519.05</td>
<td align="left">(1274.41)</td>
<td align="left">1519.05</td>
<td align="left">(1274.41)</td>
</tr>
<tr class="odd">
<td align="left">psm</td>
<td align="left">2228.37</td>
<td align="left">(680.68)</td>
<td align="left">1315.42</td>
<td align="left">(723.13)</td>
<td align="left">1384.63</td>
<td align="left">(860.32)</td>
<td align="left">943.22</td>
<td align="left">(823.60)</td>
<td align="left">-1984.82</td>
<td align="left">(1211.11)</td>
<td align="left">439.60</td>
<td align="left">(557.22)</td>
<td align="left">1186.76</td>
<td align="left">(448.82)</td>
<td align="left">184.41</td>
<td align="left">(423.25)</td>
<td align="left">934.66</td>
<td align="left">(824.20)</td>
<td align="left">584.73</td>
<td align="left">(418.10)</td>
<td align="left">-1208.76</td>
<td align="left">(1154.82)</td>
<td align="left">-1342.83</td>
<td align="left">(903.00)</td>
<td align="left">-1984.82</td>
<td align="left">(1211.11)</td>
<td align="left">1415.01</td>
<td align="left">(418.97)</td>
<td align="left">1384.35</td>
<td align="left">(419.21)</td>
</tr>
<tr class="even">
<td align="left">ipw</td>
<td align="left">1769.67</td>
<td align="left">(684.30)</td>
<td align="left">1179.06</td>
<td align="left">(685.01)</td>
<td align="left">785.92</td>
<td align="left">(929.81)</td>
<td align="left">1568.81</td>
<td align="left">(815.56)</td>
<td align="left">-1726.90</td>
<td align="left">(1203.47)</td>
<td align="left">645.19</td>
<td align="left">(544.37)</td>
<td align="left">468.44</td>
<td align="left">(467.88)</td>
<td align="left">203.13</td>
<td align="left">(573.00)</td>
<td align="left">1568.81</td>
<td align="left">(815.56)</td>
<td align="left">-43.20</td>
<td align="left">(438.92)</td>
<td align="left">-508.12</td>
<td align="left">(972.27)</td>
<td align="left">-1966.48</td>
<td align="left">(990.23)</td>
<td align="left">-1726.90</td>
<td align="left">(1203.47)</td>
<td align="left">556.59</td>
<td align="left">(840.39)</td>
<td align="left">-999.49</td>
<td align="left">(735.80)</td>
</tr>
<tr class="odd">
<td align="left">cbps</td>
<td align="left">1699.09</td>
<td align="left">(699.19)</td>
<td align="left">1493.80</td>
<td align="left">(652.71)</td>
<td align="left">2359.12</td>
<td align="left">(873.16)</td>
<td align="left">1584.40</td>
<td align="left">(846.33)</td>
<td align="left">-1608.85</td>
<td align="left">(1163.08)</td>
<td align="left">645.19</td>
<td align="left">(544.37)</td>
<td align="left">468.44</td>
<td align="left">(467.88)</td>
<td align="left">468.41</td>
<td align="left">(461.43)</td>
<td align="left">1584.40</td>
<td align="left">(846.33)</td>
<td align="left">-43.20</td>
<td align="left">(438.92)</td>
<td align="left">-508.12</td>
<td align="left">(972.27)</td>
<td align="left">-1966.48</td>
<td align="left">(990.23)</td>
<td align="left">-1608.85</td>
<td align="left">(1163.08)</td>
<td align="left">1366.58</td>
<td align="left">(765.71)</td>
<td align="left">-999.49</td>
<td align="left">(735.80)</td>
</tr>
<tr class="even">
<td align="left">ebal</td>
<td align="left">1701.38</td>
<td align="left">(699.39)</td>
<td align="left">1492.13</td>
<td align="left">(652.66)</td>
<td align="left">2424.45</td>
<td align="left">(875.94)</td>
<td align="left">1583.59</td>
<td align="left">(846.23)</td>
<td align="left">-1507.76</td>
<td align="left">(1217.52)</td>
<td align="left">838.84</td>
<td align="left">(552.25)</td>
<td align="left">708.63</td>
<td align="left">(469.88)</td>
<td align="left">460.96</td>
<td align="left">(461.18)</td>
<td align="left">1583.59</td>
<td align="left">(846.23)</td>
<td align="left">569.38</td>
<td align="left">(486.13)</td>
<td align="left">-147.82</td>
<td align="left">(822.08)</td>
<td align="left">-1375.64</td>
<td align="left">(915.57)</td>
<td align="left">-1507.76</td>
<td align="left">(1217.52)</td>
<td align="left">1863.97</td>
<td align="left">(733.65)</td>
<td align="left">1863.97</td>
<td align="left">(733.65)</td>
</tr>
<tr class="odd">
<td align="left">dml</td>
<td align="left">1831.36</td>
<td align="left">(653.57)</td>
<td align="left">1497.70</td>
<td align="left">(632.53)</td>
<td align="left">1286.02</td>
<td align="left">(897.44)</td>
<td align="left">2079.09</td>
<td align="left">(850.38)</td>
<td align="left">-1774.26</td>
<td align="left">(1069.88)</td>
<td align="left">504.16</td>
<td align="left">(509.99)</td>
<td align="left">497.78</td>
<td align="left">(448.06)</td>
<td align="left">-93.87</td>
<td align="left">(407.13)</td>
<td align="left">2079.09</td>
<td align="left">(850.38)</td>
<td align="left">467.53</td>
<td align="left">(453.89)</td>
<td align="left">-460.17</td>
<td align="left">(831.28)</td>
<td align="left">-1774.47</td>
<td align="left">(894.17)</td>
<td align="left">-1774.26</td>
<td align="left">(1069.88)</td>
<td align="left">-234.66</td>
<td align="left">(716.61)</td>
<td align="left">-234.66</td>
<td align="left">(716.61)</td>
</tr>
<tr class="even">
<td align="left">aipw_grf</td>
<td align="left">1780.89</td>
<td align="left">(685.02)</td>
<td align="left">1574.79</td>
<td align="left">(724.51)</td>
<td align="left">1490.48</td>
<td align="left">(896.92)</td>
<td align="left">1861.88</td>
<td align="left">(808.74)</td>
<td align="left">-1565.14</td>
<td align="left">(1177.20)</td>
<td align="left">668.51</td>
<td align="left">(561.49)</td>
<td align="left">861.70</td>
<td align="left">(610.18)</td>
<td align="left">469.64</td>
<td align="left">(681.16)</td>
<td align="left">1861.88</td>
<td align="left">(808.74)</td>
<td align="left">727.02</td>
<td align="left">(580.50)</td>
<td align="left">-881.70</td>
<td align="left">(1267.75)</td>
<td align="left">-2162.17</td>
<td align="left">(1032.69)</td>
<td align="left">-1565.14</td>
<td align="left">(1177.20)</td>
<td align="left">862.81</td>
<td align="left">(799.17)</td>
<td align="left">862.81</td>
<td align="left">(799.17)</td>
</tr>
<tr class="odd">
<td align="left">aipw_ow</td>
<td align="left">1848.58</td>
<td align="left">(682.11)</td>
<td align="left">1471.91</td>
<td align="left">(687.41)</td>
<td align="left">1234.26</td>
<td align="left">(800.69)</td>
<td align="left">1919.42</td>
<td align="left">(832.56)</td>
<td align="left">-1267.56</td>
<td align="left">(1207.37)</td>
<td align="left">605.82</td>
<td align="left">(565.80)</td>
<td align="left">876.00</td>
<td align="left">(533.71)</td>
<td align="left">250.64</td>
<td align="left">(676.80)</td>
<td align="left">1919.42</td>
<td align="left">(832.56)</td>
<td align="left">774.13</td>
<td align="left">(511.99)</td>
<td align="left">-286.38</td>
<td align="left">(1081.05)</td>
<td align="left">-2321.92</td>
<td align="left">(1024.19)</td>
<td align="left">-1267.56</td>
<td align="left">(1207.37)</td>
<td align="left">1191.13</td>
<td align="left">(810.65)</td>
<td align="left">1191.13</td>
<td align="left">(810.65)</td>
</tr>
</tbody>
</table>
<p>As in model A, the tabulated results confirm visual patterns: Column (A) reports the estimates for the LDW-Experimental sample, column (B) for the LDW-CPS1 sample, and column (C) for the LDW-PSID1 sample. Columns (D)-(O) summarize the trimmed and top-ranked sample results for both LDW-CPS1 and LDW-PSID1.</p>
<p>In model B, most LDW-CPS1-based samples yield ATT estimates that are closer to the experimental benchmark than in model A, with still modest variance. By contrast, the LDW-PSID1-based estimates, while somewhat closer to the experimental benchmark than in model A, continue to exhibit substantially larger standard errors compared to LDW-CPS1 samples. This again reflects the greater challenge of obtaining reliable estimates from the observational dataset LDW-PSID1.</p>
<p>Overall, figures and table jointly demonstrate again that ATT estimates from observational samples tend to have larger standard errors compared to the experimental sample, reflecting greater statistical uncertainty in non-experimental causal effect estimation, and that certain criteria can bring observational estimates closer to the experimental benchmark. Nevertheless, significant estimator-dependent variability and sensitivity to sample construction persist.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb417-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb417-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb417-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat, <span class="st">&quot;LDW_att_estimates_model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="conditional-average-treatment-effect-on-the-treated-catt-2" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Conditional average treatment effect on the treated (CATT)<a href="lalonde-dehejia-wahba-ldw-data-1.html#conditional-average-treatment-effect-on-the-treated-catt-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb418-1" tabindex="-1"></a>catt.ldw <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw, Y, treat, covar)</span>
<span id="cb418-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb418-2" tabindex="-1"></a>catt.cps <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps, Y, treat, covar)</span>
<span id="cb418-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb418-3" tabindex="-1"></a>catt.psid <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid, Y, treat, covar)</span>
<span id="cb418-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb418-4" tabindex="-1"></a>catt.cps.trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_cps.trim_match, Y, treat, covar)</span>
<span id="cb418-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb418-5" tabindex="-1"></a>catt.psid.trim <span class="ot">&lt;-</span> <span class="fu">catt</span>(ldw_psid.trim_match, Y, treat, covar)</span></code></pre></div>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb419-1" tabindex="-1"></a>catt.top5_cps_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span>
<span id="cb419-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb419-2" tabindex="-1"></a>catt.top5_psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">catt</span>(d, Y, treat, covar))</span></code></pre></div>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-1" tabindex="-1"></a><span class="co"># combine all catt objects </span></span>
<span id="cb420-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-2" tabindex="-1"></a>all_catt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(catt.ldw, catt.cps, catt.psid, catt.cps.trim, catt.psid.trim), catt.top5_cps_plus, catt.top5_psid_plus)</span>
<span id="cb420-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-3" tabindex="-1"></a></span>
<span id="cb420-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-4" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb420-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb420-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb420-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb420-7" tabindex="-1"></a><span class="fu">plot_catt_panels</span>(all_catt, plot_titles)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-263-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-263-1.png" alt="FIGURE B11. CATT Estimates Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.146: FIGURE B11. CATT Estimates Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-263-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-263-2.png" alt="FIGURE B11. CATT Estimates Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.147: FIGURE B11. CATT Estimates Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-263-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-263-3.png" alt="FIGURE B11. CATT Estimates Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.148: FIGURE B11. CATT Estimates Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-263-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-263-4.png" alt="FIGURE B11. CATT Estimates Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.149: FIGURE B11. CATT Estimates Model B using LDW Data
</p>
</div>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb421-1" tabindex="-1"></a>all_catt_eval <span class="ot">&lt;-</span> <span class="fu">eval_catt</span>(all_catt, plot_titles)</span>
<span id="cb421-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb421-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(all_catt_eval, <span class="at">caption =</span> <span class="st">&quot;CATT Summary Statistics&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-264">Table 3.7: </span>CATT Summary Statistics</caption>
<colgroup>
<col width="54%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Min_Catt</th>
<th align="right">Max_Catt</th>
<th align="right">Mean_Catt</th>
<th align="right">Diff_Catt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">-213.9356</td>
<td align="right">3858.5191</td>
<td align="right">1720.1321</td>
<td align="right">4072.455</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">-3868.5404</td>
<td align="right">7128.4156</td>
<td align="right">2169.8052</td>
<td align="right">10996.956</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">-6772.1633</td>
<td align="right">5032.3073</td>
<td align="right">593.8834</td>
<td align="right">11804.471</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">-1548.4886</td>
<td align="right">5299.3447</td>
<td align="right">1746.5441</td>
<td align="right">6847.833</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">-3911.5664</td>
<td align="right">557.3922</td>
<td align="right">-1467.0941</td>
<td align="right">4468.959</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: mahvars</td>
<td align="right">-2308.6089</td>
<td align="right">4128.6433</td>
<td align="right">636.0073</td>
<td align="right">6437.252</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: card</td>
<td align="right">-3981.2823</td>
<td align="right">4269.0121</td>
<td align="right">897.5851</td>
<td align="right">8250.294</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: overlap_crump</td>
<td align="right">-4888.8762</td>
<td align="right">5634.4060</td>
<td align="right">935.1903</td>
<td align="right">10523.282</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: ps_threshold</td>
<td align="right">-1361.5987</td>
<td align="right">5460.5305</td>
<td align="right">1793.2761</td>
<td align="right">6822.129</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">-4515.6099</td>
<td align="right">4414.3269</td>
<td align="right">726.3378</td>
<td align="right">8929.937</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">-2952.3256</td>
<td align="right">3028.1330</td>
<td align="right">-761.4534</td>
<td align="right">5980.459</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">-6005.6110</td>
<td align="right">1398.3316</td>
<td align="right">-2155.7605</td>
<td align="right">7403.943</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">-4008.2637</td>
<td align="right">531.1040</td>
<td align="right">-1516.6311</td>
<td align="right">4539.368</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: fix_max_value_trunc_overlap_weight</td>
<td align="right">-7141.8467</td>
<td align="right">3588.1338</td>
<td align="right">-256.5465</td>
<td align="right">10729.980</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_weight</td>
<td align="right">-7056.8100</td>
<td align="right">3637.3123</td>
<td align="right">-421.8611</td>
<td align="right">10694.122</td>
</tr>
</tbody>
</table>
<p>In model B, using LDW-CPS1, the CATT estimates range from $-3,868.54 to $7,128.42. This span is considerably narrower than in model A, but still performs worse when contrasted with the experimental benchmark, where CATT estimates range from $-213.93 to $3,858.52 with a mean of $1,720.13. The experimental mean CATT estimate remains closer to its corresponding ATT estimate than in model A. Further, LDW-PSID1 shows a narrower CATT estimate range, from $-6,772.16 to $5,032.31, compared to LDW-CPS1 and model A, with a mean CATT estimate of about $557.39, which deviates further from the experimental benchmark, indicating poorer performance.</p>
<p>For trimmed and top-ranked LDW-CPS1 subsamples, CATT ranges vary considerably, yet the mean estimates are generally closer to the experimental benchmark, as in model A. Moreover, the minimum CATT estimates are less negative, which reduces the spread between minimum and maximum estimates.</p>
<p>Top-ranked LDW-PSID1 subsamples, on the other hand, again yield more negative mean CATT estimates and wider ranges compared to their LDW-CPS1 counterparts, signaling persistent difficulties in generating reliable effect estimates. Still, compared to model A, the minimum CATT estimates are less strongly negative, though the mean CATTs only improve marginally in their proximity to the experimental benchmark.</p>
<p>Hence, alike model A, these results show that the variation in ranges and means across methods and samples reflects substantial heterogeneity in treatment effect estimation. While certain criteria may improve consistency with experimental benchmarks, they may also introduce notable discrepancies and variability in estimated heterogeneous effects.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb422-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb422-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb422-2" tabindex="-1"></a><span class="fu">save_catt_panels</span>(all_catt, plot_titles, <span class="at">prefix =</span> <span class="st">&quot;model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="quantile-treatment-effect-on-the-treated-qtet-1" class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> Quantile treatment effect on the treated (QTET)<a href="lalonde-dehejia-wahba-ldw-data-1.html#quantile-treatment-effect-on-the-treated-qtet-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb423-1" tabindex="-1"></a>qte.ldw <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw, <span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-1" tabindex="-1"></a>qte.ldw_cps <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps)</span>
<span id="cb424-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-2" tabindex="-1"></a>qte.ldw_psid <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid)</span>
<span id="cb424-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-3" tabindex="-1"></a>qte.ldw_cps.trimm <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps.trim_match)</span>
<span id="cb424-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-4" tabindex="-1"></a>qte.ldw_psid.trimm <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid.trim_match) </span>
<span id="cb424-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-5" tabindex="-1"></a>qte.ldw_cps.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_cps_trim)</span>
<span id="cb424-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb424-6" tabindex="-1"></a>qte.ldw_psid.trim <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> ldw_psid_trim) </span></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb425-1" tabindex="-1"></a>qte.top5_cps_plus  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span>
<span id="cb425-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb425-2" tabindex="-1"></a>qte.top5_psid_plus <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, covar, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-1" tabindex="-1"></a>qte.ldw0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw)</span>
<span id="cb426-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-2" tabindex="-1"></a>qte.ldw.cps0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps)</span>
<span id="cb426-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-3" tabindex="-1"></a>qte.ldw.psid0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid)</span>
<span id="cb426-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-4" tabindex="-1"></a>qte.ldw_cps.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_cps.trim_match)</span>
<span id="cb426-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-5" tabindex="-1"></a>qte.ldw_psid.trim0 <span class="ot">&lt;-</span> <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> ldw_psid.trim_match)</span>
<span id="cb426-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-6" tabindex="-1"></a>qte.top5_cps_plus0  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus,  <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span>
<span id="cb426-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb426-7" tabindex="-1"></a>qte.top5_psid_plus0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">est_qte</span>(Y, treat, <span class="cn">NULL</span>, <span class="at">data =</span> d))</span></code></pre></div>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb427-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb427-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-3" tabindex="-1"></a></span>
<span id="cb427-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-4" tabindex="-1"></a><span class="co"># CPS</span></span>
<span id="cb427-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-5" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps, qte.ldw.cps0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW-CPS&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb427-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb427-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-7" tabindex="-1"></a></span>
<span id="cb427-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-8" tabindex="-1"></a><span class="co"># PSID</span></span>
<span id="cb427-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-9" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid, qte.ldw.psid0, qte.ldw, <span class="at">main =</span> <span class="st">&quot;(C) LDW-PSID&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb427-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb427-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-11" tabindex="-1"></a></span>
<span id="cb427-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-12" tabindex="-1"></a><span class="do">## CPS trimmed</span></span>
<span id="cb427-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-13" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_cps.trim, qte.ldw_cps.trim0, qte.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(D) LDW-CPS (Trimmed)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb427-14"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb427-15"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-15" tabindex="-1"></a></span>
<span id="cb427-16"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-16" tabindex="-1"></a><span class="co"># PSID trimmed</span></span>
<span id="cb427-17"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-17" tabindex="-1"></a><span class="fu">plot_qte</span>(qte.ldw_psid.trim, qte.ldw_psid.trim0, qte.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(E) LDW-PSID (Trimmed)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb427-18"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-18" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), </span>
<span id="cb427-19"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb427-19" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-270-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-270-1.png" alt="FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.150: FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb428-1" tabindex="-1"></a><span class="co"># CPS top methods</span></span>
<span id="cb428-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb428-2" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_cps_plus, qte.top5_cps_plus0, qte.ldw_cps, plot_titles, <span class="at">main_start =</span> <span class="dv">6</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-270-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-270-2.png" alt="FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.151: FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb429-1" tabindex="-1"></a><span class="co"># PSID top methods</span></span>
<span id="cb429-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb429-2" tabindex="-1"></a><span class="fu">plot_qte_top</span>(qte.top5_psid_plus, qte.top5_psid_plus0, qte.ldw_psid, plot_titles, <span class="at">main_start =</span> <span class="dv">11</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-270-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-270-3.png" alt="FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.152: FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-270-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-270-4.png" alt="FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental" width="100%" />
<p class="caption">
Figure 3.153: FIGURE B12. QTET Estimates Model B using LDW Data: Experimental vs. Nonexperimental
</p>
</div>
<p>These figures display QTET estimates derived from both the experimental and various non-experimental samples. Compared to model A, the QTET results of all samples closely resemble those of their respective counterparts. The QTETs estimated from the original and trimmed LDW-CPS1 sample continue to correspond well with the true QTET, although the estimates often suffer from low power. The QTET estimates from the original and trimmed LDW-PSID1 subsample show clear biases when compared to the experimental benchmark, which clusters near zero. The QTET estimates derived from the top-ranked subsamples of LDW-CPS1 (F - J) track the true experimental effect well. In contrast, the top-ranked subsamples of LDW-PSID1-based produce QTETs (K - O) that exhibit increased bias and noticeably wider confidence bands, indicating greater estimation uncertainty.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-1" tabindex="-1"></a><span class="co"># list results</span></span>
<span id="cb430-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-2" tabindex="-1"></a>plots_ldw <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb430-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps, <span class="at">mod0 =</span> qte.ldw.cps0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(A) LDW CPS1&quot;</span>),</span>
<span id="cb430-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid, <span class="at">mod0 =</span> qte.ldw.psid0, <span class="at">bm =</span> qte.ldw, <span class="at">main =</span> <span class="st">&quot;(B) LDW PSID1&quot;</span>),</span>
<span id="cb430-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_cps.trim, <span class="at">mod0 =</span> qte.ldw_cps.trim0, <span class="at">bm =</span> qte.ldw_cps, <span class="at">main =</span> <span class="st">&quot;(C) LDW CPS1 (Trimmed)&quot;</span>),</span>
<span id="cb430-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-6" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mod =</span> qte.ldw_psid.trim, <span class="at">mod0 =</span> qte.ldw_psid.trim0, <span class="at">bm =</span> qte.ldw_psid, <span class="at">main =</span> <span class="st">&quot;(D) LDW PSID1 (Trimmed)&quot;</span>)</span>
<span id="cb430-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-7" tabindex="-1"></a>)</span>
<span id="cb430-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-8" tabindex="-1"></a></span>
<span id="cb430-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-9" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb430-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-10" tabindex="-1"></a><span class="fu">save_qtet</span>(plots_ldw, <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>))</span>
<span id="cb430-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-11" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_cps_plus, qte.top5_cps_plus0, qte.ldw_cps, plot_titles, <span class="at">main_start =</span> <span class="dv">6</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>), <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_top&quot;</span>)</span>
<span id="cb430-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb430-12" tabindex="-1"></a><span class="fu">save_qte_top</span>(qte.top5_psid_plus, qte.top5_psid_plus0, qte.ldw_psid, plot_titles, <span class="at">main_start =</span> <span class="dv">11</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25000</span>, <span class="dv">15000</span>), <span class="at">prefix =</span> <span class="st">&quot;ldw_model_b_top&quot;</span>)</span></code></pre></div>
</div>
<div id="assessing-outcome-weights-ow-1" class="section level3 hasAnchor" number="3.7.4">
<h3><span class="header-section-number">3.7.4</span> Assessing outcome weights (OW)<a href="lalonde-dehejia-wahba-ldw-data-1.html#assessing-outcome-weights-ow-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-1" tabindex="-1"></a><span class="co"># list all datasets</span></span>
<span id="cb431-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-2" tabindex="-1"></a>all_datasets <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb431-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-3" tabindex="-1"></a>  <span class="fu">list</span>(ldw, ldw_cps, ldw_psid, ldw_cps.trim_match, ldw_psid.trim_match),</span>
<span id="cb431-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-4" tabindex="-1"></a>  top5_datasets.cps_plus,</span>
<span id="cb431-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-5" tabindex="-1"></a>  top5_datasets.psid_plus</span>
<span id="cb431-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb431-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb432-1" tabindex="-1"></a><span class="co"># estimate ATT </span></span>
<span id="cb432-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb432-2" tabindex="-1"></a>res_att <span class="ot">&lt;-</span> <span class="fu">get_res_att</span>(all_datasets, Y, treat, covar)</span>
<span id="cb432-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb432-3" tabindex="-1"></a><span class="co"># extract outcome weights</span></span>
<span id="cb432-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb432-4" tabindex="-1"></a>ow_att <span class="ot">&lt;-</span> <span class="fu">derive_ow</span>(res_att)</span></code></pre></div>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb433-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb433-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb433-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb433-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb433-3" tabindex="-1"></a><span class="co"># plot outcome weights distribution</span></span>
<span id="cb433-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb433-4" tabindex="-1"></a><span class="fu">plot_ow</span>(ow_att, plot_titles) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-274-1.png" alt="FIGURE B13. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.154: FIGURE B13. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-274-2.png" alt="FIGURE B13. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.155: FIGURE B13. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-274-3.png" alt="FIGURE B13. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.156: FIGURE B13. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-274-4.png" alt="FIGURE B13. Outcome Weights Model B using LDW Data" width="100%" />
<p class="caption">
Figure 3.157: FIGURE B13. Outcome Weights Model B using LDW Data
</p>
</div>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb434-1" tabindex="-1"></a><span class="co"># evaluate results</span></span>
<span id="cb434-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb434-2" tabindex="-1"></a>res_ow <span class="ot">&lt;-</span> <span class="fu">eval_ow</span>(ow_att, all_datasets, plot_titles, <span class="at">treat_var =</span> treat, <span class="at">estimator =</span> <span class="st">&quot;AIPW-ATT&quot;</span>)</span>
<span id="cb434-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb434-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res_ow, <span class="at">caption =</span> <span class="st">&quot;Outcome Weights for Treated and Untreated&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-275">Table 3.8: </span>Outcome Weights for Treated and Untreated</caption>
<colgroup>
<col width="65%" />
<col width="15%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Sum_Treated</th>
<th align="right">Sum_Untreated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(A) LDW-Experimental</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(B) LDW-CPS1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(C) LDW-PSID1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(D) Trimmed LDW-CPS1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(E) Trimmed LDW-PSID1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(F) Top CPS1: mahvars</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(G) Top CPS1: card</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(H) Top CPS1: overlap_crump</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(I) Top CPS1: ps_threshold</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(J) Top CPS1: optimal_pair</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(K) Top PSID1: card</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(L) Top PSID1: mahvars</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(M) Top PSID1: ps_threshold</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">(N) Top PSID1: fix_max_value_trunc_overlap_weight</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">(O) Top PSID1: overlap_weight</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb435-1" tabindex="-1"></a><span class="co">#save results</span></span>
<span id="cb435-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb435-2" tabindex="-1"></a><span class="fu">save_ow</span>(ow_att, plot_titles, <span class="at">prefix =</span> <span class="st">&quot;model_b&quot;</span>)</span></code></pre></div>
<p>In model B, the evaluation once again confirms that, across each sample, the estimated outcome weights sum to one within the treated group and to minus one within the untreated group, yielding an overall total of zero.</p>
</div>
</div>
<div id="validation-through-placebo-analyses-1" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Validation through placebo analyses<a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-placebo-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb436-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb436-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb436-2" tabindex="-1"></a>Y_pl <span class="ot">&lt;-</span> <span class="st">&quot;re75&quot;</span></span>
<span id="cb436-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb436-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb436-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb436-4" tabindex="-1"></a>covar_pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;u74&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb437-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on original and observational datasets</span></span>
<span id="cb437-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb437-2" tabindex="-1"></a>out1_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb437-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb437-3" tabindex="-1"></a>out2_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb437-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb437-4" tabindex="-1"></a>out3_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span></code></pre></div>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb438-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on trimmed datasets </span></span>
<span id="cb438-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb438-2" tabindex="-1"></a>out4_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_cps.trim_match, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span>
<span id="cb438-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb438-3" tabindex="-1"></a>out5_pl <span class="ot">&lt;-</span> <span class="fu">estimate_all</span>(ldw_psid.trim_match, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl)</span></code></pre></div>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-1" tabindex="-1"></a><span class="co"># estimate placebo ATT on top ranked datasets</span></span>
<span id="cb439-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-2" tabindex="-1"></a>out.cps_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.cps_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl))</span>
<span id="cb439-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-3" tabindex="-1"></a>out.psid_pl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top5_datasets.psid_plus, <span class="cf">function</span>(d) <span class="fu">estimate_all</span>(d, Y_pl, <span class="st">&quot;treat&quot;</span>, covar_pl))</span>
<span id="cb439-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-4" tabindex="-1"></a>out6_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">1</span>]]</span>
<span id="cb439-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-5" tabindex="-1"></a>out7_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">2</span>]]</span>
<span id="cb439-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-6" tabindex="-1"></a>out8_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">3</span>]]</span>
<span id="cb439-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-7" tabindex="-1"></a>out9_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">4</span>]]</span>
<span id="cb439-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-8" tabindex="-1"></a>out10_pl <span class="ot">&lt;-</span> out.cps_pl[[<span class="dv">5</span>]]</span>
<span id="cb439-9"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-9" tabindex="-1"></a>out11_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">1</span>]]</span>
<span id="cb439-10"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-10" tabindex="-1"></a>out12_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">2</span>]]</span>
<span id="cb439-11"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-11" tabindex="-1"></a>out13_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">3</span>]]</span>
<span id="cb439-12"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-12" tabindex="-1"></a>out14_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">4</span>]]</span>
<span id="cb439-13"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb439-13" tabindex="-1"></a>out15_pl <span class="ot">&lt;-</span> out.psid_pl[[<span class="dv">5</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb440-1" tabindex="-1"></a><span class="co"># collect all placebo results </span></span>
<span id="cb440-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb440-2" tabindex="-1"></a>all_outs.pl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(out1_pl, out2_pl, out3_pl, out4_pl, out5_pl), out.cps_pl, out.psid_pl)</span></code></pre></div>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb441-1" tabindex="-1"></a><span class="co"># plot placebo results</span></span>
<span id="cb441-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb441-2" tabindex="-1"></a>band_pl <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb441-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb441-3" tabindex="-1"></a>est_pl  <span class="ot">&lt;-</span> out1_pl[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb441-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb441-4" tabindex="-1"></a>ylim_pl <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15500</span>, <span class="dv">5500</span>)</span>
<span id="cb441-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb441-5" tabindex="-1"></a><span class="fu">plot_att_panels</span>(all_outs.pl, plot_titles, band_pl, est_pl, ylim_pl, <span class="at">textsize =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-282-1.png" alt="FIGURE B14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.158: FIGURE B14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-282-2.png" alt="FIGURE B14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.159: FIGURE B14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-282-3.png" alt="FIGURE B14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.160: FIGURE B14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-282-4.png" alt="FIGURE B14. Placebo Test Model B: '75 Earnings as the Outcome" width="100%" />
<p class="caption">
Figure 3.161: FIGURE B14. Placebo Test Model B: ’75 Earnings as the Outcome
</p>
</div>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb442-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb442-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb442-2" tabindex="-1"></a><span class="fu">save_att_panels</span>(all_outs.pl, plot_titles, band_pl, est_pl, <span class="st">&quot;model_b_placebo&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb443-1" tabindex="-1"></a><span class="co"># print placebo results</span></span>
<span id="cb443-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb443-2" tabindex="-1"></a>result_mat_pl <span class="ot">&lt;-</span> <span class="fu">create_matrix_results</span>(all_outs.pl, plot_titles)</span>
<span id="cb443-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb443-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result_mat_pl, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">&quot;Placebo ATT Estimates and SEs&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-284">Table 3.9: </span>Placebo ATT Estimates and SEs</caption>
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
<col width="9%" />
<col width="1%" />
<col width="5%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">(A) LDW-Experimental</th>
<th align="left"></th>
<th align="left">(B) LDW-CPS1</th>
<th align="left"></th>
<th align="left">(C) LDW-PSID1</th>
<th align="left"></th>
<th align="left">(D) Trimmed LDW-CPS1</th>
<th align="left"></th>
<th align="left">(E) Trimmed LDW-PSID1</th>
<th align="left"></th>
<th align="left">(F) Top CPS1: mahvars</th>
<th align="left"></th>
<th align="left">(G) Top CPS1: card</th>
<th align="left"></th>
<th align="left">(H) Top CPS1: overlap_crump</th>
<th align="left"></th>
<th align="left">(I) Top CPS1: ps_threshold</th>
<th align="left"></th>
<th align="left">(J) Top CPS1: optimal_pair</th>
<th align="left"></th>
<th align="left">(K) Top PSID1: card</th>
<th align="left"></th>
<th align="left">(L) Top PSID1: mahvars</th>
<th align="left"></th>
<th align="left">(M) Top PSID1: ps_threshold</th>
<th align="left"></th>
<th align="left">(N) Top PSID1: fix_max_value_trunc_overlap_weight</th>
<th align="left"></th>
<th align="left">(O) Top PSID1: overlap_weight</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Experimental Benchmark</td>
<td align="left">265.15</td>
<td align="left">(305.00)</td>
<td align="left">-12118.75</td>
<td align="left">(247.18)</td>
<td align="left">-17531.28</td>
<td align="left">(360.60)</td>
<td align="left">-847.26</td>
<td align="left">(473.39)</td>
<td align="left">-362.39</td>
<td align="left">(683.79)</td>
<td align="left">-78.07</td>
<td align="left">(308.25)</td>
<td align="left">-293.01</td>
<td align="left">(252.28)</td>
<td align="left">-4459.43</td>
<td align="left">(186.69)</td>
<td align="left">-847.26</td>
<td align="left">(473.39)</td>
<td align="left">-556.64</td>
<td align="left">(229.22)</td>
<td align="left">-312.26</td>
<td align="left">(457.85)</td>
<td align="left">-500.39</td>
<td align="left">(639.19)</td>
<td align="left">-362.39</td>
<td align="left">(683.79)</td>
<td align="left">-17686.20</td>
<td align="left">(310.72)</td>
<td align="left">-17686.20</td>
<td align="left">(310.72)</td>
</tr>
<tr class="even">
<td align="left">diff</td>
<td align="left">265.15</td>
<td align="left">(305.00)</td>
<td align="left">-12118.75</td>
<td align="left">(247.18)</td>
<td align="left">-17531.28</td>
<td align="left">(360.60)</td>
<td align="left">-847.26</td>
<td align="left">(473.39)</td>
<td align="left">-362.39</td>
<td align="left">(683.79)</td>
<td align="left">-78.07</td>
<td align="left">(308.25)</td>
<td align="left">-293.01</td>
<td align="left">(252.28)</td>
<td align="left">-4459.43</td>
<td align="left">(186.69)</td>
<td align="left">-847.26</td>
<td align="left">(473.39)</td>
<td align="left">-556.64</td>
<td align="left">(229.22)</td>
<td align="left">-312.26</td>
<td align="left">(457.85)</td>
<td align="left">-500.39</td>
<td align="left">(639.19)</td>
<td align="left">-362.39</td>
<td align="left">(683.79)</td>
<td align="left">-17686.20</td>
<td align="left">(310.72)</td>
<td align="left">-17686.20</td>
<td align="left">(310.72)</td>
</tr>
<tr class="odd">
<td align="left">reg</td>
<td align="left">224.34</td>
<td align="left">(218.33)</td>
<td align="left">-1134.82</td>
<td align="left">(272.44)</td>
<td align="left">-2757.40</td>
<td align="left">(589.02)</td>
<td align="left">-579.29</td>
<td align="left">(337.91)</td>
<td align="left">421.22</td>
<td align="left">(575.36)</td>
<td align="left">-211.99</td>
<td align="left">(226.20)</td>
<td align="left">-478.10</td>
<td align="left">(200.56)</td>
<td align="left">-2970.16</td>
<td align="left">(224.50)</td>
<td align="left">-579.29</td>
<td align="left">(337.91)</td>
<td align="left">-264.44</td>
<td align="left">(186.82)</td>
<td align="left">-446.49</td>
<td align="left">(387.79)</td>
<td align="left">-224.36</td>
<td align="left">(472.91)</td>
<td align="left">421.22</td>
<td align="left">(575.36)</td>
<td align="left">-3006.44</td>
<td align="left">(512.93)</td>
<td align="left">-3006.44</td>
<td align="left">(512.93)</td>
</tr>
<tr class="even">
<td align="left">om.reg</td>
<td align="left">165.70</td>
<td align="left">(284.98)</td>
<td align="left">-1096.70</td>
<td align="left">(395.18)</td>
<td align="left">-2640.76</td>
<td align="left">(367.46)</td>
<td align="left">-571.89</td>
<td align="left">(363.79)</td>
<td align="left">636.51</td>
<td align="left">(604.23)</td>
<td align="left">-347.81</td>
<td align="left">(294.63)</td>
<td align="left">-698.16</td>
<td align="left">(238.12)</td>
<td align="left">-3001.18</td>
<td align="left">(236.43)</td>
<td align="left">-571.89</td>
<td align="left">(363.79)</td>
<td align="left">-502.54</td>
<td align="left">(211.06)</td>
<td align="left">-537.13</td>
<td align="left">(393.35)</td>
<td align="left">-275.36</td>
<td align="left">(559.38)</td>
<td align="left">636.51</td>
<td align="left">(604.23)</td>
<td align="left">-2717.06</td>
<td align="left">(248.87)</td>
<td align="left">-2717.06</td>
<td align="left">(248.87)</td>
</tr>
<tr class="odd">
<td align="left">om.grf</td>
<td align="left">97.01</td>
<td align="left">(285.10)</td>
<td align="left">-1590.61</td>
<td align="left">(373.01)</td>
<td align="left">-4290.47</td>
<td align="left">(343.87)</td>
<td align="left">-551.44</td>
<td align="left">(315.66)</td>
<td align="left">184.01</td>
<td align="left">(545.99)</td>
<td align="left">-99.82</td>
<td align="left">(257.70)</td>
<td align="left">-431.18</td>
<td align="left">(203.37)</td>
<td align="left">-1537.40</td>
<td align="left">(240.74)</td>
<td align="left">-514.10</td>
<td align="left">(314.25)</td>
<td align="left">-349.92</td>
<td align="left">(186.32)</td>
<td align="left">20.09</td>
<td align="left">(383.85)</td>
<td align="left">-214.87</td>
<td align="left">(512.55)</td>
<td align="left">143.40</td>
<td align="left">(545.41)</td>
<td align="left">-4495.00</td>
<td align="left">(231.08)</td>
<td align="left">-4497.15</td>
<td align="left">(231.51)</td>
</tr>
<tr class="even">
<td align="left">matching</td>
<td align="left">148.67</td>
<td align="left">(227.58)</td>
<td align="left">-1465.93</td>
<td align="left">(351.78)</td>
<td align="left">-1913.65</td>
<td align="left">(805.37)</td>
<td align="left">-692.30</td>
<td align="left">(329.36)</td>
<td align="left">448.28</td>
<td align="left">(582.18)</td>
<td align="left">-247.45</td>
<td align="left">(236.55)</td>
<td align="left">-717.15</td>
<td align="left">(279.17)</td>
<td align="left">-1545.60</td>
<td align="left">(303.44)</td>
<td align="left">-692.30</td>
<td align="left">(329.36)</td>
<td align="left">-739.24</td>
<td align="left">(258.12)</td>
<td align="left">-171.76</td>
<td align="left">(491.09)</td>
<td align="left">-210.91</td>
<td align="left">(499.96)</td>
<td align="left">448.28</td>
<td align="left">(582.18)</td>
<td align="left">-1931.45</td>
<td align="left">(856.38)</td>
<td align="left">-1931.45</td>
<td align="left">(856.38)</td>
</tr>
<tr class="odd">
<td align="left">psm</td>
<td align="left">106.02</td>
<td align="left">(315.01)</td>
<td align="left">-1335.04</td>
<td align="left">(425.34)</td>
<td align="left">-2792.68</td>
<td align="left">(496.82)</td>
<td align="left">-765.63</td>
<td align="left">(441.19)</td>
<td align="left">-111.65</td>
<td align="left">(628.64)</td>
<td align="left">-138.09</td>
<td align="left">(299.56)</td>
<td align="left">-485.45</td>
<td align="left">(252.19)</td>
<td align="left">-1336.28</td>
<td align="left">(254.39)</td>
<td align="left">-774.62</td>
<td align="left">(442.17)</td>
<td align="left">-232.52</td>
<td align="left">(204.04)</td>
<td align="left">29.31</td>
<td align="left">(427.60)</td>
<td align="left">280.29</td>
<td align="left">(575.27)</td>
<td align="left">-111.65</td>
<td align="left">(628.64)</td>
<td align="left">-2451.49</td>
<td align="left">(302.97)</td>
<td align="left">-2475.85</td>
<td align="left">(301.36)</td>
</tr>
<tr class="even">
<td align="left">ipw</td>
<td align="left">160.63</td>
<td align="left">(311.24)</td>
<td align="left">-1515.20</td>
<td align="left">(334.86)</td>
<td align="left">-3151.45</td>
<td align="left">(739.64)</td>
<td align="left">-660.70</td>
<td align="left">(443.29)</td>
<td align="left">-11.78</td>
<td align="left">(664.53)</td>
<td align="left">-78.07</td>
<td align="left">(308.25)</td>
<td align="left">-293.01</td>
<td align="left">(252.28)</td>
<td align="left">-1449.94</td>
<td align="left">(319.23)</td>
<td align="left">-660.70</td>
<td align="left">(443.29)</td>
<td align="left">-556.64</td>
<td align="left">(229.22)</td>
<td align="left">-312.26</td>
<td align="left">(457.85)</td>
<td align="left">-500.39</td>
<td align="left">(639.19)</td>
<td align="left">-11.78</td>
<td align="left">(664.53)</td>
<td align="left">-2348.05</td>
<td align="left">(863.84)</td>
<td align="left">-0.00</td>
<td align="left">(567.47)</td>
</tr>
<tr class="odd">
<td align="left">cbps</td>
<td align="left">188.34</td>
<td align="left">(304.79)</td>
<td align="left">-1227.83</td>
<td align="left">(297.89)</td>
<td align="left">-2282.31</td>
<td align="left">(834.92)</td>
<td align="left">-586.85</td>
<td align="left">(440.58)</td>
<td align="left">281.73</td>
<td align="left">(657.31)</td>
<td align="left">-78.07</td>
<td align="left">(308.25)</td>
<td align="left">-293.01</td>
<td align="left">(252.28)</td>
<td align="left">-1346.75</td>
<td align="left">(244.50)</td>
<td align="left">-586.85</td>
<td align="left">(440.58)</td>
<td align="left">-556.64</td>
<td align="left">(229.22)</td>
<td align="left">-312.26</td>
<td align="left">(457.85)</td>
<td align="left">-500.39</td>
<td align="left">(639.19)</td>
<td align="left">281.73</td>
<td align="left">(657.31)</td>
<td align="left">-2375.70</td>
<td align="left">(946.53)</td>
<td align="left">-0.00</td>
<td align="left">(567.47)</td>
</tr>
<tr class="even">
<td align="left">ebal</td>
<td align="left">189.20</td>
<td align="left">(304.71)</td>
<td align="left">-1228.49</td>
<td align="left">(297.88)</td>
<td align="left">-2250.80</td>
<td align="left">(842.15)</td>
<td align="left">-578.03</td>
<td align="left">(439.98)</td>
<td align="left">617.65</td>
<td align="left">(666.91)</td>
<td align="left">-373.04</td>
<td align="left">(432.04)</td>
<td align="left">-670.12</td>
<td align="left">(319.54)</td>
<td align="left">-1335.99</td>
<td align="left">(243.98)</td>
<td align="left">-578.03</td>
<td align="left">(439.98)</td>
<td align="left">-453.47</td>
<td align="left">(283.66)</td>
<td align="left">-474.30</td>
<td align="left">(496.79)</td>
<td align="left">-273.10</td>
<td align="left">(625.31)</td>
<td align="left">617.65</td>
<td align="left">(666.91)</td>
<td align="left">-2227.14</td>
<td align="left">(899.13)</td>
<td align="left">-2227.14</td>
<td align="left">(899.13)</td>
</tr>
<tr class="odd">
<td align="left">dml</td>
<td align="left">275.69</td>
<td align="left">(231.57)</td>
<td align="left">-1152.96</td>
<td align="left">(271.75)</td>
<td align="left">-2725.28</td>
<td align="left">(591.57)</td>
<td align="left">-543.31</td>
<td align="left">(343.84)</td>
<td align="left">358.82</td>
<td align="left">(537.73)</td>
<td align="left">-205.84</td>
<td align="left">(232.47)</td>
<td align="left">-459.54</td>
<td align="left">(203.06)</td>
<td align="left">-2978.69</td>
<td align="left">(224.74)</td>
<td align="left">-543.31</td>
<td align="left">(343.84)</td>
<td align="left">-270.86</td>
<td align="left">(186.59)</td>
<td align="left">-432.11</td>
<td align="left">(381.93)</td>
<td align="left">-212.57</td>
<td align="left">(487.08)</td>
<td align="left">358.82</td>
<td align="left">(537.73)</td>
<td align="left">-2964.43</td>
<td align="left">(510.26)</td>
<td align="left">-2964.43</td>
<td align="left">(510.26)</td>
</tr>
<tr class="even">
<td align="left">aipw_grf</td>
<td align="left">83.05</td>
<td align="left">(228.21)</td>
<td align="left">-1249.88</td>
<td align="left">(264.79)</td>
<td align="left">-2419.46</td>
<td align="left">(623.46)</td>
<td align="left">-544.18</td>
<td align="left">(336.76)</td>
<td align="left">191.04</td>
<td align="left">(550.63)</td>
<td align="left">-120.99</td>
<td align="left">(239.04)</td>
<td align="left">-461.72</td>
<td align="left">(265.73)</td>
<td align="left">-1323.05</td>
<td align="left">(242.39)</td>
<td align="left">-544.18</td>
<td align="left">(336.76)</td>
<td align="left">-502.96</td>
<td align="left">(243.34)</td>
<td align="left">12.65</td>
<td align="left">(374.71)</td>
<td align="left">-233.17</td>
<td align="left">(475.60)</td>
<td align="left">191.04</td>
<td align="left">(550.63)</td>
<td align="left">-2064.82</td>
<td align="left">(739.78)</td>
<td align="left">-2064.82</td>
<td align="left">(739.78)</td>
</tr>
<tr class="odd">
<td align="left">aipw_ow</td>
<td align="left">108.01</td>
<td align="left">(233.22)</td>
<td align="left">-1318.36</td>
<td align="left">(276.40)</td>
<td align="left">-2904.04</td>
<td align="left">(648.78)</td>
<td align="left">-619.91</td>
<td align="left">(378.14)</td>
<td align="left">373.00</td>
<td align="left">(591.94)</td>
<td align="left">-88.51</td>
<td align="left">(246.40)</td>
<td align="left">-427.89</td>
<td align="left">(298.28)</td>
<td align="left">-1319.86</td>
<td align="left">(234.72)</td>
<td align="left">-619.91</td>
<td align="left">(378.14)</td>
<td align="left">-449.75</td>
<td align="left">(209.85)</td>
<td align="left">56.70</td>
<td align="left">(373.96)</td>
<td align="left">-99.92</td>
<td align="left">(477.81)</td>
<td align="left">373.00</td>
<td align="left">(591.94)</td>
<td align="left">-2019.02</td>
<td align="left">(1072.53)</td>
<td align="left">-2019.02</td>
<td align="left">(1072.53)</td>
</tr>
</tbody>
</table>
<p>The placebo analysis shows that the experimental benchmarks remain close to zero and statistically insignificant, closely mirroring the results in model A. The results for LDW-CPS1 and LDW-PSID1 are identical to those observed in model A.</p>
<p>For LDW-CPS1 samples (B and F through J), ATT estimates remain consistently negative. The <code>overlap_crump</code> estimates show modest improvement toward the benchmark compared to LDW-CPS1 (B) results, but also yields notably worse estimates for certain estimators. Further gains are observed with the trimmed sample (D), <code>ps_threshold</code> (I), <code>card</code> (G) and <code>optimal_pair</code>. The <code>mahvars</code> (G) sample performs best, producing ATT estimates closest to the experimental results. However, compared to model A, no clear pattern emerges: some methods perform better, while others produce poorer estimates.</p>
<p>For LDW-PSID1, the sample (O) applying <code>fix_max_value_truncation_overlap_weight</code> shows some improvement relative to the PSID1 sample (C), though it also produces worse results for certain estimators. A similar pattern holds for the <code>overlap_weight</code> sample. The <code>card</code> (K), <code>mahvars</code> (L), trimmed sample (E) and the<code>ps_threshold</code> (M) further reduce discrepancies, drawing estimates closer to the experimental benchmark results. Still, their performance not markedly surpass that of model A.</p>
<p>Across most estimators and observational top-ranked subsamples (F–O) the placebo analysis continues to reveal substantial bias and deviation from the true effect, highlighting the persistent challenges in adjusting for confounding using observational data. This underscores the limitations of these methods in recovering unbiased ATT estimates outside of randomized experimental settings.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb444-1" tabindex="-1"></a><span class="co"># save results </span></span>
<span id="cb444-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb444-2" tabindex="-1"></a><span class="fu">save_csv</span>(result_mat_pl, <span class="st">&quot;LDW_att_estimates_pl_model_b&quot;</span>)</span></code></pre></div>
</div>
<div id="validation-through-sensitivity-analyses-1" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Validation through sensitivity analyses<a href="lalonde-dehejia-wahba-ldw-data-1.html#validation-through-sensitivity-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb445-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb445-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb445-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="st">&quot;re78&quot;</span></span>
<span id="cb445-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb445-3" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="st">&quot;treat&quot;</span></span>
<span id="cb445-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb445-4" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;hispanic&quot;</span>, <span class="st">&quot;married&quot;</span>, <span class="st">&quot;nodegree&quot;</span>, <span class="st">&quot;re74&quot;</span>, <span class="st">&quot;re75&quot;</span>, <span class="st">&quot;u74&quot;</span>, <span class="st">&quot;u75&quot;</span>)</span>
<span id="cb445-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb445-5" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;re75&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb446-1" tabindex="-1"></a><span class="co"># check for valid datasets </span></span>
<span id="cb446-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb446-2" tabindex="-1"></a>datasets_sens <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(ldw, ldw_cps, ldw_psid), top5_datasets.cps_plus, top5_datasets.psid_plus)</span>
<span id="cb446-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb446-3" tabindex="-1"></a>filtered_datasets_sens <span class="ot">&lt;-</span> <span class="fu">check_filter_datasets</span>(datasets_sens, Y, treat, covar, bm)</span></code></pre></div>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb447-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb447-3"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-3" tabindex="-1"></a><span class="co"># loop over valid datasets and assign index</span></span>
<span id="cb447-4"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(filtered_datasets_sens)) {</span>
<span id="cb447-5"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-5" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(datasets_sens, identical, filtered_datasets_sens[[i]]))</span>
<span id="cb447-6"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-6" tabindex="-1"></a>    <span class="fu">sens_ana</span>(filtered_datasets_sens[[i]], Y, treat, covar, bm, <span class="at">kd =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb447-7"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-7" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> plot_titles[idx])</span>
<span id="cb447-8"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb447-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-288-1"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-288-1.png" alt="FIGURE 15. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.162: FIGURE 15. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-288-2"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-288-2.png" alt="FIGURE 15. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.163: FIGURE 15. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-288-3"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-288-3.png" alt="FIGURE 15. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.164: FIGURE 15. Sensitivity Analyses Model B
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-288-4"></span>
<img src="Outcome-Weights_files/figure-html/unnamed-chunk-288-4.png" alt="FIGURE 15. Sensitivity Analyses Model B" width="100%" />
<p class="caption">
Figure 3.165: FIGURE 15. Sensitivity Analyses Model B
</p>
</div>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb448-1" tabindex="-1"></a><span class="co"># save results</span></span>
<span id="cb448-2"><a href="lalonde-dehejia-wahba-ldw-data-1.html#cb448-2" tabindex="-1"></a><span class="fu">save_sensitivity_plots</span>(filtered_datasets_sens, Y, treat, covar, bm, plot_titles, <span class="st">&quot;model_b&quot;</span>)</span></code></pre></div>
<p>The sensitivity analysis demonstrates identical results for LDW-Experimental, LDW-CPS1 and LDW-PSID1 as in model A and indicates once again that for most samples, the estimated treatment effects are fairly robust to increasing confounder strength, as indicated by relatively stable values despite up to triple the correlation levels of <code>re75</code>. However, compared to Model A, these estimates tend to shift upwards, exhibiting somewhat more positive values across variants.</p>
</div>
<div id="summary-1" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Summary<a href="lalonde-dehejia-wahba-ldw-data-1.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After reexamining model B, which uses the LaLonde-Dehejia-Wahba (LDW) data with a revised set of covariates, we find that changing the covariate set leads to noticeable shifts in effect estimates. For CPS-1, estimates are generally more consistent and remain close to the experimental benchmark, though standard errors are somewhat larger than in model A. In contrast, PSID-1 continues to show greater dispersion and substantially larger standard errors, highlighting persistent challenges with this observational sample.</p>
<p>Conditional and quantile treatment effect analyses confirm that, while some methods bring estimates closer to the experimental benchmark, considerable heterogeneity and estimator-dependent variability remain. Placebo tests using pre-treatment earnings as the outcome reveal that, despite some improvements, bias and deviation from the true effect persist. Sensitivity analyses indicate that most treatment effect estimates are fairly robust to increasing confounder strength, but some upward shifts are observed compared to model A.</p>
<p>Overall, these results reinforce the importance of overlap, covariate balance, and careful method selection, while underscoring the ongoing difficulty of recovering unbiased causal effects from observational data.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-imbens2024" class="csl-entry">
Imbens, Guido W., and Yiqing Xu. 2024. <span>“LaLonde (1986) After Nearly Four Decades: Lessons Learned.”</span>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lalonde-dehejia-wahba-ldw-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lalonde-nsw-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/lkrsl/Application-of-Outcome-Weights-Framework-for-DML-to-Lalonde-Study/edit/main/tutorial/03-LDW-Model-B.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Outcome-Weights.pdf", "Outcome-Weights.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
